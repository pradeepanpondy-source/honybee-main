var Yn=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports);import{r as Qn,a as Xn,b as xt,g as Zn}from"./vendor-CE4OyIcy.js";import{r as j,R as bt,L as ie,u as Ue,a as kr,N as Z,B as ea,b as ta,c as ae}from"./router-CmOLOSI9.js";var yl=Yn(($c,wt)=>{function ra(s,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in s)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(s,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();var Qt={exports:{}},ct={};var Dr;function sa(){if(Dr)return ct;Dr=1;var s=Qn(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(l,c,d){var u,m={},f=null,h=null;d!==void 0&&(f=""+d),c.key!==void 0&&(f=""+c.key),c.ref!==void 0&&(h=c.ref);for(u in c)n.call(c,u)&&!i.hasOwnProperty(u)&&(m[u]=c[u]);if(l&&l.defaultProps)for(u in c=l.defaultProps,c)m[u]===void 0&&(m[u]=c[u]);return{$$typeof:e,type:l,key:f,ref:h,props:m,_owner:a.current}}return ct.Fragment=t,ct.jsx=o,ct.jsxs=o,ct}var Br;function na(){return Br||(Br=1,Qt.exports=sa()),Qt.exports}var r=na(),jt={},Mr;function aa(){if(Mr)return jt;Mr=1;var s=Xn();return jt.createRoot=s.createRoot,jt.hydrateRoot=s.hydrateRoot,jt}var ia=aa();function oa(s={}){const{nonce:e,onScriptLoadSuccess:t,onScriptLoadError:n}=s,[a,i]=j.useState(!1),o=j.useRef(t);o.current=t;const l=j.useRef(n);return l.current=n,j.useEffect(()=>{const c=document.createElement("script");return c.src="https://accounts.google.com/gsi/client",c.async=!0,c.defer=!0,c.nonce=e,c.onload=()=>{var d;i(!0),(d=o.current)===null||d===void 0||d.call(o)},c.onerror=()=>{var d;i(!1),(d=l.current)===null||d===void 0||d.call(l)},document.body.appendChild(c),()=>{document.body.removeChild(c)}},[e]),a}const la=j.createContext(null);function ca({clientId:s,nonce:e,onScriptLoadSuccess:t,onScriptLoadError:n,children:a}){const i=oa({nonce:e,onScriptLoadSuccess:t,onScriptLoadError:n}),o=j.useMemo(()=>({clientId:s,scriptLoadedSuccessfully:i}),[s,i]);return bt.createElement(la.Provider,{value:o},a)}const da="/assets/fnd-B8xR8oYh.png",ua=({text:s,className:e="",animationDelayStep:t=.1})=>r.jsx("span",{className:`font-extrabold ${e}`,style:{display:"block"},children:s.split("").map((n,a)=>r.jsx("span",{className:"inline-block letter-wave",style:{animationDelay:`${a*t}s`,animationPlayState:"running"},children:n===" "?"Â ":n},a))});function ha(){const[s,e]=j.useState(!0);return j.useEffect(()=>{if(sessionStorage.getItem("fromLogin")){sessionStorage.removeItem("fromLogin"),e(!0);const n=setTimeout(()=>e(!1),2e3);return()=>clearTimeout(n)}else{const n=setTimeout(()=>e(!1),1e3);return()=>clearTimeout(n)}},[]),r.jsxs("div",{children:[s&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 pointer-events-none",children:bt.createElement("dotlottie-wc",{src:"https://lottie.host/81653027-58d6-47e3-9de5-491db6a527a5/TWNyD5vQVe.lottie",style:{width:"150px",height:"150px",opacity:.3},autoplay:!0,loop:!0})}),r.jsx("div",{className:"relative min-h-screen gradient-bg-warm",children:r.jsxs("div",{className:"relative z-20 pt-[80px]",children:[r.jsx("div",{className:"max-w-6xl mx-auto px-4 py-12",children:r.jsxs("div",{className:"text-center mb-16 px-4 sm:px-6",children:[r.jsx("h2",{className:"text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-serif vibrant-text mb-8 font-bold",children:r.jsx(ua,{text:"Bee Bridge",animationDelayStep:.1})}),r.jsx("p",{className:"text-lg sm:text-xl text-honeybee-dark max-w-2xl mx-auto mb-10 font-medium",children:"We're the bridge between the farmer's field, the beekeeper's hive, to the honey in your home."}),r.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-4",children:[r.jsx(ie,{to:"/shop",className:"gradient-bg-primary hover:shadow-2xl text-black font-semibold py-3 px-6 sm:py-4 sm:px-10 rounded-full transition-all duration-300 ease-out modern-shadow-hover transform hover:scale-105",children:"Shop Now"}),r.jsx(ie,{to:"/about",className:"glass-effect bright-border text-honeybee-dark hover:bg-honeybee-primary hover:text-black font-semibold py-3 px-6 sm:py-4 sm:px-10 rounded-full transition-all duration-300 ease-out modern-shadow-hover transform hover:scale-105",children:"Learn More"})]})]})}),r.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-6",children:[r.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-honeybee-dark mb-10 text-center",children:"Connecting Farmers and Consumers"}),r.jsxs("div",{className:"flex flex-col lg:flex-row items-center gap-8",children:[r.jsx("img",{src:da,alt:"Farmers and Consumers",className:"w-full lg:w-1/2 h-64 sm:h-72 md:h-80 object-cover rounded-lg shadow-lg"}),r.jsx("p",{className:"text-base sm:text-lg text-honeybee-dark-brown max-w-xl",children:"Our platform bridges the gap between farmers and consumers, ensuring fresh, organic produce reaches your table directly from the source or become a seller through our marketplace and sell/rent the bee colonies."})]})]})]})}),r.jsx("div",{className:"text-center mb-8",children:r.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-honeybee-dark mb-6 text-center",children:"Service"})}),r.jsx("section",{className:"py-12 sm:py-16 md:py-20 bg-white",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-center gap-4 md:gap-0",children:[r.jsx("video",{src:"/assets/cart-animated-icon-gif-download-10270594.mp4",autoPlay:!0,loop:!0,muted:!0,controls:!1,className:"w-20 h-20 md:w-48 md:h-48",preload:"metadata"}),r.jsx("div",{className:"mx-4 md:mx-8",children:r.jsx("svg",{className:"w-8 h-8 md:w-12 md:h-12 text-black transform md:rotate-0 rotate-90",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z",clipRule:"evenodd"})})}),r.jsx("video",{src:"/assets/payment-complete-animation-gif-download-4281059.mp4",autoPlay:!0,loop:!0,muted:!0,controls:!1,className:"w-20 h-20 md:w-48 md:h-48",preload:"metadata"}),r.jsx("div",{className:"mx-4 md:mx-8",children:r.jsx("svg",{className:"w-8 h-8 md:w-12 md:h-12 text-black transform md:rotate-0 rotate-90",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z",clipRule:"evenodd"})})}),r.jsx("video",{src:"/assets/delivery-animation-gif-download-3434735.mp4",autoPlay:!0,loop:!0,muted:!0,controls:!1,className:"w-20 h-20 md:w-48 md:h-48",preload:"metadata"}),r.jsx("div",{className:"mx-4 md:mx-8",children:r.jsx("svg",{className:"w-8 h-8 md:w-12 md:h-12 text-black transform md:rotate-0 rotate-90",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z",clipRule:"evenodd"})})}),r.jsx("video",{src:"/assets/2.mp4",autoPlay:!0,loop:!0,muted:!0,controls:!1,className:"w-20 h-20 md:w-48 md:h-48",preload:"metadata"})]})})}),r.jsx("section",{className:"py-12 sm:py-16 md:py-20 bg-honeybee-light",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[r.jsx("div",{className:"text-center mb-12 sm:mb-16",children:r.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-honeybee-dark mb-6 text-center",children:"Our Story"})}),r.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[r.jsx("p",{className:"text-base sm:text-lg text-gray-700 leading-relaxed mb-6",children:"At Bee Bridge, our journey began with a deep appreciation for the delicate balance of nature and the hardworking bees that produce nature's golden elixir. We source our honey from sustainable apiaries across the globe, partnering with passionate beekeepers who prioritize environmental stewardship and ethical practices. Each harvest is done with care and love, ensuring that our products not only delight the senses but also support biodiversity and local communities. From the sun-drenched meadows of Europe to the wild landscapes of North America, our commitment to purity and sustainability shines through in every jar. Join us in savoring the authentic taste of organic honey, harvested with respect for the earth and its pollinators."}),r.jsx("p",{className:"text-base sm:text-lg text-gray-700 leading-relaxed",children:"As you explore our collection, you'll feel the warmth of our dedication to quality and the joy of connecting with nature's bounty. We're more than just a marketplace; we're a community united by the love of honey and the bees that make it possible."})]})]})}),r.jsx("section",{className:"py-12 sm:py-16 md:py-20 bg-white",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[r.jsxs("div",{className:"text-center mb-12 sm:mb-16",children:[r.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-honeybee-dark mb-6",children:"What Our Customers Say"}),r.jsx("p",{className:"text-base sm:text-lg text-gray-600",children:"Hear from farmers, beekeepers, and honey lovers who trust Bee Bridge"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8",children:[r.jsxs("div",{className:"bg-honeybee-light p-4 sm:p-6 rounded-lg shadow-md",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-honeybee-primary rounded-full flex items-center justify-center text-white font-bold text-sm sm:text-base",children:"JD"}),r.jsxs("div",{className:"ml-3 sm:ml-4",children:[r.jsx("h4",{className:"font-semibold text-honeybee-dark text-sm sm:text-base",children:"John Doe"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Organic Farmer"})]})]}),r.jsx("p",{className:"text-gray-700 italic text-sm sm:text-base",children:'"Bee Bridge has revolutionized how I sell my honey. The platform is easy to use and connects me directly with consumers who appreciate quality."'})]}),r.jsxs("div",{className:"bg-honeybee-light p-4 sm:p-6 rounded-lg shadow-md",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-honeybee-primary rounded-full flex items-center justify-center text-white font-bold text-sm sm:text-base",children:"SM"}),r.jsxs("div",{className:"ml-3 sm:ml-4",children:[r.jsx("h4",{className:"font-semibold text-honeybee-dark text-sm sm:text-base",children:"Sarah Miller"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Home Chef"})]})]}),r.jsx("p",{className:"text-gray-700 italic text-sm sm:text-base",children:`"The honey from Bee Bridge is pure and delicious. I love knowing it's sourced sustainably and supports local beekeepers."`})]}),r.jsxs("div",{className:"bg-honeybee-light p-4 sm:p-6 rounded-lg shadow-md",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-honeybee-primary rounded-full flex items-center justify-center text-white font-bold text-sm sm:text-base",children:"RB"}),r.jsxs("div",{className:"ml-3 sm:ml-4",children:[r.jsx("h4",{className:"font-semibold text-honeybee-dark text-sm sm:text-base",children:"Robert Brown"}),r.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Beekeeper"})]})]}),r.jsx("p",{className:"text-gray-700 italic text-sm sm:text-base",children:`"Partnering with Bee Bridge has allowed me to focus on beekeeping while they handle the marketplace. It's a win-win for everyone."`})]})]})]})})]})}const fa=()=>r.jsx("div",{className:"bg-honeybee-background text-honeybee-secondary",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 md:py-24",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("h1",{className:"text-3xl md:text-4xl font-serif font-bold text-honeybee-primary",children:"About Bee Bridge"}),r.jsx("p",{className:"mt-4 text-base md:text-lg max-w-2xl mx-auto",children:"Our passion for honey is rooted in a deep respect for nature and the incredible work of bees."})]}),r.jsxs("div",{className:"mt-12 md:mt-20 grid md:grid-cols-2 gap-8 md:gap-16 items-center",children:[r.jsx("div",{children:r.jsx("img",{src:"https://static.vecteezy.com/system/resources/thumbnails/004/454/157/small_2x/honey-can-realistic-composition-vector.jpg",alt:"Beekeeper",className:"rounded-lg shadow-lg w-full"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl md:text-3xl font-serif font-bold mb-4",children:"Our Story"}),r.jsx("p",{className:"mb-4 text-sm md:text-base",children:"Bee Bridge was founded with a simple mission: to bring the purest, most delicious honey from our hives to your home. We believe in sustainable beekeeping practices that prioritize the health of our bees and the environment."}),r.jsx("p",{className:"text-sm md:text-base",children:"Our farms are dedicated to sustainable practices, and through our website, we connect consumers directly with the source, fostering transparency and trust in every jar of honey."})]})]}),r.jsxs("div",{className:"mt-12 md:mt-20 text-center",children:[r.jsx("h2",{className:"text-2xl md:text-3xl font-serif font-bold mb-8",children:"Our Values"}),r.jsxs("div",{className:"grid md:grid-cols-3 gap-6 md:gap-12",children:[r.jsxs("div",{className:"p-4 md:p-6 border border-honeybee-light rounded-lg",children:[r.jsx("h3",{className:"text-lg md:text-xl font-serif font-bold mb-2",children:"Sustainability"}),r.jsx("p",{className:"text-sm md:text-base",children:"We are committed to protecting our planet and its precious pollinators."})]}),r.jsxs("div",{className:"p-4 md:p-6 border border-honeybee-light rounded-lg",children:[r.jsx("h3",{className:"text-lg md:text-xl font-serif font-bold mb-2",children:"Quality"}),r.jsx("p",{className:"text-sm md:text-base",children:"We deliver only the finest, 100% pure and raw honey."})]}),r.jsxs("div",{className:"p-4 md:p-6 border border-honeybee-light rounded-lg",children:[r.jsx("h3",{className:"text-lg md:text-xl font-serif font-bold mb-2",children:"Community"}),r.jsx("p",{className:"text-sm md:text-base",children:"We support local beekeepers and educate our community about the importance of bees."})]})]})]})]})}),ma={primary:"gradient-bg-primary hover:shadow-2xl text-black hover:text-black border-0 modern-shadow-hover transform hover:scale-105",secondary:"bg-honeybee-secondary hover:bg-honeybee-accent text-white modern-shadow-hover",accent:"gradient-bg-accent hover:shadow-xl text-white modern-shadow-hover transform hover:scale-105",ghost:"hover:bg-gray-100/10 text-honeybee-primary hover:text-honeybee-accent",light:"glass-effect text-honeybee-dark hover:bg-honeybee-primary hover:text-black modern-shadow-hover"},pa={default:"py-3 px-6",icon:"h-10 w-10"},he=({children:s,variant:e="primary",size:t="default",className:n="",onClick:a,...i})=>{const[o,l]=j.useState(!1),[c,d]=j.useState({}),u=m=>{const h=m.currentTarget.getBoundingClientRect(),p=Math.max(h.width,h.height),b=m.clientX-h.left-p/2,x=m.clientY-h.top-p/2;d({width:p,height:p,left:b,top:x}),l(!0),setTimeout(()=>l(!1),600),a&&a(m)};return r.jsxs("button",{className:`relative overflow-hidden rounded-lg shadow-lg transition-all duration-500 cubic-bezier(0.4, 0, 0.2, 1) focus:outline-none focus:ring-4 focus:ring-honeybee-accent ${ma[e]} ${pa[t]} ${n}`,onClick:u,...i,children:[s,o&&r.jsx("span",{className:"button-ripple absolute",style:c})]})},ga=()=>r.jsx("div",{className:"bg-honeybee-background text-honeybee-secondary",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 md:py-24",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("h1",{className:"text-3xl md:text-4xl font-serif font-bold text-honeybee-primary",children:"Contact Us"}),r.jsx("p",{className:"mt-4 text-base md:text-lg max-w-2xl mx-auto",children:"We'd love to hear from you! Whether you have a question about our products, our practices, or anything else, our team is ready to answer all your questions."})]}),r.jsxs("div",{className:"mt-12 md:mt-20 grid md:grid-cols-2 gap-8 md:gap-16",children:[r.jsxs("div",{className:"bg-white p-6 md:p-8 rounded-lg shadow-lg",children:[r.jsx("h2",{className:"text-xl md:text-2xl font-serif font-bold mb-6",children:"Send us a message"}),r.jsxs("form",{children:[r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{htmlFor:"name",className:"block text-sm font-medium mb-1",children:"Name"}),r.jsx("input",{type:"text",id:"name",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-md focus:ring-2 focus:ring-honeybee-primary focus:border-honeybee-primary bg-white text-base"})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{htmlFor:"email",className:"block text-sm font-medium mb-1",children:"Email"}),r.jsx("input",{type:"email",id:"email",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-md focus:ring-2 focus:ring-honeybee-primary focus:border-honeybee-primary bg-white text-base"})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{htmlFor:"message",className:"block text-sm font-medium mb-1",children:"Message"}),r.jsx("textarea",{id:"message",rows:4,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-md focus:ring-2 focus:ring-honeybee-primary focus:border-honeybee-primary bg-white text-base"})]}),r.jsx(he,{type:"submit",variant:"primary",className:"w-full py-3 text-base",children:"Send Message"})]})]}),r.jsxs("div",{className:"space-y-6 md:space-y-8",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg md:text-xl font-serif font-bold mb-2",children:"Email Us"}),r.jsx("p",{className:"text-sm md:text-base",children:"beebridgeshop@gmail.com"})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg md:text-xl font-serif font-bold mb-2",children:"Call Us"}),r.jsx("p",{className:"text-sm md:text-base",children:"(123) 456-7890"})]})]})]})]})}),vs=j.createContext(void 0),xa=({children:s})=>{const[e,t]=j.useState([]),n=c=>{const d=c.name.includes("Subscription Plan"),u=e.some(m=>m.name.includes("Subscription Plan"));if(d)t([{...c,quantity:1}]);else{if(u)return;t(m=>m.find(h=>h.id===c.id)?m.map(h=>h.id===c.id?{...h,quantity:Math.min(h.quantity+1,5)}:h):[...m,{...c,quantity:1}])}},a=c=>{t(d=>d.filter(u=>u.id!==c))},i=(c,d)=>{if(d<=0){a(c);return}const u=Math.min(d,5);t(m=>m.map(f=>f.id===c?{...f,quantity:u}:f))},o=()=>{t([])},l=()=>e.reduce((c,d)=>c+d.price*d.quantity,0);return r.jsx(vs.Provider,{value:{cartItems:e,addToCart:n,removeFromCart:a,updateQuantity:i,clearCart:o,getTotal:l},children:s})},it=()=>{const s=j.useContext(vs);if(!s)throw new Error("useCart must be used within a CartProvider");return s};var Pe={},_t={},or=function(s,e){return or=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])},or(s,e)};function ws(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");or(s,e);function t(){this.constructor=s}s.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Ut=function(){return Ut=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Ut.apply(this,arguments)};function ot(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(s);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(s,n[a])&&(t[n[a]]=s[n[a]]);return t}function js(s,e,t,n){var a=arguments.length,i=a<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(o=s[l])&&(i=(a<3?o(i):a>3?o(e,t,i):o(e,t))||i);return a>3&&i&&Object.defineProperty(e,t,i),i}function _s(s,e){return function(t,n){e(t,n,s)}}function ks(s,e,t,n,a,i){function o(_){if(_!==void 0&&typeof _!="function")throw new TypeError("Function expected");return _}for(var l=n.kind,c=l==="getter"?"get":l==="setter"?"set":"value",d=!e&&s?n.static?s:s.prototype:null,u=e||(d?Object.getOwnPropertyDescriptor(d,n.name):{}),m,f=!1,h=t.length-1;h>=0;h--){var p={};for(var b in n)p[b]=b==="access"?{}:n[b];for(var b in n.access)p.access[b]=n.access[b];p.addInitializer=function(_){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(o(_||null))};var x=(0,t[h])(l==="accessor"?{get:u.get,set:u.set}:u[c],p);if(l==="accessor"){if(x===void 0)continue;if(x===null||typeof x!="object")throw new TypeError("Object expected");(m=o(x.get))&&(u.get=m),(m=o(x.set))&&(u.set=m),(m=o(x.init))&&a.unshift(m)}else(m=o(x))&&(l==="field"?a.unshift(m):u[c]=m)}d&&Object.defineProperty(d,n.name,u),f=!0}function Ns(s,e,t){for(var n=arguments.length>2,a=0;a<e.length;a++)t=n?e[a].call(s,t):e[a].call(s);return n?t:void 0}function Ss(s){return typeof s=="symbol"?s:"".concat(s)}function Es(s,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(s,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function Cs(s,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,e)}function N(s,e,t,n){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(u){try{d(n.next(u))}catch(m){o(m)}}function c(u){try{d(n.throw(u))}catch(m){o(m)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(s,e||[])).next())})}function Ts(s,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(u){return c([d,u])}}function c(d){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(t=0)),t;)try{if(n=1,a&&(i=d[0]&2?a.return:d[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,d[1])).done)return i;switch(a=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,a=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){t.label=d[1];break}if(d[0]===6&&t.label<i[1]){t.label=i[1],i=d;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(d);break}i[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(s,t)}catch(u){d=[6,u],a=0}finally{n=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var Ht=Object.create?(function(s,e,t,n){n===void 0&&(n=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(s,n,a)}):(function(s,e,t,n){n===void 0&&(n=t),s[n]=e[t]});function Os(s,e){for(var t in s)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Ht(e,s,t)}function Dt(s){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&s[e],n=0;if(t)return t.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Nr(s,e){var t=typeof Symbol=="function"&&s[Symbol.iterator];if(!t)return s;var n=t.call(s),a,i=[],o;try{for(;(e===void 0||e-- >0)&&!(a=n.next()).done;)i.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(o)throw o.error}}return i}function Ps(){for(var s=[],e=0;e<arguments.length;e++)s=s.concat(Nr(arguments[e]));return s}function As(){for(var s=0,e=0,t=arguments.length;e<t;e++)s+=arguments[e].length;for(var n=Array(s),a=0,e=0;e<t;e++)for(var i=arguments[e],o=0,l=i.length;o<l;o++,a++)n[a]=i[o];return n}function Rs(s,e,t){if(t||arguments.length===2)for(var n=0,a=e.length,i;n<a;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return s.concat(i||Array.prototype.slice.call(e))}function nt(s){return this instanceof nt?(this.v=s,this):new nt(s)}function Is(s,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(s,e||[]),a,i=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),a[Symbol.asyncIterator]=function(){return this},a;function o(h){return function(p){return Promise.resolve(p).then(h,m)}}function l(h,p){n[h]&&(a[h]=function(b){return new Promise(function(x,_){i.push([h,b,x,_])>1||c(h,b)})},p&&(a[h]=p(a[h])))}function c(h,p){try{d(n[h](p))}catch(b){f(i[0][3],b)}}function d(h){h.value instanceof nt?Promise.resolve(h.value.v).then(u,m):f(i[0][2],h)}function u(h){c("next",h)}function m(h){c("throw",h)}function f(h,p){h(p),i.shift(),i.length&&c(i[0][0],i[0][1])}}function $s(s){var e,t;return e={},n("next"),n("throw",function(a){throw a}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(a,i){e[a]=s[a]?function(o){return(t=!t)?{value:nt(s[a](o)),done:!1}:i?i(o):o}:i}}function Ls(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=s[Symbol.asyncIterator],t;return e?e.call(s):(s=typeof Dt=="function"?Dt(s):s[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=s[i]&&function(o){return new Promise(function(l,c){o=s[i](o),a(l,c,o.done,o.value)})}}function a(i,o,l,c){Promise.resolve(c).then(function(d){i({value:d,done:l})},o)}}function Us(s,e){return Object.defineProperty?Object.defineProperty(s,"raw",{value:e}):s.raw=e,s}var ba=Object.create?(function(s,e){Object.defineProperty(s,"default",{enumerable:!0,value:e})}):function(s,e){s.default=e},lr=function(s){return lr=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},lr(s)};function Ds(s){if(s&&s.__esModule)return s;var e={};if(s!=null)for(var t=lr(s),n=0;n<t.length;n++)t[n]!=="default"&&Ht(e,s,t[n]);return ba(e,s),e}function Bs(s){return s&&s.__esModule?s:{default:s}}function Ms(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)}function Fs(s,e,t,n,a){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!a:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?a.call(s,t):a?a.value=t:e.set(s,t),t}function qs(s,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof s=="function"?e===s:s.has(e)}function zs(s,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var n,a;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=e[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=e[Symbol.dispose],t&&(a=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");a&&(n=function(){try{a.call(this)}catch(i){return Promise.reject(i)}}),s.stack.push({value:e,dispose:n,async:t})}else t&&s.stack.push({async:!0});return e}var ya=typeof SuppressedError=="function"?SuppressedError:function(s,e,t){var n=new Error(t);return n.name="SuppressedError",n.error=s,n.suppressed=e,n};function Ws(s){function e(i){s.error=s.hasError?new ya(i,s.error,"An error was suppressed during disposal."):i,s.hasError=!0}var t,n=0;function a(){for(;t=s.stack.pop();)try{if(!t.async&&n===1)return n=0,s.stack.push(t),Promise.resolve().then(a);if(t.dispose){var i=t.dispose.call(t.value);if(t.async)return n|=2,Promise.resolve(i).then(a,function(o){return e(o),a()})}else n|=1}catch(o){e(o)}if(n===1)return s.hasError?Promise.reject(s.error):Promise.resolve();if(s.hasError)throw s.error}return a()}function Vs(s,e){return typeof s=="string"&&/^\.\.?\//.test(s)?s.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,n,a,i,o){return n?e?".jsx":".js":a&&(!i||!o)?t:a+i+"."+o.toLowerCase()+"js"}):s}const va={__extends:ws,__assign:Ut,__rest:ot,__decorate:js,__param:_s,__esDecorate:ks,__runInitializers:Ns,__propKey:Ss,__setFunctionName:Es,__metadata:Cs,__awaiter:N,__generator:Ts,__createBinding:Ht,__exportStar:Os,__values:Dt,__read:Nr,__spread:Ps,__spreadArrays:As,__spreadArray:Rs,__await:nt,__asyncGenerator:Is,__asyncDelegator:$s,__asyncValues:Ls,__makeTemplateObject:Us,__importStar:Ds,__importDefault:Bs,__classPrivateFieldGet:Ms,__classPrivateFieldSet:Fs,__classPrivateFieldIn:qs,__addDisposableResource:zs,__disposeResources:Ws,__rewriteRelativeImportExtension:Vs},wa=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:zs,get __assign(){return Ut},__asyncDelegator:$s,__asyncGenerator:Is,__asyncValues:Ls,__await:nt,__awaiter:N,__classPrivateFieldGet:Ms,__classPrivateFieldIn:qs,__classPrivateFieldSet:Fs,__createBinding:Ht,__decorate:js,__disposeResources:Ws,__esDecorate:ks,__exportStar:Os,__extends:ws,__generator:Ts,__importDefault:Bs,__importStar:Ds,__makeTemplateObject:Us,__metadata:Cs,__param:_s,__propKey:Ss,__read:Nr,__rest:ot,__rewriteRelativeImportExtension:Vs,__runInitializers:Ns,__setFunctionName:Es,__spread:Ps,__spreadArray:Rs,__spreadArrays:As,__values:Dt,default:va},Symbol.toStringTag,{value:"Module"})),ja=s=>s?(...e)=>s(...e):(...e)=>fetch(...e);let Gt=class extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}},Hs=class extends Gt{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}},cr=class extends Gt{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}},dr=class extends Gt{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}};var Bt;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(Bt||(Bt={}));class _a{constructor(e,{headers:t={},customFetch:n,region:a=Bt.Any}={}){this.url=e,this.headers=t,this.region=a,this.fetch=ja(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return N(this,arguments,void 0,function*(t,n={}){var a;let i,o;try{const{headers:l,method:c,body:d,signal:u,timeout:m}=n;let f={},{region:h}=n;h||(h=this.region);const p=new URL(`${this.url}/${t}`);h&&h!=="any"&&(f["x-region"]=h,p.searchParams.set("forceFunctionRegion",h));let b;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",b=d):typeof d=="string"?(f["Content-Type"]="text/plain",b=d):typeof FormData<"u"&&d instanceof FormData?b=d:(f["Content-Type"]="application/json",b=JSON.stringify(d)):b=d;let x=u;m&&(o=new AbortController,i=setTimeout(()=>o.abort(),m),u?(x=o.signal,u.addEventListener("abort",()=>o.abort())):x=o.signal);const _=yield this.fetch(p.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),l),body:b,signal:x}).catch(T=>{throw new Hs(T)}),w=_.headers.get("x-relay-error");if(w&&w==="true")throw new cr(_);if(!_.ok)throw new dr(_);let v=((a=_.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),k;return v==="application/json"?k=yield _.json():v==="application/octet-stream"||v==="application/pdf"?k=yield _.blob():v==="text/event-stream"?k=_:v==="multipart/form-data"?k=yield _.formData():k=yield _.text(),{data:k,error:null,response:_}}catch(l){return{data:null,error:l,response:l instanceof dr||l instanceof cr?l.context:void 0}}finally{i&&clearTimeout(i)}})}}const ka=Object.freeze(Object.defineProperty({__proto__:null,get FunctionRegion(){return Bt},FunctionsClient:_a,FunctionsError:Gt,FunctionsFetchError:Hs,FunctionsHttpError:dr,FunctionsRelayError:cr},Symbol.toStringTag,{value:"Module"})),Gs=xt(ka);var ue={};const lt=xt(wa);var kt={},Nt={},St={},Et={},Ct={},Tt={},Fr;function Ks(){if(Fr)return Tt;Fr=1,Object.defineProperty(Tt,"__esModule",{value:!0});class s extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Tt.default=s,Tt}var qr;function Js(){if(qr)return Ct;qr=1,Object.defineProperty(Ct,"__esModule",{value:!0});const e=lt.__importDefault(Ks());let t=class{constructor(a){var i,o;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=(i=a.shouldThrowOnError)!==null&&i!==void 0?i:!1,this.signal=a.signal,this.isMaybeSingle=(o=a.isMaybeSingle)!==null&&o!==void 0?o:!1,a.fetch?this.fetch=a.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,i){return this.headers=new Headers(this.headers),this.headers.set(a,i),this}then(a,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var d,u,m,f;let h=null,p=null,b=null,x=c.status,_=c.statusText;if(c.ok){if(this.method!=="HEAD"){const T=await c.text();T===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((d=this.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?p=T:p=JSON.parse(T))}const v=(u=this.headers.get("Prefer"))===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),k=(m=c.headers.get("content-range"))===null||m===void 0?void 0:m.split("/");v&&k&&k.length>1&&(b=parseInt(k[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(p)&&(p.length>1?(h={code:"PGRST116",details:`Results contain ${p.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},p=null,b=null,x=406,_="Not Acceptable"):p.length===1?p=p[0]:p=null)}else{const v=await c.text();try{h=JSON.parse(v),Array.isArray(h)&&c.status===404&&(p=[],h=null,x=200,_="OK")}catch{c.status===404&&v===""?(x=204,_="No Content"):h={message:v}}if(h&&this.isMaybeSingle&&(!((f=h?.details)===null||f===void 0)&&f.includes("0 rows"))&&(h=null,x=200,_="OK"),h&&this.shouldThrowOnError)throw new e.default(h)}return{error:h,data:p,count:b,status:x,statusText:_}});return this.shouldThrowOnError||(l=l.catch(c=>{var d,u,m,f,h,p;let b="";const x=c?.cause;if(x){const _=(d=x?.message)!==null&&d!==void 0?d:"",w=(u=x?.code)!==null&&u!==void 0?u:"";b=`${(m=c?.name)!==null&&m!==void 0?m:"FetchError"}: ${c?.message}`,b+=`

Caused by: ${(f=x?.name)!==null&&f!==void 0?f:"Error"}: ${_}`,w&&(b+=` (${w})`),x?.stack&&(b+=`
${x.stack}`)}else b=(h=c?.stack)!==null&&h!==void 0?h:"";return{error:{message:`${(p=c?.name)!==null&&p!==void 0?p:"FetchError"}: ${c?.message}`,details:b,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),l.then(a,i)}returns(){return this}overrideTypes(){return this}};return Ct.default=t,Ct}var zr;function Ys(){if(zr)return Et;zr=1,Object.defineProperty(Et,"__esModule",{value:!0});const e=lt.__importDefault(Js());let t=class extends e.default{select(a){let i=!1;const o=(a??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:i=!0,nullsFirst:o,foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.order`:"order",u=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${u?`${u},`:""}${a}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:i,referencedTable:o=i}={}){const l=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${a}`),this}range(a,i,{foreignTable:o,referencedTable:l=o}={}){const c=typeof l>"u"?"offset":`${l}.offset`,d=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${a}`),this.url.searchParams.set(d,`${i-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:i=!1,settings:o=!1,buffers:l=!1,wal:c=!1,format:d="text"}={}){var u;const m=[a?"analyze":null,i?"verbose":null,o?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),f=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${f}"; options=${m};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}};return Et.default=t,Et}var Wr;function Sr(){if(Wr)return St;Wr=1,Object.defineProperty(St,"__esModule",{value:!0});const e=lt.__importDefault(Ys()),t=new RegExp("[,()]");let n=class extends e.default{eq(i,o){return this.url.searchParams.append(i,`eq.${o}`),this}neq(i,o){return this.url.searchParams.append(i,`neq.${o}`),this}gt(i,o){return this.url.searchParams.append(i,`gt.${o}`),this}gte(i,o){return this.url.searchParams.append(i,`gte.${o}`),this}lt(i,o){return this.url.searchParams.append(i,`lt.${o}`),this}lte(i,o){return this.url.searchParams.append(i,`lte.${o}`),this}like(i,o){return this.url.searchParams.append(i,`like.${o}`),this}likeAllOf(i,o){return this.url.searchParams.append(i,`like(all).{${o.join(",")}}`),this}likeAnyOf(i,o){return this.url.searchParams.append(i,`like(any).{${o.join(",")}}`),this}ilike(i,o){return this.url.searchParams.append(i,`ilike.${o}`),this}ilikeAllOf(i,o){return this.url.searchParams.append(i,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(i,o){return this.url.searchParams.append(i,`ilike(any).{${o.join(",")}}`),this}regexMatch(i,o){return this.url.searchParams.append(i,`match.${o}`),this}regexIMatch(i,o){return this.url.searchParams.append(i,`imatch.${o}`),this}is(i,o){return this.url.searchParams.append(i,`is.${o}`),this}isDistinct(i,o){return this.url.searchParams.append(i,`isdistinct.${o}`),this}in(i,o){const l=Array.from(new Set(o)).map(c=>typeof c=="string"&&t.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(i,`in.(${l})`),this}contains(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cs.{${o.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(o)}`),this}containedBy(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cd.{${o.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(o)}`),this}rangeGt(i,o){return this.url.searchParams.append(i,`sr.${o}`),this}rangeGte(i,o){return this.url.searchParams.append(i,`nxl.${o}`),this}rangeLt(i,o){return this.url.searchParams.append(i,`sl.${o}`),this}rangeLte(i,o){return this.url.searchParams.append(i,`nxr.${o}`),this}rangeAdjacent(i,o){return this.url.searchParams.append(i,`adj.${o}`),this}overlaps(i,o){return typeof o=="string"?this.url.searchParams.append(i,`ov.${o}`):this.url.searchParams.append(i,`ov.{${o.join(",")}}`),this}textSearch(i,o,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const u=l===void 0?"":`(${l})`;return this.url.searchParams.append(i,`${d}fts${u}.${o}`),this}match(i){return Object.entries(i).forEach(([o,l])=>{this.url.searchParams.append(o,`eq.${l}`)}),this}not(i,o,l){return this.url.searchParams.append(i,`not.${o}.${l}`),this}or(i,{foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${i})`),this}filter(i,o,l){return this.url.searchParams.append(i,`${o}.${l}`),this}};return St.default=n,St}var Vr;function Qs(){if(Vr)return Nt;Vr=1,Object.defineProperty(Nt,"__esModule",{value:!0});const e=lt.__importDefault(Sr());let t=class{constructor(a,{headers:i={},schema:o,fetch:l}){this.url=a,this.headers=new Headers(i),this.schema=o,this.fetch=l}select(a,i){const{head:o=!1,count:l}=i??{},c=o?"HEAD":"GET";let d=!1;const u=(a??"*").split("").map(m=>/\s/.test(m)&&!d?"":(m==='"'&&(d=!d),m)).join("");return this.url.searchParams.set("select",u),l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:i,defaultToNull:o=!0}={}){var l;const c="POST";if(i&&this.headers.append("Prefer",`count=${i}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const d=a.reduce((u,m)=>u.concat(Object.keys(m)),[]);if(d.length>0){const u=[...new Set(d)].map(m=>`"${m}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(a,{onConflict:i,ignoreDuplicates:o=!1,count:l,defaultToNull:c=!0}={}){var d;const u="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),i!==void 0&&this.url.searchParams.set("on_conflict",i),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const m=a.reduce((f,h)=>f.concat(Object.keys(h)),[]);if(m.length>0){const f=[...new Set(m)].map(h=>`"${h}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(a,{count:i}={}){var o;const l="PATCH";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:a}={}){var i;const o="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};return Nt.default=t,Nt}var Hr;function Na(){if(Hr)return kt;Hr=1,Object.defineProperty(kt,"__esModule",{value:!0});const s=lt,e=s.__importDefault(Qs()),t=s.__importDefault(Sr());let n=class Xs{constructor(i,{headers:o={},schema:l,fetch:c}={}){this.url=i,this.headers=new Headers(o),this.schemaName=l,this.fetch=c}from(i){if(!i||typeof i!="string"||i.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const o=new URL(`${this.url}/${i}`);return new e.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new Xs(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,o={},{head:l=!1,get:c=!1,count:d}={}){var u;let m;const f=new URL(`${this.url}/rpc/${i}`);let h;l||c?(m=l?"HEAD":"GET",Object.entries(o).filter(([b,x])=>x!==void 0).map(([b,x])=>[b,Array.isArray(x)?`{${x.join(",")}}`:`${x}`]).forEach(([b,x])=>{f.searchParams.append(b,x)})):(m="POST",h=o);const p=new Headers(this.headers);return d&&p.set("Prefer",`count=${d}`),new t.default({method:m,url:f,headers:p,schema:this.schemaName,body:h,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}};return kt.default=n,kt}var Gr;function Zs(){if(Gr)return ue;Gr=1,Object.defineProperty(ue,"__esModule",{value:!0}),ue.PostgrestError=ue.PostgrestBuilder=ue.PostgrestTransformBuilder=ue.PostgrestFilterBuilder=ue.PostgrestQueryBuilder=ue.PostgrestClient=void 0;const s=lt,e=s.__importDefault(Na());ue.PostgrestClient=e.default;const t=s.__importDefault(Qs());ue.PostgrestQueryBuilder=t.default;const n=s.__importDefault(Sr());ue.PostgrestFilterBuilder=n.default;const a=s.__importDefault(Ys());ue.PostgrestTransformBuilder=a.default;const i=s.__importDefault(Js());ue.PostgrestBuilder=i.default;const o=s.__importDefault(Ks());return ue.PostgrestError=o.default,ue.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:i.default,PostgrestError:o.default},ue}class en{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const n=t.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const n=this.getWebSocketConstructor();return new n(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const Sa="2.87.1",Ea=`realtime-js/${Sa}`,tn="1.0.0",Ca="2.0.0",Kr=tn,ur=1e4,Ta=1e3,Oa=100;var Ve;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(Ve||(Ve={}));var re;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(re||(re={}));var _e;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(_e||(_e={}));var hr;(function(s){s.websocket="websocket"})(hr||(hr={}));var He;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(He||(He={}));class Pa{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,n;const a=(n=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(e){var t,n;const a=(n=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&n!==void 0?n:{},o=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,t,n){var a,i;const o=e.topic,l=(a=e.ref)!==null&&a!==void 0?a:"",c=(i=e.join_ref)!==null&&i!==void 0?i:"",d=e.payload.event,u=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},m=Object.keys(u).length===0?"":JSON.stringify(u);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`metadata length ${m.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+o.length+d.length+m.length,h=new ArrayBuffer(this.HEADER_LENGTH+f);let p=new DataView(h),b=0;p.setUint8(b++,this.KINDS.userBroadcastPush),p.setUint8(b++,c.length),p.setUint8(b++,l.length),p.setUint8(b++,o.length),p.setUint8(b++,d.length),p.setUint8(b++,m.length),p.setUint8(b++,t),Array.from(c,_=>p.setUint8(b++,_.charCodeAt(0))),Array.from(l,_=>p.setUint8(b++,_.charCodeAt(0))),Array.from(o,_=>p.setUint8(b++,_.charCodeAt(0))),Array.from(d,_=>p.setUint8(b++,_.charCodeAt(0))),Array.from(m,_=>p.setUint8(b++,_.charCodeAt(0)));var x=new Uint8Array(h.byteLength+n.byteLength);return x.set(new Uint8Array(h),0),x.set(new Uint8Array(n),h.byteLength),x.buffer}decode(e,t){if(this._isArrayBuffer(e)){let n=this._binaryDecode(e);return t(n)}if(typeof e=="string"){const n=JSON.parse(e),[a,i,o,l,c]=n;return t({join_ref:a,ref:i,topic:o,event:l,payload:c})}return t({})}_binaryDecode(e){const t=new DataView(e),n=t.getUint8(0),a=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,a)}}_decodeUserBroadcast(e,t,n){const a=t.getUint8(1),i=t.getUint8(2),o=t.getUint8(3),l=t.getUint8(4);let c=this.HEADER_LENGTH+4;const d=n.decode(e.slice(c,c+a));c=c+a;const u=n.decode(e.slice(c,c+i));c=c+i;const m=n.decode(e.slice(c,c+o));c=c+o;const f=e.slice(c,e.byteLength),h=l===this.JSON_ENCODING?JSON.parse(n.decode(f)):f,p={type:this.BROADCAST_EVENT,event:u,payload:h};return o>0&&(p.meta=JSON.parse(m)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e?.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([n])=>t.includes(n)))}}class rn{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var K;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(K||(K={}));const Jr=(s,e,t={})=>{var n;const a=(n=t.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=Aa(o,s,e,a),i),{}):{}},Aa=(s,e,t,n)=>{const a=e.find(l=>l.name===s),i=a?.type,o=t[s];return i&&!n.includes(i)?sn(i,o):fr(o)},sn=(s,e)=>{if(s.charAt(0)==="_"){const t=s.slice(1,s.length);return La(e,t)}switch(s){case K.bool:return Ra(e);case K.float4:case K.float8:case K.int2:case K.int4:case K.int8:case K.numeric:case K.oid:return Ia(e);case K.json:case K.jsonb:return $a(e);case K.timestamp:return Ua(e);case K.abstime:case K.date:case K.daterange:case K.int4range:case K.int8range:case K.money:case K.reltime:case K.text:case K.time:case K.timestamptz:case K.timetz:case K.tsrange:case K.tstzrange:return fr(e);default:return fr(e)}},fr=s=>s,Ra=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},Ia=s=>{if(typeof s=="string"){const e=parseFloat(s);if(!Number.isNaN(e))return e}return s},$a=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch(e){return console.log(`JSON parse error: ${e}`),s}return s},La=(s,e)=>{if(typeof s!="string")return s;const t=s.length-1,n=s[t];if(s[0]==="{"&&n==="}"){let i;const o=s.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>sn(e,l))}return s},Ua=s=>typeof s=="string"?s.replace(" ","T"):s,nn=s=>{const e=new URL(s);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Xt{constructor(e,t,n={},a=ur){this.channel=e,this.event=t,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var mr;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(mr||(mr={}));let an=class At{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=At.syncState(this.state,a,i,o),this.pendingDiffs.forEach(c=>{this.state=At.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=At.syncDiff(this.state,a,i,o),l())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,a){const i=this.cloneDeep(e),o=this.transformState(t),l={},c={};return this.map(i,(d,u)=>{o[d]||(c[d]=u)}),this.map(o,(d,u)=>{const m=i[d];if(m){const f=u.map(x=>x.presence_ref),h=m.map(x=>x.presence_ref),p=u.filter(x=>h.indexOf(x.presence_ref)<0),b=m.filter(x=>f.indexOf(x.presence_ref)<0);p.length>0&&(l[d]=p),b.length>0&&(c[d]=b)}else l[d]=u}),this.syncDiff(i,{joins:l,leaves:c},n,a)}static syncDiff(e,t,n,a){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(l,c)=>{var d;const u=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),u.length>0){const m=e[l].map(h=>h.presence_ref),f=u.filter(h=>m.indexOf(h.presence_ref)<0);e[l].unshift(...f)}n(l,u,c)}),this.map(o,(l,c)=>{let d=e[l];if(!d)return;const u=c.map(m=>m.presence_ref);d=d.filter(m=>u.indexOf(m.presence_ref)<0),e[l]=d,a(l,d,c),d.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const a=e[n];return"metas"in a?t[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[n]=a,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}};var pr;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(pr||(pr={}));var rt;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(rt||(rt={}));var Te;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(Te||(Te={}));const Da=re;let on=class ht{constructor(e,t={config:{}},n){var a,i;if(this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=re.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Xt(this,_e.join,this.params,this.timeout),this.rejoinTimer=new rn(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=re.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=re.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=re.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=re.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=re.errored,this.rejoinTimer.scheduleTimeout())}),this._on(_e.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new an(this),this.broadcastEndpointURL=nn(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var n,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==re.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,d=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(h=>h.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[rt.PRESENCE]&&this.bindings[rt.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,m={},f={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(h=>e?.(Te.CHANNEL_ERROR,h)),this._onClose(()=>e?.(Te.CLOSED)),this.updateJoinPayload(Object.assign({config:f},m)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:h})=>{var p;if(this.socket._isManualToken()||this.socket.setAuth(),h===void 0){e?.(Te.SUBSCRIBED);return}else{const b=this.bindings.postgres_changes,x=(p=b?.length)!==null&&p!==void 0?p:0,_=[];for(let w=0;w<x;w++){const v=b[w],{filter:{event:k,schema:T,table:L,filter:z}}=v,D=h&&h[w];if(D&&D.event===k&&ht.isFilterValueEqual(D.schema,T)&&ht.isFilterValueEqual(D.table,L)&&ht.isFilterValueEqual(D.filter,z))_.push(Object.assign(Object.assign({},v),{id:D.id}));else{this.unsubscribe(),this.state=re.errored,e?.(Te.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=_,e&&e(Te.SUBSCRIBED);return}}).receive("error",h=>{this.state=re.errored,e?.(Te.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{e?.(Te.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this.state===re.joined&&e===rt.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,n)}async httpSend(e,t,n={}){var a;const i=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(t==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:i,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const d=await l.json();c=d.error||d.message||c}catch{}return Promise.reject(new Error(c))}async send(e,t={}){var n,a;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=d.body)===null||a===void 0?void 0:a.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=re.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(_e.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new Xt(this,_e.leave,{},e),n.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=re.closed,this.bindings={}}async _fetchWithTimeout(e,t,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(i),o}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Xt(this,e,t,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Oa){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var a,i;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=_e;if(n&&[l,c,d,u].indexOf(o)>=0&&n!==this._joinRef())return;let f=this._onMessage(o,t,n);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(h=>{var p,b,x;return((p=h.filter)===null||p===void 0?void 0:p.event)==="*"||((x=(b=h.filter)===null||b===void 0?void 0:b.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===o}).map(h=>h.callback(f,n)):(i=this.bindings[o])===null||i===void 0||i.filter(h=>{var p,b,x,_,w,v;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in h){const k=h.id,T=(p=h.filter)===null||p===void 0?void 0:p.event;return k&&((b=t.ids)===null||b===void 0?void 0:b.includes(k))&&(T==="*"||T?.toLocaleLowerCase()===((x=t.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const k=(w=(_=h?.filter)===null||_===void 0?void 0:_.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return k==="*"||k===((v=t?.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===o}).map(h=>{if(typeof f=="object"&&"ids"in f){const p=f.data,{schema:b,table:x,commit_timestamp:_,type:w,errors:v}=p;f=Object.assign(Object.assign({},{schema:b,table:x,commit_timestamp:_,eventType:w,new:{},old:{},errors:v}),this._getPayloadRecords(p))}h.callback(f,n)})}_isClosed(){return this.state===re.closed}_isJoined(){return this.state===re.joined}_isJoining(){return this.state===re.joining}_isLeaving(){return this.state===re.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const a=e.toLocaleLowerCase(),i={type:a,filter:t,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&ht.isEqual(a.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(_e.close,{},e)}_onError(e){this._on(_e.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=re.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Jr(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Jr(e.columns,e.old_record)),t}};const Zt=()=>{},Ot={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Ba=[1e3,2e3,5e3,1e4],Ma=1e4,Fa=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;let qa=class{constructor(e,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=ur,this.transport=null,this.heartbeatIntervalMs=Ot.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Zt,this.ref=0,this.reconnectTimer=null,this.vsn=Kr,this.logger=Zt,this.conn=null,this.sendBuffer=[],this.serializer=new Pa,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>a?(...i)=>a(...i):(...i)=>fetch(...i),!(!((n=t?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${hr.websocket}`,this.httpEndpoint=nn(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=en.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Ve.connecting:return He.Connecting;case Ve.open:return He.Open;case Ve.closing:return He.Closing;default:return He.Closed}}isConnected(){return this.connectionState()===He.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const n=`realtime:${e}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new on(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:n,payload:a,ref:i}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${t} ${n} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Ta,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Ot.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:i,ref:o}=t,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${n} ${a} ${l}`.trim(),i),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(a,i,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Ve.open||this.conn.readyState===Ve.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(_e.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",a=new URLSearchParams(t);return`${e}${n}${a}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([Fa],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,n=!1;if(e)t=e,n=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),t=this.accessTokenValue}else t=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(a=>{const i={access_token:t,version:Ea};t&&a.updateJoinPayload(i),a.joinedOnce&&a._isJoined()&&a._push(_e.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(t)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new rn(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ot.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,n,a,i,o,l,c,d,u,m,f,h;switch(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(n=e?.timeout)!==null&&n!==void 0?n:ur,this.heartbeatIntervalMs=(a=e?.heartbeatIntervalMs)!==null&&a!==void 0?a:Ot.HEARTBEAT_INTERVAL,this.worker=(i=e?.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e?.heartbeatCallback)!==null&&l!==void 0?l:Zt,this.vsn=(c=e?.vsn)!==null&&c!==void 0?c:Kr,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e?.reconnectAfterMs)!==null&&d!==void 0?d:(p=>Ba[p-1]||Ma),this.vsn){case tn:this.encode=(u=e?.encode)!==null&&u!==void 0?u:((p,b)=>b(JSON.stringify(p))),this.decode=(m=e?.decode)!==null&&m!==void 0?m:((p,b)=>b(JSON.parse(p)));break;case Ca:this.encode=(f=e?.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(h=e?.decode)!==null&&h!==void 0?h:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}};const za=Object.freeze(Object.defineProperty({__proto__:null,REALTIME_CHANNEL_STATES:Da,get REALTIME_LISTEN_TYPES(){return rt},get REALTIME_POSTGRES_CHANGES_LISTEN_EVENT(){return pr},get REALTIME_PRESENCE_LISTEN_EVENTS(){return mr},get REALTIME_SUBSCRIBE_STATES(){return Te},RealtimeChannel:on,RealtimeClient:qa,RealtimePresence:an,WebSocketFactory:en},Symbol.toStringTag,{value:"Module"})),ln=xt(za);class yt extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Y(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}class cn extends yt{constructor(e,t,n){super(e),this.name="StorageApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Mt extends yt{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}const Er=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),Wa=()=>Response,gr=s=>{if(Array.isArray(s))return s.map(t=>gr(t));if(typeof s=="function"||s!==Object(s))return s;const e={};return Object.entries(s).forEach(([t,n])=>{const a=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[a]=gr(n)}),e},Va=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},Ha=s=>!s||typeof s!="string"||s.length===0||s.length>100||s.trim()!==s||s.includes("/")||s.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(s),er=s=>{var e;return s.msg||s.message||s.error_description||(typeof s.error=="string"?s.error:(e=s.error)===null||e===void 0?void 0:e.message)||JSON.stringify(s)},Ga=(s,e,t)=>N(void 0,void 0,void 0,function*(){const n=yield Wa();s instanceof n&&!t?.noResolveJson?s.json().then(a=>{const i=s.status||500,o=a?.statusCode||i+"";e(new cn(er(a),i,o))}).catch(a=>{e(new Mt(er(a),a))}):e(new Mt(er(s),s))}),Ka=(s,e,t,n)=>{const a={method:s,headers:e?.headers||{}};return s==="GET"||!n?a:(Va(n)?(a.headers=Object.assign({"Content-Type":"application/json"},e?.headers),a.body=JSON.stringify(n)):a.body=n,e?.duplex&&(a.duplex=e.duplex),Object.assign(Object.assign({},a),t))};function vt(s,e,t,n,a,i){return N(this,void 0,void 0,function*(){return new Promise((o,l)=>{s(t,Ka(e,n,a,i)).then(c=>{if(!c.ok)throw c;return n?.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>Ga(c,l,n))})})}function pt(s,e,t,n){return N(this,void 0,void 0,function*(){return vt(s,"GET",e,t,n)})}function je(s,e,t,n,a){return N(this,void 0,void 0,function*(){return vt(s,"POST",e,n,a,t)})}function xr(s,e,t,n,a){return N(this,void 0,void 0,function*(){return vt(s,"PUT",e,n,a,t)})}function Ja(s,e,t,n){return N(this,void 0,void 0,function*(){return vt(s,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function Cr(s,e,t,n,a){return N(this,void 0,void 0,function*(){return vt(s,"DELETE",e,n,a,t)})}class Ya{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return N(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Y(e))return{data:null,error:e};throw e}})}}var dn;class Qa{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[dn]="BlobDownloadBuilder",this.promise=null}asStream(){return new Ya(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return N(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Y(e))return{data:null,error:e};throw e}})}}dn=Symbol.toStringTag;const Xa={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Yr={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Za{constructor(e,t={},n,a){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=n,this.fetch=Er(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,n,a){return N(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Yr),a);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),c&&!i.has("metadata")&&i.append("metadata",this.encodeMetadata(c))):(i=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),a?.headers&&(l=Object.assign(Object.assign({},l),a.headers));const d=this._removeEmptyFolders(t),u=this._getFinalPath(d),m=yield(e=="PUT"?xr:je)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:l},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:m.Id,fullPath:m.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Y(i))return{data:null,error:i};throw i}})}upload(e,t,n){return N(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}uploadToSignedUrl(e,t,n,a){return N(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let c;const d=Object.assign({upsert:Yr.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",d.cacheControl)):(c=n,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const m=yield xr(this.fetch,l.toString(),c,{headers:u});return{data:{path:i,fullPath:m.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Y(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return N(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const a=Object.assign({},this.headers);t?.upsert&&(a["x-upsert"]="true");const i=yield je(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new yt("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Y(n))return{data:null,error:n};throw n}})}update(e,t,n){return N(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t,n){return N(this,void 0,void 0,function*(){try{return{data:yield je(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Y(a))return{data:null,error:a};throw a}})}copy(e,t,n){return N(this,void 0,void 0,function*(){try{return{data:{path:(yield je(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Y(a))return{data:null,error:a};throw a}})}createSignedUrl(e,t,n){return N(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),i=yield je(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:t},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n?.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Y(a))return{data:null,error:a};throw a}})}createSignedUrls(e,t,n){return N(this,void 0,void 0,function*(){try{const a=yield je(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Y(a))return{data:null,error:a};throw a}})}download(e,t){const a=typeof t?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(t?.transform||{}),o=i?`?${i}`:"",l=this._getFinalPath(e),c=()=>pt(this.fetch,`${this.url}/${a}/${l}${o}`,{headers:this.headers,noResolveJson:!0});return new Qa(c,this.shouldThrowOnError)}info(e){return N(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const n=yield pt(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:gr(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Y(n))return{data:null,error:n};throw n}})}exists(e){return N(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Ja(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Y(n)&&n instanceof Mt){const a=n.originalError;if([400,404].includes(a?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,t){const n=this._getFinalPath(e),a=[],i=t?.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&a.push(i);const l=typeof t?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(t?.transform||{});c!==""&&a.push(c);let d=a.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${d}`)}}}remove(e){return N(this,void 0,void 0,function*(){try{return{data:yield Cr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Y(t))return{data:null,error:t};throw t}})}list(e,t,n){return N(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},Xa),t),{prefix:e||""});return{data:yield je(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Y(a))return{data:null,error:a};throw a}})}listV2(e,t){return N(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield je(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},t),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Y(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const un="2.87.1",hn={"X-Client-Info":`storage-js/${un}`};class ei{constructor(e,t={},n,a){this.shouldThrowOnError=!1;const i=new URL(e);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},hn),t),this.fetch=Er(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return N(this,void 0,void 0,function*(){try{const t=this.listBucketOptionsToQueryString(e);return{data:yield pt(this.fetch,`${this.url}/bucket${t}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Y(t))return{data:null,error:t};throw t}})}getBucket(e){return N(this,void 0,void 0,function*(){try{return{data:yield pt(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Y(t))return{data:null,error:t};throw t}})}createBucket(e){return N(this,arguments,void 0,function*(t,n={public:!1}){try{return{data:yield je(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Y(a))return{data:null,error:a};throw a}})}updateBucket(e,t){return N(this,void 0,void 0,function*(){try{return{data:yield xr(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Y(n))return{data:null,error:n};throw n}})}emptyBucket(e){return N(this,void 0,void 0,function*(){try{return{data:yield je(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Y(t))return{data:null,error:t};throw t}})}deleteBucket(e){return N(this,void 0,void 0,function*(){try{return{data:yield Cr(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Y(t))return{data:null,error:t};throw t}})}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}}var gt=class extends Error{constructor(s,e){super(s),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function ti(s,e,t){const n=new URL(e,s);if(t)for(const[a,i]of Object.entries(t))i!==void 0&&n.searchParams.set(a,i);return n.toString()}async function ri(s){return!s||s.type==="none"?{}:s.type==="bearer"?{Authorization:`Bearer ${s.token}`}:s.type==="header"?{[s.name]:s.value}:s.type==="custom"?await s.getHeaders():{}}function si(s){const e=s.fetchImpl??globalThis.fetch;return{async request({method:t,path:n,query:a,body:i,headers:o}){const l=ti(s.baseUrl,n,a),c=await ri(s.auth),d=await e(l,{method:t,headers:{...i?{"Content-Type":"application/json"}:{},...c,...o},body:i?JSON.stringify(i):void 0}),u=await d.text(),m=(d.headers.get("content-type")||"").includes("application/json"),f=m&&u?JSON.parse(u):u;if(!d.ok){const h=m?f:void 0,p=h?.error;throw new gt(p?.message??`Request failed with status ${d.status}`,{status:d.status,icebergType:p?.type,icebergCode:p?.code,details:h})}return{status:d.status,headers:d.headers,data:f}}}}function Pt(s){return s.join("")}var ni=class{constructor(s,e=""){this.client=s,this.prefix=e}async listNamespaces(s){const e=s?{parent:Pt(s.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(s,e){const t={namespace:s.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(s){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Pt(s.namespace)}`})}async loadNamespaceMetadata(s){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Pt(s.namespace)}`})).data.properties}}async namespaceExists(s){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Pt(s.namespace)}`}),!0}catch(e){if(e instanceof gt&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(s,e){try{return await this.createNamespace(s,e)}catch(t){if(t instanceof gt&&t.status===409)return;throw t}}};function Ke(s){return s.join("")}var ai=class{constructor(s,e="",t){this.client=s,this.prefix=e,this.accessDelegation=t}async listTables(s){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ke(s.namespace)}/tables`})).data.identifiers}async createTable(s,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ke(s.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(s,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ke(s.namespace)}/tables/${s.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(s,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ke(s.namespace)}/tables/${s.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(s){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ke(s.namespace)}/tables/${s.name}`,headers:e})).data.metadata}async tableExists(s){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ke(s.namespace)}/tables/${s.name}`,headers:e}),!0}catch(t){if(t instanceof gt&&t.status===404)return!1;throw t}}async createTableIfNotExists(s,e){try{return await this.createTable(s,e)}catch(t){if(t instanceof gt&&t.status===409)return await this.loadTable({namespace:s.namespace,name:e.name});throw t}}},ii=class{constructor(s){let e="v1";s.catalogName&&(e+=`/${s.catalogName}`);const t=s.baseUrl.endsWith("/")?s.baseUrl:`${s.baseUrl}/`;this.client=si({baseUrl:t,auth:s.auth,fetchImpl:s.fetch}),this.accessDelegation=s.accessDelegation?.join(","),this.namespaceOps=new ni(this.client,e),this.tableOps=new ai(this.client,e,this.accessDelegation)}async listNamespaces(s){return this.namespaceOps.listNamespaces(s)}async createNamespace(s,e){return this.namespaceOps.createNamespace(s,e)}async dropNamespace(s){await this.namespaceOps.dropNamespace(s)}async loadNamespaceMetadata(s){return this.namespaceOps.loadNamespaceMetadata(s)}async listTables(s){return this.tableOps.listTables(s)}async createTable(s,e){return this.tableOps.createTable(s,e)}async updateTable(s,e){return this.tableOps.updateTable(s,e)}async dropTable(s,e){await this.tableOps.dropTable(s,e)}async loadTable(s){return this.tableOps.loadTable(s)}async namespaceExists(s){return this.namespaceOps.namespaceExists(s)}async tableExists(s){return this.tableOps.tableExists(s)}async createNamespaceIfNotExists(s,e){return this.namespaceOps.createNamespaceIfNotExists(s,e)}async createTableIfNotExists(s,e){return this.tableOps.createTableIfNotExists(s,e)}};class fn{constructor(e,t={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},hn),t),this.fetch=Er(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return N(this,void 0,void 0,function*(){try{return{data:yield je(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Y(t))return{data:null,error:t};throw t}})}listBuckets(e){return N(this,void 0,void 0,function*(){try{const t=new URLSearchParams;e?.limit!==void 0&&t.set("limit",e.limit.toString()),e?.offset!==void 0&&t.set("offset",e.offset.toString()),e?.sortColumn&&t.set("sortColumn",e.sortColumn),e?.sortOrder&&t.set("sortOrder",e.sortOrder),e?.search&&t.set("search",e.search);const n=t.toString(),a=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield pt(this.fetch,a,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Y(t))return{data:null,error:t};throw t}})}deleteBucket(e){return N(this,void 0,void 0,function*(){try{return{data:yield Cr(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Y(t))return{data:null,error:t};throw t}})}from(e){if(!Ha(e))throw new yt("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new ii({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:()=>N(this,void 0,void 0,function*(){return this.headers})},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(t,{get(i,o){const l=i[o];return typeof l!="function"?l:(...c)=>N(this,void 0,void 0,function*(){try{return{data:yield l.apply(i,c),error:null}}catch(d){if(n)throw d;return{data:null,error:d}}})}})}}const Tr={"X-Client-Info":`storage-js/${un}`,"Content-Type":"application/json"};class Or extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function ge(s){return typeof s=="object"&&s!==null&&"__isStorageVectorsError"in s}class Rt extends Or{constructor(e,t,n){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class mn extends Or{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}}var br;(function(s){s.InternalError="InternalError",s.S3VectorConflictException="S3VectorConflictException",s.S3VectorNotFoundException="S3VectorNotFoundException",s.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",s.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",s.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(br||(br={}));const Kt=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),oi=()=>Response,pn=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},li=s=>Array.from(new Float32Array(s)),ci=(s,e)=>{if(e!==void 0&&s.float32.length!==e)throw new Error(`Vector dimension mismatch: expected ${e}, got ${s.float32.length}`)},Qr=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),di=(s,e,t)=>N(void 0,void 0,void 0,function*(){if(s&&typeof s=="object"&&"status"in s&&"ok"in s&&typeof s.status=="number"&&!t?.noResolveJson){const a=s.status||500,i=s;if(typeof i.json=="function")i.json().then(o=>{const l=o?.statusCode||o?.code||a+"";e(new Rt(Qr(o),a,l))}).catch(()=>{const o=a+"",l=i.statusText||`HTTP ${a} error`;e(new Rt(l,a,o))});else{const o=a+"",l=i.statusText||`HTTP ${a} error`;e(new Rt(l,a,o))}}else e(new mn(Qr(s),s))}),ui=(s,e,t,n)=>{const a={method:s,headers:e?.headers||{}};return n?(pn(n)?(a.headers=Object.assign({"Content-Type":"application/json"},e?.headers),a.body=JSON.stringify(n)):a.body=n,Object.assign(Object.assign({},a),t)):a};function hi(s,e,t,n,a,i){return N(this,void 0,void 0,function*(){return new Promise((o,l)=>{s(t,ui(e,n,a,i)).then(c=>{if(!c.ok)throw c;if(n?.noResolveJson)return c;const d=c.headers.get("content-type");return!d||!d.includes("application/json")?{}:c.json()}).then(c=>o(c)).catch(c=>di(c,l,n))})})}function be(s,e,t,n,a){return N(this,void 0,void 0,function*(){return hi(s,"POST",e,n,a,t)})}class gn{constructor(e,t={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Tr),t),this.fetch=Kt(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return N(this,void 0,void 0,function*(){try{return{data:(yield be(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ge(t))return{data:null,error:t};throw t}})}getIndex(e,t){return N(this,void 0,void 0,function*(){try{return{data:yield be(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ge(n))return{data:null,error:n};throw n}})}listIndexes(e){return N(this,void 0,void 0,function*(){try{return{data:yield be(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ge(t))return{data:null,error:t};throw t}})}deleteIndex(e,t){return N(this,void 0,void 0,function*(){try{return{data:(yield be(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ge(n))return{data:null,error:n};throw n}})}}class xn{constructor(e,t={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Tr),t),this.fetch=Kt(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return N(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield be(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ge(t))return{data:null,error:t};throw t}})}getVectors(e){return N(this,void 0,void 0,function*(){try{return{data:yield be(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ge(t))return{data:null,error:t};throw t}})}listVectors(e){return N(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield be(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ge(t))return{data:null,error:t};throw t}})}queryVectors(e){return N(this,void 0,void 0,function*(){try{return{data:yield be(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ge(t))return{data:null,error:t};throw t}})}deleteVectors(e){return N(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield be(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ge(t))return{data:null,error:t};throw t}})}}class bn{constructor(e,t={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Tr),t),this.fetch=Kt(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return N(this,void 0,void 0,function*(){try{return{data:(yield be(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ge(t))return{data:null,error:t};throw t}})}getBucket(e){return N(this,void 0,void 0,function*(){try{return{data:yield be(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ge(t))return{data:null,error:t};throw t}})}listBuckets(){return N(this,arguments,void 0,function*(e={}){try{return{data:yield be(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ge(t))return{data:null,error:t};throw t}})}deleteBucket(e){return N(this,void 0,void 0,function*(){try{return{data:(yield be(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ge(t))return{data:null,error:t};throw t}})}}class yn extends bn{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new vn(this.url,this.headers,e,this.fetch)}createBucket(e){const t=Object.create(null,{createBucket:{get:()=>super.createBucket}});return N(this,void 0,void 0,function*(){return t.createBucket.call(this,e)})}getBucket(e){const t=Object.create(null,{getBucket:{get:()=>super.getBucket}});return N(this,void 0,void 0,function*(){return t.getBucket.call(this,e)})}listBuckets(){const e=Object.create(null,{listBuckets:{get:()=>super.listBuckets}});return N(this,arguments,void 0,function*(t={}){return e.listBuckets.call(this,t)})}deleteBucket(e){const t=Object.create(null,{deleteBucket:{get:()=>super.deleteBucket}});return N(this,void 0,void 0,function*(){return t.deleteBucket.call(this,e)})}}class vn extends gn{constructor(e,t,n,a){super(e,t,a),this.vectorBucketName=n}createIndex(e){const t=Object.create(null,{createIndex:{get:()=>super.createIndex}});return N(this,void 0,void 0,function*(){return t.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return N(this,arguments,void 0,function*(t={}){return e.listIndexes.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const t=Object.create(null,{getIndex:{get:()=>super.getIndex}});return N(this,void 0,void 0,function*(){return t.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const t=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return N(this,void 0,void 0,function*(){return t.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new wn(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class wn extends xn{constructor(e,t,n,a,i){super(e,t,i),this.vectorBucketName=n,this.indexName=a}putVectors(e){const t=Object.create(null,{putVectors:{get:()=>super.putVectors}});return N(this,void 0,void 0,function*(){return t.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const t=Object.create(null,{getVectors:{get:()=>super.getVectors}});return N(this,void 0,void 0,function*(){return t.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return N(this,arguments,void 0,function*(t={}){return e.listVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const t=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return N(this,void 0,void 0,function*(){return t.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const t=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return N(this,void 0,void 0,function*(){return t.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class fi extends ei{constructor(e,t={},n,a){super(e,t,n,a)}from(e){return new Za(this.url,this.headers,e,this.fetch)}get vectors(){return new yn(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new fn(this.url+"/iceberg",this.headers,this.fetch)}}const mi=Object.freeze(Object.defineProperty({__proto__:null,StorageAnalyticsClient:fn,StorageApiError:cn,StorageClient:fi,StorageError:yt,StorageUnknownError:Mt,StorageVectorsApiError:Rt,StorageVectorsClient:yn,StorageVectorsError:Or,get StorageVectorsErrorCode(){return br},StorageVectorsUnknownError:mn,VectorBucketApi:bn,VectorBucketScope:vn,VectorDataApi:xn,VectorIndexApi:gn,VectorIndexScope:wn,isPlainObject:pn,isStorageError:Y,isStorageVectorsError:ge,normalizeToFloat32:li,resolveFetch:Kt,resolveResponse:oi,validateVectorDimension:ci},Symbol.toStringTag,{value:"Module"})),pi=xt(mi);var tr={},dt={},Xr;function gi(){return Xr||(Xr=1,Object.defineProperty(dt,"__esModule",{value:!0}),dt.version=void 0,dt.version="2.87.1"),dt}var Zr;function xi(){return Zr||(Zr=1,(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.DEFAULT_REALTIME_OPTIONS=s.DEFAULT_AUTH_OPTIONS=s.DEFAULT_DB_OPTIONS=s.DEFAULT_GLOBAL_OPTIONS=s.DEFAULT_HEADERS=void 0;const e=gi();let t="";typeof Deno<"u"?t="deno":typeof document<"u"?t="web":typeof navigator<"u"&&navigator.product==="ReactNative"?t="react-native":t="node",s.DEFAULT_HEADERS={"X-Client-Info":`supabase-js-${t}/${e.version}`},s.DEFAULT_GLOBAL_OPTIONS={headers:s.DEFAULT_HEADERS},s.DEFAULT_DB_OPTIONS={schema:"public"},s.DEFAULT_AUTH_OPTIONS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},s.DEFAULT_REALTIME_OPTIONS={}})(tr)),tr}var rr={},es;function bi(){return es||(es=1,(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.fetchWithAuth=s.resolveHeadersConstructor=s.resolveFetch=void 0;const e=a=>a?(...i)=>a(...i):(...i)=>fetch(...i);s.resolveFetch=e;const t=()=>Headers;s.resolveHeadersConstructor=t;const n=(a,i,o)=>{const l=(0,s.resolveFetch)(o),c=(0,s.resolveHeadersConstructor)();return async(d,u)=>{var m;const f=(m=await i())!==null&&m!==void 0?m:a;let h=new c(u?.headers);return h.has("apikey")||h.set("apikey",a),h.has("Authorization")||h.set("Authorization",`Bearer ${f}`),l(d,Object.assign(Object.assign({},u),{headers:h}))}};s.fetchWithAuth=n})(rr)),rr}var Ae={},ts;function yi(){if(ts)return Ae;ts=1,Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.isBrowser=void 0,Ae.uuid=s,Ae.ensureTrailingSlash=e,Ae.applySettingDefaults=n,Ae.validateSupabaseUrl=a;function s(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var o=Math.random()*16|0,l=i=="x"?o:o&3|8;return l.toString(16)})}function e(i){return i.endsWith("/")?i:i+"/"}const t=()=>typeof window<"u";Ae.isBrowser=t;function n(i,o){var l,c;const{db:d,auth:u,realtime:m,global:f}=i,{db:h,auth:p,realtime:b,global:x}=o,_={db:Object.assign(Object.assign({},h),d),auth:Object.assign(Object.assign({},p),u),realtime:Object.assign(Object.assign({},b),m),storage:{},global:Object.assign(Object.assign(Object.assign({},x),f),{headers:Object.assign(Object.assign({},(l=x?.headers)!==null&&l!==void 0?l:{}),(c=f?.headers)!==null&&c!==void 0?c:{})}),accessToken:async()=>""};return i.accessToken?_.accessToken=i.accessToken:delete _.accessToken,_}function a(i){const o=i?.trim();if(!o)throw new Error("supabaseUrl is required.");if(!o.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(e(o))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}return Ae}var ut={};const jn="2.87.1",et=30*1e3,yr=3,sr=yr*et,vi="http://localhost:9999",wi="supabase.auth.token",ji={"X-Client-Info":`gotrue-js/${jn}`},vr="X-Supabase-Api-Version",_n={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},_i=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,ki=600*1e3;let at=class extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}};function S(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}let kn=class extends at{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}};function Nn(s){return S(s)&&s.name==="AuthApiError"}let $e=class extends at{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}},Re=class extends at{constructor(e,t,n,a){super(e,n,a),this.name=t,this.status=n}},pe=class extends Re{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}};function Sn(s){return S(s)&&s.name==="AuthSessionMissingError"}let Fe=class extends Re{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}},ft=class extends Re{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}},mt=class extends Re{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}};function En(s){return S(s)&&s.name==="AuthImplicitGrantRedirectError"}let wr=class extends Re{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},Ft=class extends Re{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}};function It(s){return S(s)&&s.name==="AuthRetryableFetchError"}let jr=class extends Re{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}};function Ni(s){return S(s)&&s.name==="AuthWeakPasswordError"}let qt=class extends Re{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}};const zt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),rs=` 	
\r=`.split(""),Si=(()=>{const s=new Array(128);for(let e=0;e<s.length;e+=1)s[e]=-1;for(let e=0;e<rs.length;e+=1)s[rs[e].charCodeAt(0)]=-2;for(let e=0;e<zt.length;e+=1)s[zt[e].charCodeAt(0)]=e;return s})();function ss(s,e,t){if(s!==null)for(e.queue=e.queue<<8|s,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(zt[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(zt[n]),e.queuedBits-=6}}function Cn(s,e,t){const n=Si[s];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function ns(s){const e=[],t=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{Ti(o,n,t)};for(let o=0;o<s.length;o+=1)Cn(s.charCodeAt(o),a,i);return e.join("")}function Ei(s,e){if(s<=127){e(s);return}else if(s<=2047){e(192|s>>6),e(128|s&63);return}else if(s<=65535){e(224|s>>12),e(128|s>>6&63),e(128|s&63);return}else if(s<=1114111){e(240|s>>18),e(128|s>>12&63),e(128|s>>6&63),e(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function Ci(s,e){for(let t=0;t<s.length;t+=1){let n=s.charCodeAt(t);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(s.charCodeAt(t+1)-56320&65535|a)+65536,t+=1}Ei(n,e)}}function Ti(s,e,t){if(e.utf8seq===0){if(s<=127){t(s);return}for(let n=1;n<6;n+=1)if((s>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=s&31;else if(e.utf8seq===3)e.codepoint=s&15;else if(e.utf8seq===4)e.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|s&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function st(s){const e=[],t={queue:0,queuedBits:0},n=a=>{e.push(a)};for(let a=0;a<s.length;a+=1)Cn(s.charCodeAt(a),t,n);return new Uint8Array(e)}function Oi(s){const e=[];return Ci(s,t=>e.push(t)),new Uint8Array(e)}function Ge(s){const e=[],t={queue:0,queuedBits:0},n=a=>{e.push(a)};return s.forEach(a=>ss(a,t,n)),ss(null,t,n),e.join("")}function Pi(s){return Math.round(Date.now()/1e3)+s}function Ai(){return Symbol("auth-callback")}const de=()=>typeof window<"u"&&typeof document<"u",Be={tested:!1,writable:!1},Tn=()=>{if(!de())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Be.tested)return Be.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),Be.tested=!0,Be.writable=!0}catch{Be.tested=!0,Be.writable=!1}return Be.writable};function Ri(s){const e={},t=new URL(s);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((a,i)=>{e[i]=a})}catch{}return t.searchParams.forEach((n,a)=>{e[a]=n}),e}const On=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),Ii=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",tt=async(s,e,t)=>{await s.setItem(e,JSON.stringify(t))},Me=async(s,e)=>{const t=await s.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},ce=async(s,e)=>{await s.removeItem(e)};class Jt{constructor(){this.promise=new Jt.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Jt.promiseConstructor=Promise;function nr(s){const e=s.split(".");if(e.length!==3)throw new qt("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!_i.test(e[n]))throw new qt("JWT not in base64url format");return{header:JSON.parse(ns(e[0])),payload:JSON.parse(ns(e[1])),signature:st(e[2]),raw:{header:e[0],payload:e[1]}}}async function $i(s){return await new Promise(e=>{setTimeout(()=>e(null),s)})}function Li(s,e){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await s(i);if(!e(i,null,o)){n(o);return}}catch(o){if(!e(i,o)){a(o);return}}})()})}function Ui(s){return("0"+s.toString(16)).substr(-2)}function Di(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let a="";for(let i=0;i<56;i++)a+=t.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(e),Array.from(e,Ui).join("")}async function Bi(s){const t=new TextEncoder().encode(s),n=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function Mi(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const t=await Bi(s);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Je(s,e,t=!1){const n=Di();let a=n;t&&(a+="/PASSWORD_RECOVERY"),await tt(s,`${e}-code-verifier`,a);const i=await Mi(n);return[i,n===i?"plain":"s256"]}const Fi=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function qi(s){const e=s.headers.get(vr);if(!e||!e.match(Fi))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function zi(s){if(!s)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(s<=e)throw new Error("JWT has expired")}function Wi(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Vi=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ye(s){if(!Vi.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ar(){const s={};return new Proxy(s,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const n=t.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Hi(s,e){return new Proxy(s,{get:(t,n,a)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,n,a)}return!e.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,n,a)}})}function as(s){return JSON.parse(JSON.stringify(s))}const qe=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),Gi=[502,503,504];async function is(s){var e;if(!Ii(s))throw new Ft(qe(s),0);if(Gi.includes(s.status))throw new Ft(qe(s),s.status);let t;try{t=await s.json()}catch(i){throw new $e(qe(i),i)}let n;const a=qi(s);if(a&&a.getTime()>=_n["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new jr(qe(t),s.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new pe}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new jr(qe(t),s.status,t.weak_password.reasons);throw new kn(qe(t),s.status||500,n)}const Ki=(s,e,t,n)=>{const a={method:s,headers:e?.headers||{}};return s==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),t))};async function A(s,e,t,n){var a;const i=Object.assign({},n?.headers);i[vr]||(i[vr]=_n["2024-01-01"].name),n?.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(a=n?.query)!==null&&a!==void 0?a:{};n?.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await Ji(s,e,t+l,{headers:i,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(c):{data:Object.assign({},c),error:null}}async function Ji(s,e,t,n,a,i){const o=Ki(e,n,a,i);let l;try{l=await s(t,Object.assign({},o))}catch(c){throw console.error(c),new Ft(qe(c),0)}if(l.ok||await is(l),n?.noResolveJson)return l;try{return await l.json()}catch(c){await is(c)}}function we(s){var e;let t=null;Xi(s)&&(t=Object.assign({},s),s.expires_at||(t.expires_at=Pi(s.expires_in)));const n=(e=s.user)!==null&&e!==void 0?e:s;return{data:{session:t,user:n},error:null}}function os(s){const e=we(s);return!e.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=s.weak_password),e}function Le(s){var e;return{data:{user:(e=s.user)!==null&&e!==void 0?e:s},error:null}}function Yi(s){return{data:s,error:null}}function Qi(s){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:a,verification_type:i}=s,o=ot(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:n,redirect_to:a,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function ls(s){return s}function Xi(s){return s.access_token&&s.refresh_token&&s.expires_in}const $t=["global","local","others"];let Pr=class{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=On(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=$t[0]){if($t.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${$t.join(", ")}`);try{return await A(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(S(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await A(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Le})}catch(n){if(S(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=ot(e,["options"]),a=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(a.new_email=n?.newEmail,delete a.newEmail),await A(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:Qi,redirectTo:t?.redirectTo})}catch(t){if(S(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await A(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Le})}catch(t){if(S(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,a,i,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await A(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=e?.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:ls});if(u.error)throw u.error;const m=await u.json(),f=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,h=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(p=>{const b=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(p.split(";")[1].split("=")[1]);d[`${x}Page`]=b}),d.total=parseInt(f)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(S(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Ye(e);try{return await A(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Le})}catch(t){if(S(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Ye(e);try{return await A(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Le})}catch(n){if(S(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){Ye(e);try{return await A(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Le})}catch(n){if(S(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Ye(e.userId);try{const{data:t,error:n}=await A(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:t,error:n}}catch(t){if(S(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Ye(e.userId),Ye(e.id);try{return{data:await A(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(S(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,n,a,i,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await A(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=e?.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:ls});if(u.error)throw u.error;const m=await u.json(),f=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,h=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(p=>{const b=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(p.split(";")[1].split("=")[1]);d[`${x}Page`]=b}),d.total=parseInt(f)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(S(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await A(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(S(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await A(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(S(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await A(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(S(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(e){try{return await A(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(S(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await A(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(S(t))return{data:null,error:t};throw t}}};function cs(s={}){return{getItem:e=>s[e]||null,setItem:(e,t)=>{s[e]=t},removeItem:e=>{delete s[e]}}}const ze={debug:!!(globalThis&&Tn()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ar extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}let Pn=class extends Ar{};class Zi extends Ar{}async function An(s,e,t){ze.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),ze.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){ze.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,a.name);try{return await t()}finally{ze.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,a.name)}}else{if(e===0)throw ze.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new Pn(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(ze.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}const ds={};async function eo(s,e,t){var n;const a=(n=ds[s])!==null&&n!==void 0?n:Promise.resolve(),i=Promise.race([a.catch(()=>null),e>=0?new Promise((o,l)=>{setTimeout(()=>{l(new Zi(`Acquring process lock with name "${s}" timed out`))},e)}):null].filter(o=>o)).catch(o=>{if(o&&o.isAcquireTimeout)throw o;return null}).then(async()=>await t());return ds[s]=i.catch(async o=>{if(o&&o.isAcquireTimeout)return await a,null;throw o}),await i}function to(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Rn(s){if(!/^0x[a-fA-F0-9]{40}$/.test(s))throw new Error(`@supabase/auth-js: Address "${s}" is invalid.`);return s.toLowerCase()}function ro(s){return parseInt(s,16)}function so(s){const e=new TextEncoder().encode(s);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function no(s){var e;const{chainId:t,domain:n,expirationTime:a,issuedAt:i=new Date,nonce:o,notBefore:l,requestId:c,resources:d,scheme:u,uri:m,version:f}=s;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((e=s.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${s.statement}`)}const h=Rn(s.address),p=u?`${u}://${n}`:n,b=s.statement?`${s.statement}
`:"",x=`${p} wants you to sign in with your Ethereum account:
${h}

${b}`;let _=`URI: ${m}
Version: ${f}
Chain ID: ${t}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(a&&(_+=`
Expiration Time: ${a.toISOString()}`),l&&(_+=`
Not Before: ${l.toISOString()}`),c&&(_+=`
Request ID: ${c}`),d){let w=`
Resources:`;for(const v of d){if(!v||typeof v!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${v}`);w+=`
- ${v}`}_+=w}return`${x}
${_}`}class se extends Error{constructor({message:e,code:t,cause:n,name:a}){var i;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(i=a??(n instanceof Error?n.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=t}}class Wt extends se{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function ao({error:s,options:e}){var t,n,a;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(e.signal instanceof AbortSignal)return new se({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else if(s.name==="ConstraintError"){if(((t=i.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new se({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:s});if(e.mediation==="conditional"&&((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new se({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:s});if(((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new se({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:s})}else{if(s.name==="InvalidStateError")return new se({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:s});if(s.name==="NotAllowedError")return new se({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="NotSupportedError")return i.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new se({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:s}):new se({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:s});if(s.name==="SecurityError"){const o=window.location.hostname;if(In(o)){if(i.rp.id!==o)return new se({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new se({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new se({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:s})}else if(s.name==="UnknownError")return new se({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new se({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}function io({error:s,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(e.signal instanceof AbortSignal)return new se({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else{if(s.name==="NotAllowedError")return new se({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="SecurityError"){const n=window.location.hostname;if(In(n)){if(t.rpId!==n)return new se({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new se({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="UnknownError")return new se({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new se({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}class oo{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const lo=new oo;function co(s){if(!s)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(s);const{challenge:e,user:t,excludeCredentials:n}=s,a=ot(s,["challenge","user","excludeCredentials"]),i=st(e).buffer,o=Object.assign(Object.assign({},t),{id:st(t.id).buffer}),l=Object.assign(Object.assign({},a),{challenge:i,user:o});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const d=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:st(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function uo(s){if(!s)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(s);const{challenge:e,allowCredentials:t}=s,n=ot(s,["challenge","allowCredentials"]),a=st(e).buffer,i=Object.assign(Object.assign({},n),{challenge:a});if(t&&t.length>0){i.allowCredentials=new Array(t.length);for(let o=0;o<t.length;o++){const l=t[o];i.allowCredentials[o]=Object.assign(Object.assign({},l),{id:st(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return i}function ho(s){var e;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const t=s;return{id:s.id,rawId:s.id,response:{attestationObject:Ge(new Uint8Array(s.response.attestationObject)),clientDataJSON:Ge(new Uint8Array(s.response.clientDataJSON))},type:"public-key",clientExtensionResults:s.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function fo(s){var e;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const t=s,n=s.getClientExtensionResults(),a=s.response;return{id:s.id,rawId:s.id,response:{authenticatorData:Ge(new Uint8Array(a.authenticatorData)),clientDataJSON:Ge(new Uint8Array(a.clientDataJSON)),signature:Ge(new Uint8Array(a.signature)),userHandle:a.userHandle?Ge(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function In(s){return s==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(s)}function us(){var s,e;return!!(de()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((s=navigator?.credentials)===null||s===void 0?void 0:s.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function mo(s){try{const e=await navigator.credentials.create(s);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Wt("Browser returned unexpected credential type",e)}:{data:null,error:new Wt("Empty credential response",e)}}catch(e){return{data:null,error:ao({error:e,options:s})}}}async function po(s){try{const e=await navigator.credentials.get(s);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Wt("Browser returned unexpected credential type",e)}:{data:null,error:new Wt("Empty credential response",e)}}catch(e){return{data:null,error:io({error:e,options:s})}}}const go={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},xo={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Vt(...s){const e=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),t=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),n={};for(const a of s)if(a)for(const i in a){const o=a[i];if(o!==void 0)if(Array.isArray(o))n[i]=o;else if(t(o))n[i]=o;else if(e(o)){const l=n[i];e(l)?n[i]=Vt(l,o):n[i]=Vt(o)}else n[i]=o}return n}function bo(s,e){return Vt(go,s,e||{})}function yo(s,e){return Vt(xo,s,e||{})}class vo{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:n,signal:a},i){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!o)return{data:null,error:l};const c=a??lo.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:d}=o.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${n}`),d.displayName||(d.displayName=d.name)}switch(o.webauthn.type){case"create":{const d=bo(o.webauthn.credential_options.publicKey,i?.create),{data:u,error:m}=await mo({publicKey:d,signal:c});return u?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:m}}case"request":{const d=yo(o.webauthn.credential_options.publicKey,i?.request),{data:u,error:m}=await po(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:d,signal:c}));return u?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:m}}}}catch(o){return S(o)?{data:null,error:o}:{data:null,error:new $e("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:t,webauthn:n}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!t)return{data:null,error:new at("rpId is required for WebAuthn authentication")};try{if(!us())return{data:null,error:new $e("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:n},signal:a},{request:i});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:c.type,rpId:t,rpOrigins:n,credential_response:c.credential_response}})}catch(o){return S(o)?{data:null,error:o}:{data:null,error:new $e("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!t)return{data:null,error:new at("rpId is required for WebAuthn registration")};try{if(!us())return{data:null,error:new $e("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(u=>{var m;return(m=u.data)===null||m===void 0?void 0:m.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===e&&f.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u?.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:t,rpOrigins:n},signal:a},{create:i});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:t,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(o){return S(o)?{data:null,error:o}:{data:null,error:new $e("Unexpected error in register",o)}}}}to();const wo={url:vi,storageKey:wi,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ji,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function hs(s,e,t){return await t()}const Qe={};let Rr=class _r{get jwks(){var e,t;return(t=(e=Qe[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Qe[this.storageKey]=Object.assign(Object.assign({},Qe[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Qe[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Qe[this.storageKey]=Object.assign(Object.assign({},Qe[this.storageKey]),{cachedAt:e})}constructor(e){var t,n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},wo),e);if(this.storageKey=i.storageKey,this.instanceID=(t=_r.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,_r.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&de()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Pr({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=On(i.fetch),this.lock=i.lock||hs,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:this.persistSession&&de()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=An:this.lock=hs,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new vo(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:Tn()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=cs(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=cs(this.memoryStorage)),de()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${jn}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},n="none";if(de()&&(t=Ri(window.location.href),this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce")),de()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(t,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),En(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return S(t)?this._returnResult({error:t}):this._returnResult({error:new $e("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,a;try{const i=await A(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=e?.options)===null||a===void 0?void 0:a.captchaToken}},xform:we}),{data:o,error:l}=i;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(i){if(S(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var t,n,a;try{let i;if("email"in e){const{email:u,password:m,options:f}=e;let h=null,p=null;this.flowType==="pkce"&&([h,p]=await Je(this.storage,this.storageKey)),i=await A(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f?.emailRedirectTo,body:{email:u,password:m,data:(t=f?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:h,code_challenge_method:p},xform:we})}else if("phone"in e){const{phone:u,password:m,options:f}=e;i=await A(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:m,data:(n=f?.data)!==null&&n!==void 0?n:{},channel:(a=f?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:we})}else throw new ft("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return await ce(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(i){if(await ce(this.storage,`${this.storageKey}-code-verifier`),S(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:o,options:l}=e;t=await A(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:os})}else if("phone"in e){const{phone:i,password:o,options:l}=e;t=await A(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:os})}else throw new ft("You must provide either an email or phone number and a password");const{data:n,error:a}=t;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!n||!n.session||!n.user){const i=new Fe;return this._returnResult({data:{user:null,session:null},error:i})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(t){if(S(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,n,a,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,n,a,i,o,l,c,d,u,m,f;let h,p;if("message"in e)h=e.message,p=e.signature;else{const{chain:b,wallet:x,statement:_,options:w}=e;let v;if(de())if(typeof x=="object")v=x;else{const O=window;if("ethereum"in O&&typeof O.ethereum=="object"&&"request"in O.ethereum&&typeof O.ethereum.request=="function")v=O.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!w?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=x}const k=new URL((t=w?.url)!==null&&t!==void 0?t:window.location.href),T=await v.request({method:"eth_requestAccounts"}).then(O=>O).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!T||T.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const L=Rn(T[0]);let z=(n=w?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!z){const O=await v.request({method:"eth_chainId"});z=ro(O)}const D={domain:k.host,address:L,statement:_,uri:k.href,version:"1",chainId:z,nonce:(a=w?.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(o=(i=w?.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=w?.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=w?.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=w?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=w?.signInWithEthereum)===null||u===void 0?void 0:u.resources};h=no(D),p=await v.request({method:"personal_sign",params:[so(h),L]})}try{const{data:b,error:x}=await A(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:h,signature:p},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:we});if(x)throw x;if(!b||!b.session||!b.user){const _=new Fe;return this._returnResult({data:{user:null,session:null},error:_})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:x})}catch(b){if(S(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async signInWithSolana(e){var t,n,a,i,o,l,c,d,u,m,f,h;let p,b;if("message"in e)p=e.message,b=e.signature;else{const{chain:x,wallet:_,statement:w,options:v}=e;let k;if(de())if(typeof _=="object")k=_;else{const L=window;if("solana"in L&&typeof L.solana=="object"&&("signIn"in L.solana&&typeof L.solana.signIn=="function"||"signMessage"in L.solana&&typeof L.solana.signMessage=="function"))k=L.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!v?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=_}const T=new URL((t=v?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in k&&k.signIn){const L=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v?.signInWithSolana),{version:"1",domain:T.host,uri:T.href}),w?{statement:w}:null));let z;if(Array.isArray(L)&&L[0]&&typeof L[0]=="object")z=L[0];else if(L&&typeof L=="object"&&"signedMessage"in L&&"signature"in L)z=L;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in z&&"signature"in z&&(typeof z.signedMessage=="string"||z.signedMessage instanceof Uint8Array)&&z.signature instanceof Uint8Array)p=typeof z.signedMessage=="string"?z.signedMessage:new TextDecoder().decode(z.signedMessage),b=z.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${T.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${T.href}`,`Issued At: ${(a=(n=v?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=v?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((o=v?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((l=v?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((c=v?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((d=v?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((m=(u=v?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||m===void 0)&&m.length?["Resources",...v.signInWithSolana.resources.map(z=>`- ${z}`)]:[]].join(`
`);const L=await k.signMessage(new TextEncoder().encode(p),"utf8");if(!L||!(L instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=L}}try{const{data:x,error:_}=await A(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:Ge(b)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=e.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:we});if(_)throw _;if(!x||!x.session||!x.user){const w=new Fe;return this._returnResult({data:{user:null,session:null},error:w})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:_})}catch(x){if(S(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async _exchangeCodeForSession(e){const t=await Me(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(t??"").split("/");try{const{data:i,error:o}=await A(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:we});if(await ce(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const l=new Fe;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(await ce(this.storage,`${this.storageKey}-code-verifier`),S(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:t,provider:n,token:a,access_token:i,nonce:o}=e,l=await A(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:we}),{data:c,error:d}=l;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){const u=new Fe;return this._returnResult({data:{user:null,session:null},error:u})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:d})}catch(t){if(S(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,n,a,i,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await Je(this.storage,this.storageKey));const{error:m}=await A(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=c?.data)!==null&&t!==void 0?t:{},create_user:(n=c?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:m})}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:u}=await A(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c?.data)!==null&&a!==void 0?a:{},create_user:(i=c?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(o=c?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:u})}throw new ft("You must provide either an email or phone number.")}catch(l){if(await ce(this.storage,`${this.storageKey}-code-verifier`),S(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var t,n;try{let a,i;"options"in e&&(a=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await A(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:we});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c?.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(a){if(S(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(e){var t,n,a,i,o;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await Je(this.storage,this.storageKey));const d=await A(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=e?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:Yi});return!((i=d.data)===null||i===void 0)&&i.url&&de()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(l){if(await ce(this.storage,`${this.storageKey}-code-verifier`),S(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new pe;const{error:a}=await A(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(e){if(S(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:a,options:i}=e,{error:o}=await A(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:n,type:a,options:i}=e,{data:o,error:l}=await A(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:l})}throw new ft("You must provide either an email or phone number and a type")}catch(t){if(S(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Me(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<sr:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const o=await Me(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=ar()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=Hi(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(-1,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await A(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Le}):await this._useSession(async t=>{var n,a,i;const{data:o,error:l}=t;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new pe}:await A(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:Le})})}catch(t){if(S(t))return Sn(t)&&(await this._removeSession(),await ce(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new pe;const o=a.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Je(this.storage,this.storageKey));const{data:d,error:u}=await A(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Le});if(u)throw u;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(await ce(this.storage,`${this.storageKey}-code-verifier`),S(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new pe;const t=Date.now()/1e3;let n=t,a=!0,i=null;const{payload:o}=nr(e.access_token);if(o.exp&&(n=o.exp,a=n<=t),a){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(t){if(S(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!e?.refresh_token)throw new pe;const{data:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(S(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!de())throw new mt("No browser detected.");if(e.error||e.error_description||e.error_code)throw new mt(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new wr("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new mt("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new wr("No code detected.");const{data:w,error:v}=await this._exchangeCodeForSession(e.code);if(v)throw v;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!i||!l||!o||!d)throw new mt("No session defined in URL");const u=Math.round(Date.now()/1e3),m=parseInt(l);let f=u+m;c&&(f=parseInt(c));const h=f-u;h*1e3<=et&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${m}s`);const p=f-m;u-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,f,u):u-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,f,u);const{data:b,error:x}=await this._getUser(i);if(x)throw x;const _={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:m,expires_at:f,refresh_token:o,token_type:d,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:_,redirectType:e.type},error:null})}catch(n){if(S(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Me(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:a,error:i}=t;if(i)return this._returnResult({error:i});const o=(n=a.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(Nn(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await ce(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=Ai(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,a;try{const{data:{session:i},error:o}=t;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Je(this.storage,this.storageKey,!0));try{return await A(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(await ce(this.storage,`${this.storageKey}-code-verifier`),S(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(S(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:n,error:a}=await this._useSession(async i=>{var o,l,c,d,u;const{data:m,error:f}=i;if(f)throw f;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await A(this.fetch,"GET",h,{headers:this.headers,jwt:(u=(d=m.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return de()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n?.url),this._returnResult({data:{provider:e.provider,url:n?.url},error:null})}catch(n){if(S(n))return this._returnResult({data:{provider:e.provider,url:null},error:n});throw n}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var n;try{const{error:a,data:{session:i}}=t;if(a)throw a;const{options:o,provider:l,token:c,access_token:d,nonce:u}=e,m=await A(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=i?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:d,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:we}),{data:f,error:h}=m;return h?this._returnResult({data:{user:null,session:null},error:h}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new Fe}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:h}))}catch(a){if(await ce(this.storage,`${this.storageKey}-code-verifier`),S(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,a;const{data:i,error:o}=t;if(o)throw o;return await A(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(t){if(S(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await Li(async a=>(a>0&&await $i(200*Math.pow(2,a-1)),this._debug(t,"refreshing attempt",a),await A(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:we})),(a,i)=>{const o=200*Math.pow(2,a);return i&&It(i)&&Date.now()+o-n<et})}catch(n){if(this._debug(t,"error",n),S(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),de()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Me(this.storage,this.storageKey);if(a&&this.userStorage){let o=await Me(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:a.user},await tt(this.userStorage,this.storageKey+"-user",o)),a.user=(e=o?.user)!==null&&e!==void 0?e:ar()}else if(a&&!a.user&&!a.user){const o=await Me(this.storage,this.storageKey+"-user");o&&o?.user?(a.user=o.user,await ce(this.storage,this.storageKey+"-user"),await tt(this.storage,this.storageKey,a)):a.user=ar()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const i=((t=a.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<sr;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${sr}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:o}=await this._callRefreshToken(a.refresh_token);o&&(console.error(o),It(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(a.access_token);!l&&o?.user?(a.user=o.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new pe;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Jt;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new pe;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={data:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(a,"error",i),S(i)){const o={data:null,error:i};return It(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,t,n=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await ce(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),n=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&t.user&&await tt(this.userStorage,this.storageKey+"-user",{user:t.user});const a=Object.assign({},t);delete a.user;const i=as(a);await tt(this.storage,this.storageKey,i)}else{const a=as(t);await tt(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await ce(this.storage,this.storageKey),await ce(this.storage,this.storageKey+"-code-verifier"),await ce(this.storage,this.storageKey+"-user"),this.userStorage&&await ce(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&de()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),et);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-e)/et);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${et}ms, refresh threshold is ${yr} ticks`),a<=yr&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Ar)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!de()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const a=[`provider=${encodeURIComponent(t)}`];if(n?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=await Je(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(l.toString())}if(n?.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n?.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:a,error:i}=t;return i?this._returnResult({data:null,error:i}):await A(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(S(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,a;const{data:i,error:o}=t;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:d}=await A(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&c.type==="totp"&&(!((a=c?.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(t){if(S(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:a,error:i}=t;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?ho(e.webauthn.credential_response):fo(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await A(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(t){if(S(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:a,error:i}=t;if(i)return this._returnResult({data:null,error:i});const o=await A(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:co(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:uo(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(S(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=t?.factors)!==null&&e!==void 0?e:[])a.all.push(i),i.status==="verified"&&a[i.factor_type].push(i);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:n},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=nr(n.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((t=(e=n.user.factors)===null||e===void 0?void 0:e.filter(u=>u.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(l="aal2");const d=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:n},error:a}=t;return a?this._returnResult({data:null,error:a}):n?await A(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:n.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new pe})})}catch(t){if(S(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:a},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new pe});const o=await A(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&de()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(n){if(S(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(e,t){try{return await this._useSession(async n=>{const{data:{session:a},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new pe});const o=await A(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&de()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(n){if(S(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;return n?this._returnResult({data:null,error:n}):t?await A(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new pe})})}catch(e){if(S(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:n},error:a}=t;return a?this._returnResult({data:null,error:a}):n?(await A(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new pe})})}catch(t){if(S(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(l=>l.kid===e);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(l=>l.kid===e),n&&this.jwks_cached_at+ki>a)return n;const{data:i,error:o}=await A(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,n=i.keys.find(l=>l.kid===e),!n)?null:n}async getClaims(e,t={}){try{let n=e;if(!n){const{data:h,error:p}=await this.getSession();if(p||!h.session)return this._returnResult({data:null,error:p});n=h.session.access_token}const{header:a,payload:i,signature:o,raw:{header:l,payload:c}}=nr(n);t?.allowExpired||zi(i.exp);const d=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!d){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:i,header:a,signature:o},error:null}}const u=Wi(a.alg),m=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,m,o,Oi(`${l}.${c}`)))throw new qt("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(n){if(S(n))return this._returnResult({data:null,error:n});throw n}}};Rr.nextInstanceID={};const jo=Pr,_o=Rr,ko=Object.freeze(Object.defineProperty({__proto__:null,AuthAdminApi:jo,AuthApiError:kn,AuthClient:_o,AuthError:at,AuthImplicitGrantRedirectError:mt,AuthInvalidCredentialsError:ft,AuthInvalidJwtError:qt,AuthInvalidTokenResponseError:Fe,AuthPKCEGrantCodeExchangeError:wr,AuthRetryableFetchError:Ft,AuthSessionMissingError:pe,AuthUnknownError:$e,AuthWeakPasswordError:jr,CustomAuthError:Re,GoTrueAdminApi:Pr,GoTrueClient:Rr,NavigatorLockAcquireTimeoutError:Pn,SIGN_OUT_SCOPES:$t,isAuthApiError:Nn,isAuthError:S,isAuthImplicitGrantRedirectError:En,isAuthRetryableFetchError:It,isAuthSessionMissingError:Sn,isAuthWeakPasswordError:Ni,lockInternals:ze,navigatorLock:An,processLock:eo},Symbol.toStringTag,{value:"Module"})),$n=xt(ko);var fs;function No(){if(fs)return ut;fs=1,Object.defineProperty(ut,"__esModule",{value:!0}),ut.SupabaseAuthClient=void 0;const s=$n;let e=class extends s.AuthClient{constructor(n){super(n)}};return ut.SupabaseAuthClient=e,ut}var ms;function ps(){if(ms)return _t;ms=1,Object.defineProperty(_t,"__esModule",{value:!0});const s=Gs,e=Zs(),t=ln,n=pi,a=xi(),i=bi(),o=yi(),l=No();class c{constructor(u,m,f){var h,p,b;this.supabaseUrl=u,this.supabaseKey=m;const x=(0,o.validateSupabaseUrl)(u);if(!m)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",x),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",x),this.storageUrl=new URL("storage/v1",x),this.functionsUrl=new URL("functions/v1",x);const _=`sb-${x.hostname.split(".")[0]}-auth-token`,w={db:a.DEFAULT_DB_OPTIONS,realtime:a.DEFAULT_REALTIME_OPTIONS,auth:Object.assign(Object.assign({},a.DEFAULT_AUTH_OPTIONS),{storageKey:_}),global:a.DEFAULT_GLOBAL_OPTIONS},v=(0,o.applySettingDefaults)(f??{},w);this.storageKey=(h=v.auth.storageKey)!==null&&h!==void 0?h:"",this.headers=(p=v.global.headers)!==null&&p!==void 0?p:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(k,T)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(T)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((b=v.auth)!==null&&b!==void 0?b:{},this.headers,v.global.fetch),this.fetch=(0,i.fetchWithAuth)(m,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.accessToken&&this.accessToken().then(k=>this.realtime.setAuth(k)).catch(k=>console.warn("Failed to set initial Realtime auth token:",k)),this.rest=new e.PostgrestClient(new URL("rest/v1",x).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),this.storage=new n.StorageClient(this.storageUrl.href,this.headers,this.fetch,f?.storage),v.accessToken||this._listenForAuthEvents()}get functions(){return new s.FunctionsClient(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(u){return this.rest.from(u)}schema(u){return this.rest.schema(u)}rpc(u,m={},f={head:!1,get:!1,count:void 0}){return this.rest.rpc(u,m,f)}channel(u,m={config:{}}){return this.realtime.channel(u,m)}getChannels(){return this.realtime.getChannels()}removeChannel(u){return this.realtime.removeChannel(u)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var u,m;if(this.accessToken)return await this.accessToken();const{data:f}=await this.auth.getSession();return(m=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&m!==void 0?m:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:u,persistSession:m,detectSessionInUrl:f,storage:h,userStorage:p,storageKey:b,flowType:x,lock:_,debug:w,throwOnError:v},k,T){const L={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new l.SupabaseAuthClient({url:this.authUrl.href,headers:Object.assign(Object.assign({},L),k),storageKey:b,autoRefreshToken:u,persistSession:m,detectSessionInUrl:f,storage:h,userStorage:p,flowType:x,lock:_,debug:w,throwOnError:v,fetch:T,hasCustomAuthorizationHeader:Object.keys(this.headers).some(z=>z.toLowerCase()==="authorization")})}_initRealtimeClient(u){return new t.RealtimeClient(this.realtimeUrl.href,Object.assign(Object.assign({},u),{params:Object.assign({apikey:this.supabaseKey},u?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((m,f)=>{this._handleTokenChanged(m,"CLIENT",f?.access_token)})}_handleTokenChanged(u,m,f){(u==="TOKEN_REFRESHED"||u==="SIGNED_IN")&&this.changedAccessToken!==f?(this.changedAccessToken=f,this.realtime.setAuth(f)):u==="SIGNED_OUT"&&(this.realtime.setAuth(),m=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}return _t.default=c,_t}var gs;function So(){return gs||(gs=1,(function(s){var e=Pe&&Pe.__createBinding||(Object.create?(function(u,m,f,h){h===void 0&&(h=f);var p=Object.getOwnPropertyDescriptor(m,f);(!p||("get"in p?!m.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return m[f]}}),Object.defineProperty(u,h,p)}):(function(u,m,f,h){h===void 0&&(h=f),u[h]=m[f]})),t=Pe&&Pe.__exportStar||function(u,m){for(var f in u)f!=="default"&&!Object.prototype.hasOwnProperty.call(m,f)&&e(m,u,f)},n=Pe&&Pe.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(s,"__esModule",{value:!0}),s.createClient=s.SupabaseClient=s.FunctionRegion=s.FunctionsError=s.FunctionsRelayError=s.FunctionsFetchError=s.FunctionsHttpError=s.PostgrestError=void 0;const a=n(ps());t($n,s);var i=Zs();Object.defineProperty(s,"PostgrestError",{enumerable:!0,get:function(){return i.PostgrestError}});var o=Gs;Object.defineProperty(s,"FunctionsHttpError",{enumerable:!0,get:function(){return o.FunctionsHttpError}}),Object.defineProperty(s,"FunctionsFetchError",{enumerable:!0,get:function(){return o.FunctionsFetchError}}),Object.defineProperty(s,"FunctionsRelayError",{enumerable:!0,get:function(){return o.FunctionsRelayError}}),Object.defineProperty(s,"FunctionsError",{enumerable:!0,get:function(){return o.FunctionsError}}),Object.defineProperty(s,"FunctionRegion",{enumerable:!0,get:function(){return o.FunctionRegion}}),t(ln,s);var l=ps();Object.defineProperty(s,"SupabaseClient",{enumerable:!0,get:function(){return n(l).default}});const c=(u,m,f)=>new a.default(u,m,f);s.createClient=c;function d(){if(typeof window<"u"||typeof process>"u")return!1;const u=process.version;if(u==null)return!1;const m=u.match(/^v(\d+)\./);return m?parseInt(m[1],10)<=18:!1}d()&&console.warn("â ï¸  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217")})(Pe)),Pe}var Ln=So();const Un=Zn(Ln),Eo=ra({__proto__:null,default:Un},[Ln]),{PostgrestError:Gl,FunctionsHttpError:Kl,FunctionsFetchError:Jl,FunctionsRelayError:Yl,FunctionsError:Ql,FunctionRegion:Xl,SupabaseClient:Zl,createClient:Co,GoTrueAdminApi:ec,GoTrueClient:tc,AuthAdminApi:rc,AuthClient:sc,navigatorLock:nc,NavigatorLockAcquireTimeoutError:ac,lockInternals:ic,processLock:oc,SIGN_OUT_SCOPES:lc,AuthError:cc,AuthApiError:dc,AuthUnknownError:uc,CustomAuthError:hc,AuthSessionMissingError:fc,AuthInvalidTokenResponseError:mc,AuthInvalidCredentialsError:pc,AuthImplicitGrantRedirectError:gc,AuthPKCEGrantCodeExchangeError:xc,AuthRetryableFetchError:bc,AuthWeakPasswordError:yc,AuthInvalidJwtError:vc,isAuthError:wc,isAuthApiError:jc,isAuthSessionMissingError:_c,isAuthImplicitGrantRedirectError:kc,isAuthRetryableFetchError:Nc,isAuthWeakPasswordError:Sc,RealtimePresence:Ec,RealtimeChannel:Cc,RealtimeClient:Tc,REALTIME_LISTEN_TYPES:Oc,REALTIME_POSTGRES_CHANGES_LISTEN_EVENT:Pc,REALTIME_PRESENCE_LISTEN_EVENTS:Ac,REALTIME_SUBSCRIBE_STATES:Rc,REALTIME_CHANNEL_STATES:Ic}=Un||Eo,To="https://uigjzcwdyfulrmmeyeys.supabase.co",Oo="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVpZ2p6Y3dkeWZ1bHJtbWV5ZXlzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI1MzUyNDYsImV4cCI6MjA3ODExMTI0Nn0.nwpTzz450fNh6vQRCpRX0dV0XqBxcOjny6eUkYQiYEA",q=Co(To,Oo,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),Po=Object.freeze(Object.defineProperty({__proto__:null,supabase:q},Symbol.toStringTag,{value:"Module"})),Xe="/assets/honey_jar-ZSNxEqtH.jpg",We="/assets/beehive_new-cPfHjPMl.png",Ao=[{id:"default-1",name:"Wildflower Honey",description:"Pure, raw wildflower honey with a rich, complex flavor.",price:450,category:"honey",stock:5,image_url:Xe,seller_id:"",is_active:!0,created_at:"",updated_at:""},{id:"default-2",name:"Acacia Honey",description:"Light and mild acacia honey, perfect for tea and desserts.",price:550,category:"honey",stock:5,image_url:Xe,seller_id:"",is_active:!0,created_at:"",updated_at:""},{id:"default-3",name:"Manuka Honey",description:"Premium New Zealand Manuka honey with UMF 10+ rating.",price:1200,category:"honey",stock:5,image_url:Xe,seller_id:"",is_active:!0,created_at:"",updated_at:""},{id:"default-4",name:"Raw Forest Honey",description:"Unprocessed forest honey collected from pristine environments.",price:380,category:"honey",stock:5,image_url:Xe,seller_id:"",is_active:!0,created_at:"",updated_at:""},{id:"default-5",name:"Organic Clover Honey",description:"Certified organic clover honey with a sweet, mild taste.",price:420,category:"honey",stock:5,image_url:Xe,seller_id:"",is_active:!0,created_at:"",updated_at:""},{id:"default-6",name:"Eucalyptus Honey",description:"Aromatic eucalyptus honey with natural healing properties.",price:480,category:"honey",stock:5,image_url:Xe,seller_id:"",is_active:!0,created_at:"",updated_at:""},{id:"beehive-starter-kit",name:"Beehive Wooden Box",description:"Complete Beehive Kit for Beekeeper with 1 small box",price:5e3,category:"beehive",stock:5,image_url:We,seller_id:"pollibee-official",is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}],Ro=()=>{const s=Ue(),{addToCart:e,cartItems:t,updateQuantity:n,removeFromCart:a}=it(),[i,o]=j.useState([]),[l,c]=j.useState(!0),[d,u]=j.useState(null);j.useEffect(()=>{(async()=>{try{c(!0);const{data:h,error:p}=await q.from("products").select("*");if(p)throw p;o(h&&h.length>0?h:Ao)}catch(h){u(h instanceof Error?h.message:"Failed to fetch products."),console.error("Error fetching products:",h)}finally{c(!1)}})()},[]);const m=f=>{e(f)};return r.jsx("div",{className:"bg-honeybee-background text-honeybee-secondary",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 lg:py-24",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-serif font-bold text-honeybee-primary",children:"Our Honey Selection"}),r.jsx("p",{className:"mt-3 lg:mt-4 text-sm lg:text-lg max-w-2xl mx-auto",children:"Explore our collection of premium, all-natural honey."})]}),l&&r.jsx("div",{className:"text-center mt-16",children:"Loading products..."}),d&&r.jsx("div",{className:"text-center mt-16 text-red-500",children:d}),!l&&!d&&r.jsx("div",{className:"mt-8 lg:mt-16 grid grid-cols-2 lg:grid-cols-3 gap-3 lg:gap-8",children:i.map(f=>r.jsxs("div",{className:"bg-white rounded-lg overflow-hidden shadow-md hover:shadow-lg transition duration-300",children:[r.jsx("div",{className:"h-32 sm:h-48 lg:h-56 overflow-hidden",children:r.jsx("img",{src:f.image_url,alt:f.name,className:"w-full h-full object-cover transform hover:scale-105 transition duration-500"})}),r.jsxs("div",{className:"p-3 lg:p-6",children:[r.jsx("h3",{className:"text-sm lg:text-lg font-medium text-honeybee-secondary line-clamp-1",children:f.name}),r.jsx("p",{className:"text-honeybee-dark-brown mt-1 lg:mt-2 text-xs lg:text-sm line-clamp-2 hidden sm:block",children:f.description}),r.jsxs("div",{className:"mt-2 lg:mt-4 flex items-center justify-between",children:[r.jsxs("span",{className:"text-black font-bold text-sm lg:text-base",children:["â¹",f.price.toFixed(0)]}),(()=>{const h=t.find(p=>p.id===f.id);return h?r.jsxs("div",{className:"flex items-center space-x-2 bg-gray-100 rounded-full px-2 py-1",children:[r.jsx("button",{onClick:()=>{h.quantity>1?n(h.id,h.quantity-1):a(h.id)},className:"text-honeybee-primary hover:text-honeybee-accent font-bold px-2",children:"-"}),r.jsx("span",{className:"text-sm font-semibold",children:h.quantity}),r.jsx("button",{onClick:()=>{h.quantity<5&&n(h.id,h.quantity+1)},className:`text-honeybee-primary hover:text-honeybee-accent font-bold px-2 ${h.quantity>=5?"opacity-50 cursor-not-allowed":""}`,disabled:h.quantity>=5,children:"+"})]}):f.category==="beehive"?r.jsx("button",{onClick:()=>s("/product/beehive"),className:"bg-honeybee-primary hover:bg-honeybee-accent text-white rounded-full px-4 py-2 text-sm transition duration-300 font-semibold",children:"View Details"}):r.jsx("button",{onClick:()=>m(f),className:"bg-honeybee-primary hover:bg-honeybee-accent text-white rounded-full p-2 transition duration-300",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})})()]})]})]},f.id))})]})})};var wt={};(function s(e,t,n,a){var i=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL),o=typeof Path2D=="function"&&typeof DOMMatrix=="function",l=(function(){if(!e.OffscreenCanvas)return!1;try{var y=new OffscreenCanvas(1,1),g=y.getContext("2d");g.fillRect(0,0,1,1);var C=y.transferToImageBitmap();g.createPattern(C,"no-repeat")}catch{return!1}return!0})();function c(){}function d(y){var g=t.exports.Promise,C=g!==void 0?g:e.Promise;return typeof C=="function"?new C(y):(y(c,c),null)}var u=(function(y,g){return{transform:function(C){if(y)return C;if(g.has(C))return g.get(C);var I=new OffscreenCanvas(C.width,C.height),U=I.getContext("2d");return U.drawImage(C,0,0),g.set(C,I),I},clear:function(){g.clear()}}})(l,new Map),m=(function(){var y=Math.floor(16.666666666666668),g,C,I={},U=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(g=function(B){var P=Math.random();return I[P]=requestAnimationFrame(function $(W){U===W||U+y-1<W?(U=W,delete I[P],B()):I[P]=requestAnimationFrame($)}),P},C=function(B){I[B]&&cancelAnimationFrame(I[B])}):(g=function(B){return setTimeout(B,y)},C=function(B){return clearTimeout(B)}),{frame:g,cancel:C}})(),f=(function(){var y,g,C={};function I(U){function B(P,$){U.postMessage({options:P||{},callback:$})}U.init=function($){var W=$.transferControlToOffscreen();U.postMessage({canvas:W},[W])},U.fire=function($,W,G){if(g)return B($,null),g;var Q=Math.random().toString(36).slice(2);return g=d(function(J){function X(le){le.data.callback===Q&&(delete C[Q],U.removeEventListener("message",X),g=null,u.clear(),G(),J())}U.addEventListener("message",X),B($,Q),C[Q]=X.bind(null,{data:{callback:Q}})}),g},U.reset=function(){U.postMessage({reset:!0});for(var $ in C)C[$](),delete C[$]}}return function(){if(y)return y;if(!n&&i){var U=["var CONFETTI, SIZE = {}, module = {};","("+s.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{y=new Worker(URL.createObjectURL(new Blob([U])))}catch(B){return typeof console<"u"&&typeof console.warn=="function"&&console.warn("ð Could not load worker",B),null}I(y)}return y}})(),h={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function p(y,g){return g?g(y):y}function b(y){return y!=null}function x(y,g,C){return p(y&&b(y[g])?y[g]:h[g],C)}function _(y){return y<0?0:Math.floor(y)}function w(y,g){return Math.floor(Math.random()*(g-y))+y}function v(y){return parseInt(y,16)}function k(y){return y.map(T)}function T(y){var g=String(y).replace(/[^0-9a-f]/gi,"");return g.length<6&&(g=g[0]+g[0]+g[1]+g[1]+g[2]+g[2]),{r:v(g.substring(0,2)),g:v(g.substring(2,4)),b:v(g.substring(4,6))}}function L(y){var g=x(y,"origin",Object);return g.x=x(g,"x",Number),g.y=x(g,"y",Number),g}function z(y){y.width=document.documentElement.clientWidth,y.height=document.documentElement.clientHeight}function D(y){var g=y.getBoundingClientRect();y.width=g.width,y.height=g.height}function O(y){var g=document.createElement("canvas");return g.style.position="fixed",g.style.top="0px",g.style.left="0px",g.style.pointerEvents="none",g.style.zIndex=y,g}function R(y,g,C,I,U,B,P,$,W){y.save(),y.translate(g,C),y.rotate(B),y.scale(I,U),y.arc(0,0,1,P,$,W),y.restore()}function M(y){var g=y.angle*(Math.PI/180),C=y.spread*(Math.PI/180);return{x:y.x,y:y.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:y.startVelocity*.5+Math.random()*y.startVelocity,angle2D:-g+(.5*C-Math.random()*C),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:y.color,shape:y.shape,tick:0,totalTicks:y.ticks,decay:y.decay,drift:y.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:y.gravity*3,ovalScalar:.6,scalar:y.scalar,flat:y.flat}}function ee(y,g){g.x+=Math.cos(g.angle2D)*g.velocity+g.drift,g.y+=Math.sin(g.angle2D)*g.velocity+g.gravity,g.velocity*=g.decay,g.flat?(g.wobble=0,g.wobbleX=g.x+10*g.scalar,g.wobbleY=g.y+10*g.scalar,g.tiltSin=0,g.tiltCos=0,g.random=1):(g.wobble+=g.wobbleSpeed,g.wobbleX=g.x+10*g.scalar*Math.cos(g.wobble),g.wobbleY=g.y+10*g.scalar*Math.sin(g.wobble),g.tiltAngle+=.1,g.tiltSin=Math.sin(g.tiltAngle),g.tiltCos=Math.cos(g.tiltAngle),g.random=Math.random()+2);var C=g.tick++/g.totalTicks,I=g.x+g.random*g.tiltCos,U=g.y+g.random*g.tiltSin,B=g.wobbleX+g.random*g.tiltCos,P=g.wobbleY+g.random*g.tiltSin;if(y.fillStyle="rgba("+g.color.r+", "+g.color.g+", "+g.color.b+", "+(1-C)+")",y.beginPath(),o&&g.shape.type==="path"&&typeof g.shape.path=="string"&&Array.isArray(g.shape.matrix))y.fill(E(g.shape.path,g.shape.matrix,g.x,g.y,Math.abs(B-I)*.1,Math.abs(P-U)*.1,Math.PI/10*g.wobble));else if(g.shape.type==="bitmap"){var $=Math.PI/10*g.wobble,W=Math.abs(B-I)*.1,G=Math.abs(P-U)*.1,Q=g.shape.bitmap.width*g.scalar,J=g.shape.bitmap.height*g.scalar,X=new DOMMatrix([Math.cos($)*W,Math.sin($)*W,-Math.sin($)*G,Math.cos($)*G,g.x,g.y]);X.multiplySelf(new DOMMatrix(g.shape.matrix));var le=y.createPattern(u.transform(g.shape.bitmap),"no-repeat");le.setTransform(X),y.globalAlpha=1-C,y.fillStyle=le,y.fillRect(g.x-Q/2,g.y-J/2,Q,J),y.globalAlpha=1}else if(g.shape==="circle")y.ellipse?y.ellipse(g.x,g.y,Math.abs(B-I)*g.ovalScalar,Math.abs(P-U)*g.ovalScalar,Math.PI/10*g.wobble,0,2*Math.PI):R(y,g.x,g.y,Math.abs(B-I)*g.ovalScalar,Math.abs(P-U)*g.ovalScalar,Math.PI/10*g.wobble,0,2*Math.PI);else if(g.shape==="star")for(var V=Math.PI/2*3,me=4*g.scalar,ye=8*g.scalar,ve=g.x,Oe=g.y,De=5,Se=Math.PI/De;De--;)ve=g.x+Math.cos(V)*ye,Oe=g.y+Math.sin(V)*ye,y.lineTo(ve,Oe),V+=Se,ve=g.x+Math.cos(V)*me,Oe=g.y+Math.sin(V)*me,y.lineTo(ve,Oe),V+=Se;else y.moveTo(Math.floor(g.x),Math.floor(g.y)),y.lineTo(Math.floor(g.wobbleX),Math.floor(U)),y.lineTo(Math.floor(B),Math.floor(P)),y.lineTo(Math.floor(I),Math.floor(g.wobbleY));return y.closePath(),y.fill(),g.tick<g.totalTicks}function ne(y,g,C,I,U){var B=g.slice(),P=y.getContext("2d"),$,W,G=d(function(Q){function J(){$=W=null,P.clearRect(0,0,I.width,I.height),u.clear(),U(),Q()}function X(){n&&!(I.width===a.width&&I.height===a.height)&&(I.width=y.width=a.width,I.height=y.height=a.height),!I.width&&!I.height&&(C(y),I.width=y.width,I.height=y.height),P.clearRect(0,0,I.width,I.height),B=B.filter(function(le){return ee(P,le)}),B.length?$=m.frame(X):J()}$=m.frame(X),W=J});return{addFettis:function(Q){return B=B.concat(Q),G},canvas:y,promise:G,reset:function(){$&&m.cancel($),W&&W()}}}function F(y,g){var C=!y,I=!!x(g||{},"resize"),U=!1,B=x(g,"disableForReducedMotion",Boolean),P=i&&!!x(g||{},"useWorker"),$=P?f():null,W=C?z:D,G=y&&$?!!y.__confetti_initialized:!1,Q=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,J;function X(V,me,ye){for(var ve=x(V,"particleCount",_),Oe=x(V,"angle",Number),De=x(V,"spread",Number),Se=x(V,"startVelocity",Number),qn=x(V,"decay",Number),zn=x(V,"gravity",Number),Wn=x(V,"drift",Number),Ir=x(V,"colors",k),Vn=x(V,"ticks",Number),$r=x(V,"shapes"),Hn=x(V,"scalar"),Gn=!!x(V,"flat"),Lr=L(V),Ur=ve,Yt=[],Kn=y.width*Lr.x,Jn=y.height*Lr.y;Ur--;)Yt.push(M({x:Kn,y:Jn,angle:Oe,spread:De,startVelocity:Se,color:Ir[Ur%Ir.length],shape:$r[w(0,$r.length)],ticks:Vn,decay:qn,gravity:zn,drift:Wn,scalar:Hn,flat:Gn}));return J?J.addFettis(Yt):(J=ne(y,Yt,W,me,ye),J.promise)}function le(V){var me=B||x(V,"disableForReducedMotion",Boolean),ye=x(V,"zIndex",Number);if(me&&Q)return d(function(Se){Se()});C&&J?y=J.canvas:C&&!y&&(y=O(ye),document.body.appendChild(y)),I&&!G&&W(y);var ve={width:y.width,height:y.height};$&&!G&&$.init(y),G=!0,$&&(y.__confetti_initialized=!0);function Oe(){if($){var Se={getBoundingClientRect:function(){if(!C)return y.getBoundingClientRect()}};W(Se),$.postMessage({resize:{width:Se.width,height:Se.height}});return}ve.width=ve.height=null}function De(){J=null,I&&(U=!1,e.removeEventListener("resize",Oe)),C&&y&&(document.body.contains(y)&&document.body.removeChild(y),y=null,G=!1)}return I&&!U&&(U=!0,e.addEventListener("resize",Oe,!1)),$?$.fire(V,ve,De):X(V,ve,De)}return le.reset=function(){$&&$.reset(),J&&J.reset()},le}var te;function oe(){return te||(te=F(null,{useWorker:!0,resize:!0})),te}function E(y,g,C,I,U,B,P){var $=new Path2D(y),W=new Path2D;W.addPath($,new DOMMatrix(g));var G=new Path2D;return G.addPath(W,new DOMMatrix([Math.cos(P)*U,Math.sin(P)*U,-Math.sin(P)*B,Math.cos(P)*B,C,I])),G}function H(y){if(!o)throw new Error("path confetti are not supported in this browser");var g,C;typeof y=="string"?g=y:(g=y.path,C=y.matrix);var I=new Path2D(g),U=document.createElement("canvas"),B=U.getContext("2d");if(!C){for(var P=1e3,$=P,W=P,G=0,Q=0,J,X,le=0;le<P;le+=2)for(var V=0;V<P;V+=2)B.isPointInPath(I,le,V,"nonzero")&&($=Math.min($,le),W=Math.min(W,V),G=Math.max(G,le),Q=Math.max(Q,V));J=G-$,X=Q-W;var me=10,ye=Math.min(me/J,me/X);C=[ye,0,0,ye,-Math.round(J/2+$)*ye,-Math.round(X/2+W)*ye]}return{type:"path",path:g,matrix:C}}function xe(y){var g,C=1,I="#000000",U='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof y=="string"?g=y:(g=y.text,C="scalar"in y?y.scalar:C,U="fontFamily"in y?y.fontFamily:U,I="color"in y?y.color:I);var B=10*C,P=""+B+"px "+U,$=new OffscreenCanvas(B,B),W=$.getContext("2d");W.font=P;var G=W.measureText(g),Q=Math.ceil(G.actualBoundingBoxRight+G.actualBoundingBoxLeft),J=Math.ceil(G.actualBoundingBoxAscent+G.actualBoundingBoxDescent),X=2,le=G.actualBoundingBoxLeft+X,V=G.actualBoundingBoxAscent+X;Q+=X+X,J+=X+X,$=new OffscreenCanvas(Q,J),W=$.getContext("2d"),W.font=P,W.fillStyle=I,W.fillText(g,le,V);var me=1/C;return{type:"bitmap",bitmap:$.transferToImageBitmap(),matrix:[me,0,0,me,-Q*me/2,-J*me/2]}}t.exports=function(){return oe().apply(this,arguments)},t.exports.reset=function(){oe().reset()},t.exports.create=F,t.exports.shapeFromPath=H,t.exports.shapeFromText=xe})((function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}})(),wt,!1);const Lt=wt.exports;wt.exports.create;const Io=()=>{const{cartItems:s,getTotal:e,removeFromCart:t}=it(),[n,a]=j.useState(1),[i,o]=j.useState(""),[l,c]=j.useState(0),[d,u]=j.useState(""),[m,f]=j.useState({email:"",signUp:!1}),[h,p]=j.useState({firstName:"",lastName:"",company:"",address:"",apartment:"",city:"",country:"",state:"",zip:"",phone:""}),b=s.every(F=>F.name.includes("Subscription Plan")),x=e(),_=x-x*l,w={HONEY10:.1,BEE20:.2,OFFER:.1},v=()=>{const F=i.toUpperCase();w[F]?(c(w[F]),u(""),Lt({particleCount:400,spread:160,origin:{y:.6},startVelocity:60,zIndex:9999})):(c(0),u("Invalid coupon code"))},k=()=>{},T=()=>{b?n<3&&a(n+1):n<4&&a(n+1)},L=()=>{n>1&&a(n-1)},z=F=>{const{name:te,value:oe,type:E,checked:H}=F.target;f(xe=>({...xe,[te]:E==="checkbox"?H:oe}))},D=F=>{const{name:te,value:oe}=F.target;p(E=>({...E,[te]:oe}))},O=()=>null,R=()=>r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold mb-2",children:"Contact information"}),r.jsx("input",{type:"email",name:"email",value:m.email,onChange:z,placeholder:"Email",className:"w-full border border-gray-300 rounded px-3 py-2 mb-2 focus:outline-none focus:ring-2 focus:ring-purple-700"}),r.jsxs("label",{className:"inline-flex items-center text-sm mb-4",children:[r.jsx("input",{type:"checkbox",name:"signUp",checked:m.signUp,onChange:z,className:"form-checkbox text-purple-700"}),r.jsx("span",{className:"ml-2",children:"Sign up for exclusive offers and news via text messages & email."})]}),r.jsx("div",{className:"flex justify-between",children:r.jsx("button",{onClick:T,className:"bg-black text-white py-2 px-4 rounded hover:bg-gray-800 transition",children:b?"Continue to payment":"Continue to shipping"})})]}),M=()=>r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold mb-2",children:"Shipping address"}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-2",children:[r.jsx("input",{type:"text",name:"firstName",value:h.firstName,onChange:D,placeholder:"First name",className:"border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-700"}),r.jsx("input",{type:"text",name:"lastName",value:h.lastName,onChange:D,placeholder:"Last name",className:"border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-700"})]}),r.jsx("input",{type:"text",name:"company",value:h.company,onChange:D,placeholder:"Company (optional)",className:"w-full border border-gray-300 rounded px-3 py-2 mb-2 focus:outline-none focus:ring-2 focus:ring-purple-700"}),r.jsx("input",{type:"text",name:"address",value:h.address,onChange:D,placeholder:"Address",className:"w-full border border-gray-300 rounded px-3 py-2 mb-2 focus:outline-none focus:ring-2 focus:ring-purple-700"}),r.jsx("input",{type:"text",name:"apartment",value:h.apartment,onChange:D,placeholder:"Apartment, suite, etc. (optional)",className:"w-full border border-gray-300 rounded px-3 py-2 mb-2 focus:outline-none focus:ring-2 focus:ring-purple-700"}),r.jsx("input",{type:"text",name:"city",value:h.city,onChange:D,placeholder:"City",className:"w-full border border-gray-300 rounded px-3 py-2 mb-2 focus:outline-none focus:ring-2 focus:ring-purple-700"}),r.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-2",children:[r.jsxs("select",{name:"country",value:h.country,onChange:D,className:"border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-700",children:[r.jsx("option",{value:"",children:"Country/region"}),r.jsx("option",{value:"United States",children:"United States"}),r.jsx("option",{value:"Canada",children:"Canada"})]}),r.jsxs("select",{name:"state",value:h.state,onChange:D,className:"border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-700",children:[r.jsx("option",{value:"",children:"State"}),r.jsx("option",{value:"State",children:"State"})]}),r.jsx("input",{type:"text",name:"zip",value:h.zip,onChange:D,placeholder:"ZIP code",className:"border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-700"})]}),r.jsx("input",{type:"text",name:"phone",value:h.phone,onChange:D,placeholder:"Phone number for shipping updates and offers (optional)",className:"w-full border border-gray-300 rounded px-3 py-2 mb-4 focus:outline-none focus:ring-2 focus:ring-purple-700"}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("button",{onClick:L,className:"underline text-purple-700",children:"Return to cart"}),r.jsx("button",{onClick:T,className:"bg-black text-white py-2 px-4 rounded hover:bg-gray-800 transition",children:"Choose shipping method"})]})]}),ee=()=>r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold mb-2",children:"Payment"}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{htmlFor:"coupon",className:"block font-semibold mb-1",children:"Gift card or discount code"}),r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("input",{id:"coupon",type:"text",value:i,onChange:F=>o(F.target.value),placeholder:"Enter coupon code",className:"flex-grow border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-700"}),r.jsx("button",{onClick:v,className:"bg-gray-300 px-4 rounded hover:bg-gray-400 transition",children:"Apply"})]}),d&&r.jsx("p",{className:"text-red-600 mt-1",children:d}),l>0&&r.jsxs("div",{className:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg animate-fade-in",children:[r.jsxs("div",{className:"flex items-center text-green-800 font-bold mb-2",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),'Coupon "',i.toUpperCase(),'" Applied Successfully!']}),r.jsxs("div",{className:"text-green-700 text-sm space-y-1",children:[r.jsxs("p",{className:"flex justify-between",children:[r.jsx("span",{children:"Savings:"}),r.jsxs("span",{className:"font-bold",children:["-â¹",(x*l).toFixed(2)]})]}),r.jsx("div",{className:"border-t border-green-200 my-2"}),r.jsxs("p",{className:"flex justify-between text-base font-bold text-green-900",children:[r.jsx("span",{children:"Total to pay:"}),r.jsxs("span",{children:["â¹",_.toFixed(2)]})]})]})]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsxs("p",{className:"flex justify-between font-semibold",children:[r.jsx("span",{children:"Subtotal"}),r.jsxs("span",{children:["â¹",x.toFixed(2)]})]}),r.jsxs("p",{className:"flex justify-between font-semibold",children:[r.jsx("span",{children:"Shipping"}),r.jsx("span",{children:"Calculated at next step"})]}),r.jsxs("p",{className:"flex justify-between font-bold text-lg",children:[r.jsx("span",{children:"Total"}),r.jsxs("span",{children:["â¹",_.toFixed(2)]})]})]}),r.jsx("div",{className:"flex justify-center mb-4",children:r.jsx("button",{className:"bg-white border border-gray-300 rounded flex items-center justify-center py-3 px-6 hover:bg-gray-100 transition",children:r.jsx("img",{src:"https://5.imimg.com/data5/SELLER/Default/2023/9/348603242/KE/OR/XP/29083784/razorpay-software-250x250.png",alt:"Razorpay",className:"h-16 w-auto"})})}),r.jsx(he,{onClick:k,variant:"primary",className:"w-full",children:"Place Order"}),r.jsxs("div",{className:"mt-4 text-xs text-gray-500",children:[r.jsx("p",{children:"Refund policy"}),r.jsx("p",{children:"Shipping policy"}),r.jsx("p",{children:"I consent to receive recurring automated marketing by text message through an automatic telephone dialing system. Consent is not a condition to purchase. STOP to cancel. HELP for help. Message and Data rates may apply. View Privacy Policy & TOS"}),r.jsx("p",{children:"Terms of service"})]})]}),ne=()=>r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[r.jsx("h3",{className:"font-semibold mb-4",children:"Your cart"}),s.length===0?r.jsx("p",{children:"Your cart is empty"}):r.jsxs(r.Fragment,{children:[s.map(F=>r.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[!F.name.includes("Subscription Plan")&&r.jsx("img",{src:F.image_url,alt:F.name,className:"w-8 h-8 object-cover rounded"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"text-sm font-semibold",children:F.name}),r.jsxs("p",{className:"text-xs text-gray-600",children:["Quantity: ",F.quantity]})]}),r.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[r.jsxs("p",{className:"font-semibold",children:["â¹",(F.price*F.quantity).toFixed(2)]}),r.jsx("button",{onClick:()=>t(F.id),className:"text-red-600 hover:text-red-800 p-1",title:"Delete item",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},F.id)),r.jsxs("div",{className:"flex justify-between font-semibold border-t border-gray-300 pt-2",children:[r.jsx("span",{children:"Subtotal"}),r.jsxs("span",{children:["â¹",x.toFixed(2)]})]}),r.jsxs("div",{className:"flex justify-between font-semibold border-t border-gray-300 pt-2",children:[r.jsx("span",{children:"Shipping"}),r.jsx("span",{children:"Calculated at next step"})]}),r.jsxs("div",{className:"flex justify-between font-bold text-lg border-t border-gray-300 pt-2",children:[r.jsx("span",{children:"Total"}),r.jsxs("span",{children:["â¹",_.toFixed(2)]})]})]})]});return r.jsx(r.Fragment,{children:r.jsxs("div",{className:"max-w-6xl mx-auto p-6 grid grid-cols-1 md:grid-cols-3 gap-8",children:[r.jsxs("div",{className:"md:col-span-2 bg-white rounded-lg shadow-lg p-6",children:[r.jsx("nav",{className:"text-sm mb-6",children:r.jsxs("ol",{className:"list-reset flex text-gray-600 space-x-2",children:[r.jsxs("li",{children:["Cart ",">"]}),r.jsxs("li",{className:n===1?"font-bold":"",children:["Information ",">"]}),!b&&r.jsxs("li",{className:n===2?"font-bold":"",children:["Shipping ",">"]}),r.jsx("li",{className:n===(b?2:3)?"font-bold":"",children:"Payment"})]})}),n===1&&r.jsxs(r.Fragment,{children:[O(),r.jsx("hr",{className:"my-4"}),R()]}),n===2&&!b&&M(),n===2&&b&&ee(),n===3&&!b&&ee()]}),r.jsx("div",{className:"md:col-span-1",children:ne()})]})})},Dn=j.createContext(void 0),$o=({children:s})=>{const[e,t]=j.useState(null),[n,a]=j.useState(!0);j.useEffect(()=>{(async()=>{try{const{data:{session:h},error:p}=await q.auth.getSession();h?.user?t({id:h.user.id,name:h.user.user_metadata?.full_name||h.user.user_metadata?.name||"",email:h.user.email||""}):t(null)}catch(h){console.error("Error checking auth session:",h),t(null)}finally{a(!1)}})();const m=setTimeout(()=>{a(h=>h&&(console.warn("Auth check timed out, forcing loading false"),!1))},5e3),{data:{subscription:f}}=q.auth.onAuthStateChange(async(h,p)=>{p?.user?t({id:p.user.id,name:p.user.user_metadata?.full_name||p.user.user_metadata?.name||"",email:p.user.email||""}):t(null),a(!1)});return()=>{f.unsubscribe(),clearTimeout(m)}},[]);const i=async(u,m)=>{const{data:f,error:h}=await q.auth.signInWithPassword({email:u,password:m});if(h)throw h;return{id:f.user?.id||"",name:f.user?.user_metadata?.full_name||f.user?.user_metadata?.name||"",email:f.user?.email||u}},o=async(u,m,f)=>{const{data:h,error:p}=await q.auth.signUp({email:m,password:f,options:{data:{full_name:u,name:u}}});if(p)throw p;return h.session&&await q.auth.signOut(),{id:h.user?.id||"",name:u,email:h.user?.email||m}},l=async()=>{const{error:u}=await q.auth.signInWithOAuth({provider:"google"});if(u)throw u},c=async()=>{try{localStorage.setItem("justLoggedOut","true"),localStorage.removeItem("guestMode"),t(null);const{error:u}=await q.auth.signOut();u&&console.error("Logout error:",u)}catch(u){console.error("Logout error:",u)}},d=async u=>{const{error:m}=await q.auth.resetPasswordForEmail(u,{redirectTo:`${window.location.origin}/login`});if(m)throw m};return r.jsx(Dn.Provider,{value:{user:e,loading:n,signInWithEmail:i,signUpWithEmail:o,signInWithGoogle:l,resetPassword:d,logout:c},children:s})},Lo=()=>{const s=j.useContext(Dn);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s},Ne=()=>Lo(),ir={HONEY10:.1,BEE20:.2,OFFER:.1},Uo=()=>{const{cartItems:s,getTotal:e,clearCart:t}=it(),{user:n}=Ne(),[a,i]=j.useState(""),[o,l]=j.useState(0),[c,d]=j.useState(""),[u,m]=j.useState(!1),[f,h]=j.useState(""),p=e(),b=p-p*o,x=()=>{const w=a.toUpperCase();ir[w]?(l(ir[w]),d(""),l(ir[w]),d(""),Lt({particleCount:400,spread:160,origin:{y:.6},startVelocity:60,zIndex:9999})):(l(0),d("Invalid coupon code"))},_=async()=>{if(!n){alert("Please log in to place an order.");return}if(s.length===0){alert("Your cart is empty.");return}const w=s.reduce((v,k)=>{const T=k.seller_id;return v[T]||(v[T]=[]),v[T].push(k),v},{});try{const v=[];for(const O in w){const R=w[O],M=R.reduce((xe,y)=>xe+y.price*y.quantity,0),ee=M/p*(p*o),ne=M-ee,{data:F,error:te}=await q.from("orders").insert({user_id:n.id,seller_id:O,total:M,discounted_total:o>0?ne:void 0,coupon:o>0?a.toUpperCase():void 0,discount:o>0?ee/M:void 0,status:"pending",customer_email:n.email,customer_name:n.name}).select().single();if(te)throw te;const oe=F.id;v.push(oe);const E=R.map(xe=>({order_id:oe,product_id:xe.id,name:xe.name,price:xe.price,quantity:xe.quantity})),{error:H}=await q.from("order_items").insert(E);if(H)throw H}h(v.join(", ")),m(!0),t();const k=3e3,T=Date.now()+k,L={startVelocity:30,spread:360,ticks:60,zIndex:0},z=(O,R)=>Math.random()*(R-O)+O,D=setInterval(function(){const O=T-Date.now();if(O<=0)return clearInterval(D);const R=50*(O/k);Lt({...L,particleCount:R,origin:{x:z(.1,.3),y:Math.random()-.2}}),Lt({...L,particleCount:R,origin:{x:z(.7,.9),y:Math.random()-.2}})},250)}catch(v){console.error("Error placing order:",v),alert(`Failed to place order: ${v.message}`)}};return u?r.jsx(r.Fragment,{children:r.jsxs("div",{className:"max-w-4xl mx-auto p-6 text-center",children:[r.jsx("h2",{className:"text-3xl font-bold text-honeybee-primary mb-6",children:"Thank you for your order!"}),r.jsx("p",{children:"Your order has been placed successfully."}),f&&r.jsxs("p",{className:"text-lg mt-4",children:["Order ID(s): ",r.jsx("span",{className:"font-bold",children:f})]})]})}):r.jsx(r.Fragment,{children:r.jsxs("div",{className:"max-w-4xl mx-auto p-4 md:p-6 bg-honeybee-background text-honeybee-secondary rounded-lg shadow-lg",children:[r.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-honeybee-primary mb-6",children:"Checkout"}),r.jsxs("div",{children:[r.jsxs("div",{className:"mb-4",children:[r.jsx("h3",{className:"font-semibold mb-2",children:"Order Summary"}),s.map(w=>r.jsxs("div",{className:"flex justify-between mb-2 text-sm md:text-base",children:[r.jsxs("span",{children:[w.name," x ",w.quantity]}),r.jsxs("span",{children:["â¹",(w.price*w.quantity).toFixed(2)]})]},w.id)),r.jsxs("div",{className:"flex justify-between font-bold border-t border-gray-300 pt-2 text-sm md:text-base",children:[r.jsx("span",{children:"Total:"}),r.jsxs("span",{children:["â¹",p.toFixed(2)]})]}),o>0&&r.jsxs("div",{className:"flex justify-between font-bold text-green-600 pt-2 text-sm md:text-base",children:[r.jsx("span",{children:"Discount:"}),r.jsxs("span",{children:["-â¹",(p*o).toFixed(2)]})]}),o>0&&r.jsxs("div",{className:"flex justify-between font-bold border-t border-gray-300 pt-2 text-sm md:text-base",children:[r.jsx("span",{children:"Amount to Pay:"}),r.jsxs("span",{children:["â¹",b.toFixed(2)]})]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("label",{htmlFor:"coupon",className:"block font-semibold mb-1",children:"Have a coupon?"}),r.jsx("input",{id:"coupon",type:"text",value:a,onChange:w=>i(w.target.value),className:"border border-gray-300 rounded px-3 py-3 w-full text-base",placeholder:"Enter coupon code"}),c&&r.jsx("p",{className:"text-red-600 mt-1",children:c}),o>0&&r.jsxs("div",{className:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg animate-fade-in",children:[r.jsxs("div",{className:"flex items-center text-green-800 font-bold mb-2",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),'Coupon "',a.toUpperCase(),'" Applied Successfully!']}),r.jsxs("div",{className:"text-green-700 text-sm space-y-1",children:[r.jsxs("p",{className:"flex justify-between",children:[r.jsx("span",{children:"Savings:"}),r.jsxs("span",{className:"font-bold",children:["-â¹",(p*o).toFixed(2)]})]}),r.jsx("div",{className:"border-t border-green-200 my-2"}),r.jsxs("p",{className:"flex justify-between text-base font-bold text-green-900",children:[r.jsx("span",{children:"Total to pay:"}),r.jsxs("span",{children:["â¹",b.toFixed(2)]})]})]})]}),r.jsx(he,{onClick:x,variant:"accent",className:"mt-2 w-full md:w-auto",children:"Apply Coupon"})]}),r.jsx("div",{children:r.jsx(he,{onClick:_,variant:"primary",className:"w-full py-3 text-base",children:"Place Order"})})]})]})})},Do=()=>{const{user:s}=Ne(),[e,t]=j.useState({name:"",age:"",location:"",address:"",pincode:"",email:"",phone:""}),[n,a]=j.useState(!0),[i,o]=j.useState(!0),[l,c]=j.useState(e),[d,u]=j.useState(null);j.useEffect(()=>{(async()=>{if(s)try{const{data:x,error:_}=await q.from("profiles").select("*").eq("user_id",s.id).single();_&&_.code!=="PGRST116"?(console.error("Error fetching profile:",_),o(!0)):x?(t(x),c(x),o(!1)):(t({name:"",age:"",location:"",address:"",pincode:"",email:"",phone:""}),c({name:"",age:"",location:"",address:"",pincode:"",email:"",phone:""}),o(!0))}catch(x){console.error("Error fetching profile:",x),o(!0)}a(!1)})()},[s]);const m=b=>{const{name:x,value:_}=b.target;c(w=>({...w,[x]:_}))},f=async()=>{if(s){u(null);try{const{error:b}=await q.from("profiles").upsert({user_id:s.id,name:l.name,age:l.age,location:l.location,address:l.address,pincode:l.pincode,email:l.email,phone:l.phone});b?(console.error("Error saving profile:",b),u({type:"error",text:"Failed to save profile. Please try again."})):(t(l),o(!1),u({type:"success",text:"Profile saved successfully!"}))}catch(b){console.error("Error saving profile:",b),u({type:"error",text:"Failed to save profile. Please try again."})}}},h=()=>{c(e),o(!0)},p=()=>{c(e),o(!1)};return n?r.jsx("div",{children:"Loading profile..."}):r.jsxs("div",{className:"max-w-2xl mx-auto p-4 md:p-6",children:[r.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white mb-6",children:"Profile"}),d&&r.jsx("div",{className:`mb-4 p-3 rounded-lg text-center ${d.type==="success"?"bg-green-50 border border-green-200 text-green-600":"bg-red-50 border border-red-200 text-red-600"}`,children:d.text}),i?r.jsx("div",{className:"group",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name"}),r.jsx("input",{type:"text",name:"name",value:l.name,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white",placeholder:"Enter your name"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Age"}),r.jsx("input",{type:"number",name:"age",value:l.age,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white",placeholder:"Enter your age"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location"}),r.jsx("input",{type:"text",name:"location",value:l.location,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white",placeholder:"Enter your location"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pincode"}),r.jsx("input",{type:"text",name:"pincode",value:l.pincode,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white",placeholder:"Enter your pincode"})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),r.jsx("input",{type:"email",name:"email",value:l.email,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white",placeholder:"Enter your email"})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),r.jsx("input",{type:"tel",name:"phone",value:l.phone,onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white",placeholder:"Enter your phone number"})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),r.jsx("textarea",{name:"address",value:l.address,onChange:m,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white",placeholder:"Enter your full address"})]})]}),r.jsxs("div",{className:"group",children:[r.jsx(he,{onClick:f,className:"w-full",variant:"primary",children:"Save Profile"}),r.jsx("button",{onClick:p,className:"w-full mt-2 py-2 px-4 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100",children:"Cancel"})]})]})}):r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Name"}),r.jsx("p",{className:"text-gray-900",children:e.name})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Age"}),r.jsx("p",{className:"text-gray-900",children:e.age})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Location"}),r.jsx("p",{className:"text-gray-900",children:e.location})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Pincode"}),r.jsx("p",{className:"text-gray-900",children:e.pincode})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Email"}),r.jsx("p",{className:"text-gray-900",children:e.email})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Phone"}),r.jsx("p",{className:"text-gray-900",children:e.phone})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Address"}),r.jsx("p",{className:"text-gray-900",children:e.address})]})]}),r.jsx("button",{onClick:h,className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-purple-600 hover:bg-purple-700 focus:outline-none","aria-label":"Edit Profile",children:"Edit Profile"})]})]})},Ie=()=>{const{user:s}=Ne(),[e,t]=j.useState(null),[n,a]=j.useState(!0),[i,o]=j.useState(null),l=j.useCallback(async()=>{if(!s){t(null),a(!1);return}try{const{data:c,error:d}=await q.from("sellers").select("*").eq("user_id",s.id).single();if(d)if(d.code==="PGRST116")t(null);else throw d;else t(c)}catch(c){console.error("Error fetching seller:",c),o(c)}finally{a(!1)}},[s]);return j.useEffect(()=>{l()},[l]),{seller:e,loading:n,error:i,refreshSeller:l}},Bo={email:"",name:"",profilePic:null,acceptTerms:!1,city:"",state:"",zip:"",phone:"",idProof:null,sellerType:"",latitude:null,longitude:null,detectedAddress:""},Mo=()=>{const[s,e]=j.useState(0),[t,n]=j.useState(Bo),[a,i]=j.useState(""),[o,l]=j.useState(null),{user:c}=Ne(),{seller:d,loading:u}=Ie(),m=Ue();if(u)return r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:r.jsxs("div",{className:"flex flex-col items-center gap-4",children:[r.jsx("div",{className:"w-12 h-12 border-4 border-purple-200 border-t-purple-700 rounded-full animate-spin"}),r.jsx("p",{className:"text-gray-500 font-medium",children:"Verifying registration status..."})]})});if(d)return r.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50 p-4",children:r.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md max-w-md w-full text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),r.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Already Registered"}),r.jsxs("p",{className:"text-gray-600 mb-6",children:["You have already registered as a seller.",d.is_approved?" Access your dashboard to manage your products.":" Your application is currently under review."]}),r.jsxs("div",{className:"flex flex-col gap-3",children:[r.jsx("button",{onClick:()=>m("/applications"),className:"w-full bg-purple-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-purple-700 transition",children:"Go to Dashboard"}),r.jsx("button",{onClick:()=>m("/home"),className:"w-full bg-gray-100 text-gray-700 font-semibold py-2 px-4 rounded-lg hover:bg-gray-200 transition",children:"Return Home"})]}),r.jsxs("p",{className:"mt-4 text-xs text-gray-400",children:["Seller ID: ",d.seller_id]})]})});const f=D=>{const{name:O,value:R,type:M,checked:ee}=D.target;n(ne=>({...ne,[O]:M==="checkbox"?ee:R}))},h=D=>{const{name:O,files:R}=D.target;R&&R[0]&&n(M=>({...M,[O]:R[0]}))},p=()=>{s<5&&e(s+1)},b=()=>{s>1&&e(s-1)},x=async D=>{if(D.preventDefault(),s===3){p();return}if(s===4&&!t.detectedAddress){l({type:"error",text:"Please detect your location before submitting."});return}if(s===4||s===4&&t.detectedAddress){if(!c){l({type:"error",text:"Please sign in to submit the application."}),setTimeout(()=>m("/login"),2e3);return}const{data:{session:O},error:R}=await q.auth.getSession();if(R||!O){l({type:"error",text:"Session expired. Please sign in again."}),setTimeout(()=>m("/login"),2e3);return}if(!a){l({type:"error",text:"Please select a seller type (Honey or Bee Hive)."});return}if(!c?.email||!t.name||!t.acceptTerms){l({type:"error",text:"Please fill all required fields and accept terms."});return}try{const M=`SELLER-${Date.now()}`;let ee="",ne="";if(t.profilePic){const te=`${c.email}/${M}/profile_${Date.now()}.${t.profilePic.name.split(".").pop()}`,{error:oe}=await q.storage.from("sellerid_details").upload(te,t.profilePic);if(oe)throw oe;const{data:E}=q.storage.from("sellerid_details").getPublicUrl(te);ee=E.publicUrl}if(t.idProof){const te=`${c.email}/${M}/id_${Date.now()}.${t.idProof.name.split(".").pop()}`,{error:oe}=await q.storage.from("sellerid_details").upload(te,t.idProof);if(oe)throw oe;const{data:E}=q.storage.from("sellerid_details").getPublicUrl(te);ne=E.publicUrl}const{error:F}=await q.from("sellers").insert([{user_id:c.id,seller_id:M,name:t.name,email:c.email,seller_type:a,phone:t.phone,address:t.detectedAddress||`${t.city}, ${t.state}, ${t.zip}`,city:t.city,state:t.state,zip:t.zip,id_proof_url:ne,profile_pic_url:ee,is_approved:!1,kyc_verified:!1,latitude:t.latitude,longitude:t.longitude}]);if(F)throw F;l({type:"success",text:"Seller registration submitted successfully! Your application will be reviewed."}),setTimeout(()=>m("/applications"),2e3)}catch(M){console.error("Error submitting application:",M),l({type:"error",text:`Registration failed: ${M instanceof Error?M.message:"Unknown error"}`})}return}p()},_=()=>{const D=["Personal Information","Address","Contact","Location","Finish"];return r.jsx("div",{className:"flex justify-center space-x-8 mb-8",children:D.map((O,R)=>{const M=R+1,ee=M===s,ne=M<s;return r.jsxs("div",{className:"flex flex-col items-center text-center",children:[r.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center ${ee||ne?"border-purple-700":"border-gray-300"}`,children:ne?r.jsx("svg",{className:"w-4 h-4 text-purple-700",fill:"none",stroke:"currentColor",strokeWidth:"3",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}):r.jsx("div",{className:`w-3 h-3 rounded-full ${ee?"bg-purple-700":"bg-gray-300"}`})}),r.jsx("span",{className:`mt-1 text-xs font-semibold ${ee||ne?"text-purple-700":"text-gray-400"}`,children:O.split(" ").map((F,te)=>r.jsxs(bt.Fragment,{children:[F,r.jsx("br",{})]},te))})]},O)})})},w=()=>r.jsx("div",{className:"max-w-4xl mx-auto p-6 text-center",children:r.jsxs("div",{className:"flex justify-center gap-8",children:[r.jsx("button",{onClick:()=>{i("honey"),e(1)},className:"gradient-bg-primary hover:shadow-2xl text-black font-semibold py-4 px-10 rounded-full transition-all duration-300 ease-out modern-shadow-hover transform hover:scale-105",children:"Sell Honey"}),r.jsx("button",{onClick:()=>{i("beehive"),e(1)},className:"gradient-bg-primary hover:shadow-2xl text-black font-semibold py-4 px-10 rounded-full transition-all duration-300 ease-out modern-shadow-hover transform hover:scale-105",children:"Sell Bee Hive"})]})}),v=()=>r.jsxs("form",{onSubmit:x,className:"max-w-md mx-auto bg-white p-6 rounded shadow",children:[r.jsx("h2",{className:"text-xl font-bold mb-6",children:"Personal Information"}),r.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Your Email"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"email",name:"email",value:c?.email||"",readOnly:!0,disabled:!0,className:"w-full mb-4 px-3 py-2 border rounded bg-gray-200 text-gray-600 cursor-not-allowed"}),r.jsx("svg",{className:"w-4 h-4 text-gray-500 absolute right-3 top-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})]}),r.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Your Name"}),r.jsx("input",{type:"text",name:"name",placeholder:"e.g. John Doe",value:t.name,onChange:f,required:!0,className:"w-full mb-4 px-3 py-2 border rounded bg-gray-100 text-gray-700 placeholder-gray-400"}),r.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Profile Picture"}),r.jsx("input",{type:"file",name:"profilePic",accept:"image/*",onChange:h,required:!0,className:"w-full mb-2 px-3 py-2 border rounded bg-gray-100 text-gray-700"}),t.profilePic&&r.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["File: ",t.profilePic.name," | Size: ",(t.profilePic.size/1024).toFixed(2)," KB | Type: ",t.profilePic.type]}),r.jsxs("label",{className:"inline-flex items-center mb-4",children:[r.jsx("input",{type:"checkbox",name:"acceptTerms",checked:t.acceptTerms,onChange:f,required:!0,className:"form-checkbox text-purple-700"}),r.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"I Accept Terms & Conditions"})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("button",{type:"button",onClick:()=>{e(0)},className:"text-purple-700 underline",children:"Back to Options"}),r.jsxs(he,{type:"submit",variant:"primary",className:"flex items-center space-x-2",children:[r.jsx("span",{children:"Next"}),r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]})]})]}),k=()=>r.jsxs("form",{onSubmit:x,className:"max-w-md mx-auto bg-white p-6 rounded shadow",children:[r.jsx("h2",{className:"text-xl font-bold mb-6",children:"Address"}),r.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"City"}),r.jsx("input",{type:"text",name:"city",value:t.city,onChange:f,required:!0,className:"w-full mb-4 px-3 py-2 border rounded bg-gray-100 text-gray-700 placeholder-gray-400"}),r.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"State"}),r.jsx("input",{type:"text",name:"state",value:t.state,onChange:f,required:!0,className:"w-full mb-4 px-3 py-2 border rounded bg-gray-100 text-gray-700 placeholder-gray-400"}),r.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Zip"}),r.jsx("input",{type:"text",name:"zip",value:t.zip,onChange:f,required:!0,className:"w-full mb-4 px-3 py-2 border rounded bg-gray-100 text-gray-700 placeholder-gray-400"}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("button",{type:"button",onClick:b,className:"text-purple-700 underline",children:"Back"}),r.jsxs(he,{type:"submit",variant:"primary",className:"flex items-center space-x-2",children:[r.jsx("span",{children:"Next"}),r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]})]})]}),T=()=>r.jsxs("form",{onSubmit:x,className:"max-w-md mx-auto bg-white p-6 rounded shadow",children:[r.jsx("h2",{className:"text-xl font-bold mb-6",children:"Contact"}),r.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Phone"}),r.jsx("input",{type:"text",name:"phone",value:t.phone,onChange:f,required:!0,className:"w-full mb-4 px-3 py-2 border rounded bg-gray-100 text-gray-700 placeholder-gray-400"}),r.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"ID Proof"}),r.jsx("input",{type:"file",name:"idProof",accept:"image/*,.pdf",onChange:h,required:!0,className:"w-full mb-2 px-3 py-2 border rounded bg-gray-100 text-gray-700"}),t.idProof&&r.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["File: ",t.idProof.name," | Size: ",(t.idProof.size/1024).toFixed(2)," KB | Type: ",t.idProof.type]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("button",{type:"button",onClick:b,className:"text-purple-700 underline",children:"Back"}),r.jsx(he,{type:"submit",variant:"primary",children:"Sign up"})]})]}),L=()=>r.jsxs("div",{className:"max-w-md mx-auto bg-white p-6 rounded shadow text-center",children:[r.jsx("h2",{className:"text-xl font-bold mb-4",children:"Location Access"}),r.jsx("p",{className:"mb-6 text-gray-600",children:"Please allow location access to verify your selling region and improve customer discovery."}),t.detectedAddress?r.jsxs("div",{className:"animate-fade-in",children:[r.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200 mb-4",children:[r.jsx("p",{className:"text-green-800 font-semibold mb-1",children:"Location Detected!"}),r.jsx("p",{className:"text-gray-700 text-sm",children:t.detectedAddress})]}),r.jsx(he,{onClick:x,variant:"primary",className:"w-full",children:"Complete Registration"})]}):r.jsxs(he,{onClick:()=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(async D=>{const{latitude:O,longitude:R}=D.coords;try{const ne=(await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${O}&lon=${R}`)).json()).display_name;n(F=>({...F,latitude:O,longitude:R,detectedAddress:ne}))}catch(M){console.error("Geocoding error:",M),alert("Could not detect address. Please try again.")}},D=>{console.error("Location error:",D),alert("Location access denied. You can proceed without it.")}):alert("Geolocation is not supported by your browser.")},variant:"primary",className:"w-full flex justify-center items-center gap-2",children:[r.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Detect My Location"]})]}),z=()=>r.jsxs("div",{className:"max-w-md mx-auto bg-white p-8 rounded shadow text-center",children:[r.jsx("svg",{className:"mx-auto mb-6 w-16 h-16 text-green-500",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),r.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Application Submitted"}),r.jsx("p",{className:"mb-4",children:"Your seller application has been submitted successfully. You will be redirected to your dashboard shortly."}),r.jsx("a",{href:"/applications",className:"text-purple-700 underline",children:"Go to Dashboard"})]});return r.jsxs("div",{className:"min-h-screen py-12 px-4 md:px-6",children:[r.jsx("h1",{className:"text-center font-semibold text-lg md:text-xl mb-4",children:"Register as a Seller"}),o&&r.jsx("div",{className:`max-w-md mx-auto mb-4 p-3 rounded-lg text-center ${o.type==="success"?"bg-green-50 border border-green-200 text-green-600":"bg-red-50 border border-red-200 text-red-600"}`,children:o.text}),r.jsxs(r.Fragment,{children:[s===0&&w(),s>0&&_(),s===1&&v(),s===2&&k(),s===3&&T(),s===4&&L(),s===5&&z()]})]})},Fo="modulepreload",qo=function(s){return"/"+s},xs={},zo=function(e,t,n){let a=Promise.resolve();if(t&&t.length>0){let c=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");a=c(t.map(d=>{if(d=qo(d),d in xs)return;xs[d]=!0;const u=d.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${m}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Fo,u||(f.as="script"),f.crossOrigin="",f.href=d,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((h,p)=>{f.addEventListener("load",h),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},ke=({children:s,title:e})=>{const t=Ue(),n=kr(),{seller:a,loading:i,refreshSeller:o}=Ie(),[l,c]=j.useState(!1),[d,u]=j.useState(!1),m=[{path:"/applications",icon:"ð",label:"Dashboard"},{path:"/earnings",icon:"ð°",label:"Earnings"},{path:"/orders",icon:"ð",label:"Orders"},{path:"/analytics",icon:"ð",label:"Analytics"},{path:"/products",icon:"ð¦",label:"Products"},{path:"/settings",icon:"âï¸",label:"Settings"}],f=async()=>{d||(u(!0),"geolocation"in navigator?navigator.geolocation.getCurrentPosition(async h=>{const{latitude:p,longitude:b}=h.coords;try{const _=await(await fetch(`https://api.bigdatacloud.com/data/reverse-geocode-client?latitude=${p}&longitude=${b}&localityLanguage=en`)).json(),w=`${_.principalSubdivision||""}, ${_.city||""}`.trim().replace(/^, /,""),{supabase:v}=await zo(async()=>{const{supabase:T}=await Promise.resolve().then(()=>Po);return{supabase:T}},void 0),{error:k}=await v.from("sellers").update({address:w,city:_.city,state:_.principalSubdivision,latitude:p,longitude:b}).eq("user_id",a?.user_id);if(k)throw k;await o(),alert("Location updated successfully!")}catch(x){console.error("Error updating location:",x),alert("Failed to update location.")}finally{u(!1)}},h=>{console.error("Location error:",h),alert("Location access denied."),u(!1)}):(alert("Geolocation not supported."),u(!1)))};return i?r.jsx("div",{className:"flex justify-center items-center h-screen bg-gray-50",children:r.jsx("div",{className:"w-12 h-12 border-4 border-purple-200 border-t-purple-700 rounded-full animate-spin"})}):r.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col lg:flex-row",children:[r.jsxs("div",{className:"lg:hidden bg-white shadow-sm px-4 py-3 flex items-center justify-between sticky top-0 z-40",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("button",{onClick:()=>c(!0),className:"p-2 -ml-2",children:r.jsx("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),r.jsx("h1",{className:"font-bold text-purple-700",children:"HoneyBee"})]}),a?.address&&r.jsxs("div",{className:"flex items-center gap-1 text-[10px] bg-purple-50 text-purple-700 px-2 py-1 rounded-full border border-purple-100 max-w-[140px] truncate",children:[r.jsx("svg",{className:"w-3 h-3 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})}),r.jsx("span",{className:"truncate",children:a.address.split(",")[0]})]})]}),l&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 lg:hidden",onClick:()=>c(!1),children:r.jsxs("div",{className:"w-64 bg-white h-full shadow-lg flex flex-col",onClick:h=>h.stopPropagation(),children:[r.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-purple-600 text-white",children:[r.jsx("span",{className:"font-bold",children:"Seller Menu"}),r.jsx("button",{onClick:()=>c(!1),className:"p-1 hover:bg-purple-700 rounded",children:"â"})]}),r.jsx("nav",{className:"p-2 flex-1 overflow-y-auto",children:m.map(h=>r.jsxs("button",{onClick:()=>{t(h.path),c(!1)},className:`flex items-center w-full px-4 py-3 rounded-lg mb-1 transition-all ${n.pathname===h.path?"bg-purple-100 text-purple-700 font-bold":"text-gray-600 hover:bg-gray-100"}`,children:[r.jsx("span",{className:"mr-3",children:h.icon})," ",h.label]},h.path))})]})}),r.jsxs("div",{className:"hidden lg:flex flex-col w-64 bg-white shadow-xl min-h-screen sticky top-0",children:[r.jsxs("div",{className:"p-6 border-b",children:[r.jsx("h2",{className:"text-2xl font-black text-purple-700 tracking-tight",children:"HoneyBee"}),r.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest mt-1",children:"Seller Studio"})]}),r.jsx("nav",{className:"p-4 flex-1",children:m.map(h=>r.jsxs("button",{onClick:()=>t(h.path),className:`flex items-center w-full px-4 py-3 rounded-xl mb-2 transition-all group ${n.pathname===h.path?"bg-purple-600 text-white shadow-lg shadow-purple-200":"text-gray-500 hover:bg-purple-50 hover:text-purple-600"}`,children:[r.jsx("span",{className:"mr-3 text-lg transition-transform group-hover:scale-110",children:h.icon}),r.jsx("span",{className:"font-semibold",children:h.label})]},h.path))}),a&&r.jsx("div",{className:"p-4 border-t border-gray-100",children:r.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 border border-gray-100 relative overflow-hidden group",children:[r.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-purple-100 rounded-full -mr-8 -mt-8 opacity-20"}),r.jsxs("div",{className:"relative z-10 space-y-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-[9px] text-gray-400 uppercase font-black tracking-[0.2em] mb-1",children:"Store ID"}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"font-mono text-xs font-bold text-gray-700 truncate mr-2",children:a.seller_id}),r.jsx("button",{onClick:()=>{navigator.clipboard.writeText(a.seller_id),alert("ID Copied!")},className:"text-gray-300 hover:text-purple-500",children:r.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2"})})})]})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-1",children:[r.jsx("p",{className:"text-[9px] text-gray-400 uppercase font-black tracking-[0.2em]",children:"Location"}),r.jsx("button",{onClick:f,disabled:d,className:"text-[9px] font-bold text-purple-600 hover:underline uppercase",children:d?"...":"Update"})]}),r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx("div",{className:"w-5 h-5 rounded-full bg-purple-100 flex items-center justify-center flex-shrink-0 mt-0.5",children:r.jsx("svg",{className:"w-3 h-3 text-purple-600",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})})}),r.jsx("span",{className:"text-[11px] text-gray-600 font-medium leading-relaxed",children:a.address||"Not Set"})]})]})]})]})})]}),r.jsxs("main",{className:"flex-1 p-4 lg:p-8 overflow-y-auto",children:[r.jsxs("header",{className:"mb-8 hidden lg:block",children:[r.jsx("h1",{className:"text-3xl font-black text-gray-900 tracking-tight",children:e}),r.jsx("p",{className:"text-gray-500 font-medium mt-1",children:"Manage your honey business and sales"})]}),s]})]})},Wo=()=>{const{user:s}=Ne(),e=Ue(),{seller:t,loading:n}=Ie(),[a,i]=j.useState(!0),[o,l]=j.useState([]),[c,d]=j.useState(0),[u,m]=j.useState(0),[f,h]=j.useState(0),[p,b]=j.useState([]),[x,_]=j.useState(!1),[w,v]=j.useState(!1),[k,T]=j.useState({idType:"Adhaar",idNumber:"",address:"",pincode:""}),[L,z]=j.useState(!1),[D,O]=j.useState("none"),[R,M]=j.useState({name:"",description:"",price:"",category:"",stock:"",image_url:""}),[ee,ne]=j.useState(!1),F=j.useCallback(async()=>{if(!s||!t){!n&&!t&&i(!1);return}i(!0);try{const{data:E,error:H}=await q.from("kyc").select("status").eq("user_id",s.id).single();H&&H.code!=="PGRST116"&&console.error("KYC fetch error:",H),O(E?E.status:"none");const{data:xe,error:y}=await q.from("products").select("*").eq("seller_id",t.id);if(y)throw y;b(xe||[]);const{data:g,error:C}=await q.from("orders").select(`
          id,
          user_id,
          total,
          discounted_total,
          coupon,
          discount,
          status,
          created_at,
          customer_email,
          customer_name,
          order_items ( id, product_id, name, price, quantity )
        `).eq("seller_id",t.id);if(C)throw C;const I=(g||[]).map(P=>({id:P.id,userId:P.user_id,items:P.order_items||[],total:P.total,discountedTotal:P.discounted_total,coupon:P.coupon,discount:P.discount,status:P.status,createdAt:new Date(P.created_at),customerEmail:P.customer_email,customerName:P.customer_name}));let U=0,B=0;I.forEach(P=>{U+=P.total||0,B+=1}),l(I),d(U),m(B),h(xe?.length||0)}catch(E){console.error("Error fetching dashboard data:",E)}finally{i(!1)}},[s,t,n]);j.useEffect(()=>{n||F()},[F,n]);const te=async E=>{if(E.preventDefault(),!!s){z(!0);try{const{error:H}=await q.from("kyc").insert({user_id:s.id,id_type:k.idType,id_number:k.idNumber.slice(-4),address:k.address,pincode:k.pincode,status:"pending"});if(H)throw H;alert("KYC submitted successfully! It will be reviewed shortly."),_(!1),T({idType:"Adhaar",idNumber:"",address:"",pincode:""}),F()}catch(H){console.error("KYC submission error:",H),alert(`KYC submission failed: ${H instanceof Error?H.message:"Unknown error"}`)}finally{z(!1)}}},oe=async E=>{if(E.preventDefault(),!t){alert("You must be a registered seller to add products.");return}ne(!0);try{const{error:H}=await q.from("products").insert({seller_id:t.id,name:R.name,description:R.description,price:parseFloat(R.price),category:R.category,stock:parseInt(R.stock,10),image_url:R.image_url,is_active:!0});if(H)throw H;alert("Product added successfully!"),v(!1),M({name:"",description:"",price:"",category:"",stock:"",image_url:""}),F()}catch(H){console.error("Product submission error:",H),alert(`Product submission failed: ${H instanceof Error?H.message:"Unknown error"}`)}finally{ne(!1)}};return a?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"w-12 h-12 border-4 border-purple-200 border-t-purple-700 rounded-full animate-spin"})}):r.jsxs(ke,{title:"Seller Dashboard",children:[r.jsxs("div",{className:"max-w-7xl mx-auto",children:[D==="pending"&&r.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-8",children:r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),r.jsx("div",{className:"ml-3",children:r.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Your KYC verification is currently pending. Your dashboard will be fully unlocked once approved."})})]})}),D==="none"&&r.jsx("div",{className:"bg-white border border-yellow-200 border-l-4 border-l-yellow-400 p-6 mb-8 rounded-xl shadow-sm",children:r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[r.jsxs("div",{className:"flex items-start",children:[r.jsx("div",{className:"bg-yellow-100 p-2 rounded-lg mr-4",children:r.jsx("svg",{className:"h-6 w-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"KYC Verification Required"}),r.jsx("p",{className:"text-sm text-gray-500 font-medium mt-1",children:"Complete your identity verification to start listing products and receiving payments."})]})]}),r.jsx("button",{onClick:()=>_(!0),className:"w-full sm:w-auto bg-purple-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-purple-700 transition shadow-lg shadow-purple-100",children:"Start Verification"})]})}),D==="rejected"&&r.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 mb-8",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),r.jsx("div",{className:"ml-3",children:r.jsx("p",{className:"text-sm text-red-700 font-bold",children:"KYC Rejected: Please review your document and resubmit."})})]}),r.jsx("button",{onClick:()=>_(!0),className:"bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-red-700 transition",children:"Resubmit KYC"})]})}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6 mb-8",children:[r.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[r.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1",children:"Total Sales"}),r.jsxs("p",{className:"text-3xl font-black text-gray-900 leading-none",children:["â¹",c.toFixed(2)]})]}),r.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[r.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1",children:"Total Orders"}),r.jsx("p",{className:"text-3xl font-black text-gray-900 leading-none",children:u})]}),r.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[r.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1",children:"Active Products"}),r.jsx("p",{className:"text-3xl font-black text-gray-900 leading-none",children:f})]}),r.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[r.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1",children:"Approval Status"}),r.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[r.jsx("div",{className:`w-2.5 h-2.5 rounded-full animate-pulse ${t?.is_approved?"bg-green-500":"bg-yellow-500"}`}),r.jsx("p",{className:`text-2xl font-black ${t?.is_approved?"text-green-600":"text-yellow-600"}`,children:t?.is_approved?"Approved":"Pending"})]})]})]}),r.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden mb-8",children:[r.jsxs("div",{className:"p-6 border-b border-gray-50 flex justify-between items-center bg-gray-50/20",children:[r.jsx("h3",{className:"text-lg font-black text-gray-900 tracking-tight",children:"Recent Orders"}),r.jsx("button",{onClick:()=>e("/orders"),className:"text-xs font-bold text-purple-600 hover:text-purple-800 uppercase tracking-widest",children:"View All â"})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{className:"bg-gray-50/50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Order ID"}),r.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Product(s)"}),r.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Status"}),r.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Date"}),r.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Total"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-50",children:o.length>0?o.map(E=>r.jsxs("tr",{className:"hover:bg-gray-50/30 transition-colors",children:[r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900 font-mono",children:["#",E.id.slice(0,8).toUpperCase()]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 font-medium",children:E.items.map(H=>`${H.name} (x${H.quantity})`).join(", ")}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`px-2 py-0.5 inline-flex text-[10px] leading-5 font-black uppercase tracking-widest rounded-full ${E.status==="completed"||E.status==="delivered"?"bg-green-100 text-green-700":E.status==="pending"||E.status==="processing"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:E.status})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-medium",children:new Date(E.createdAt).toLocaleDateString()}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900",children:["â¹",E.total.toFixed(2)]})]},E.id)):r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-6 py-8 text-center text-gray-400 font-medium italic",children:"No orders found yet"})})})]})})]}),r.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[r.jsxs("div",{className:"p-6 border-b border-gray-50 flex items-center justify-between bg-gray-50/20",children:[r.jsx("h3",{className:"text-lg font-black text-gray-900 tracking-tight",children:"Product Catalog"}),r.jsx("div",{className:"flex gap-2",children:r.jsx("button",{onClick:()=>e("/products"),className:"text-xs font-bold text-purple-600 hover:text-purple-800 uppercase tracking-widest",children:"Manage All â"})})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{className:"bg-gray-50/50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Name"}),r.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Category"}),r.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Price"}),r.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Stock"}),r.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Status"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.length>0?p.slice(0,5).map(E=>r.jsxs("tr",{className:"hover:bg-gray-50/30 transition-colors",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900",children:E.name}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-medium uppercase text-[10px] tracking-widest",children:E.category}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-black text-gray-900",children:["â¹",E.price.toFixed(2)]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-bold",children:r.jsx("span",{className:E.stock<10?"text-red-500":"text-gray-900",children:E.stock})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:"px-2 py-0.5 inline-flex text-[10px] leading-5 font-black uppercase tracking-widest rounded-full bg-green-100 text-green-700",children:"Active"})})]},E.id)):r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-6 py-8 text-center text-gray-400 font-medium italic",children:"No products listed yet"})})})]})})]})]}),x&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-8 relative",children:[r.jsx("button",{onClick:()=>_(!1),className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx("svg",{className:"w-8 h-8 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),r.jsx("h2",{className:"text-2xl font-black text-gray-900",children:"Complete KYC Verification"}),r.jsx("p",{className:"text-gray-500 font-medium mt-1",children:"Identity verification is required for all sellers."})]}),r.jsxs("form",{onSubmit:te,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"ID Type"}),r.jsxs("select",{value:k.idType,onChange:E=>T({...k,idType:E.target.value}),className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all",children:[r.jsx("option",{value:"Adhaar",children:"Adhaar Card"}),r.jsx("option",{value:"Passport",children:"Passport"}),r.jsx("option",{value:"VoterID",children:"Voter ID"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"ID Number"}),r.jsx("input",{type:"text",value:k.idNumber,onChange:E=>T({...k,idNumber:E.target.value}),required:!0,placeholder:"e.g. 1234-5678-9012",className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Full Address"}),r.jsx("textarea",{value:k.address,onChange:E=>T({...k,address:E.target.value}),required:!0,placeholder:"Street, City, Zip...",className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all",rows:3})]}),r.jsx("button",{type:"submit",disabled:L,className:"w-full bg-purple-600 text-white py-4 rounded-xl font-black uppercase tracking-widest hover:bg-purple-700 transition-all shadow-xl shadow-purple-100 disabled:opacity-50",children:L?"Verifying...":"Submit Verification"})]})]})}),w&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full p-8 max-h-[90vh] overflow-y-auto relative",children:[r.jsx("button",{onClick:()=>v(!1),className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),r.jsx("h2",{className:"text-2xl font-black text-gray-900 tracking-tight mb-6",children:"Add New Product"}),r.jsxs("form",{onSubmit:oe,className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Product Name"}),r.jsx("input",{type:"text",value:R.name,onChange:E=>M({...R,name:E.target.value}),required:!0,placeholder:"e.g. Pure Wild Forest Honey",className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Category"}),r.jsxs("select",{value:R.category,onChange:E=>M({...R,category:E.target.value}),required:!0,className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all",children:[r.jsx("option",{value:"",children:"Select Category"}),r.jsx("option",{value:"honey",children:"Honey"}),r.jsx("option",{value:"beehive",children:"Beehive"}),r.jsx("option",{value:"accessories",children:"Accessories"}),r.jsx("option",{value:"other",children:"Other"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Description"}),r.jsx("textarea",{value:R.description,onChange:E=>M({...R,description:E.target.value}),required:!0,placeholder:"Describe your product's unique features...",className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all",rows:4})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Price (â¹)"}),r.jsx("input",{type:"number",value:R.price,onChange:E=>M({...R,price:E.target.value}),required:!0,placeholder:"0.00",className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Stock Inventory"}),r.jsx("input",{type:"number",value:R.stock,onChange:E=>M({...R,stock:E.target.value}),required:!0,placeholder:"0",className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Image URL"}),r.jsx("input",{type:"url",value:R.image_url,onChange:E=>M({...R,image_url:E.target.value}),placeholder:"https://...",className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all"})]}),r.jsx("button",{type:"submit",disabled:ee,className:"w-full bg-purple-600 text-white py-4 rounded-xl font-black uppercase tracking-widest hover:bg-purple-700 transition-all shadow-xl shadow-purple-100 disabled:opacity-50",children:ee?"Adding Product...":"Confirm Listing"})]})]})})]})},Vo=()=>{const{user:s}=Ne(),{seller:e,loading:t}=Ie(),[n,a]=j.useState(!0),[i,o]=j.useState([]),[l,c]=j.useState("all"),d=j.useCallback(async()=>{if(e){a(!0);try{const{data:f,error:h}=await q.from("orders").select(`
          id,
          user_id,
          total,
          status,
          created_at,
          customer_email,
          customer_name,
          order_items ( id, product_id, name, price, quantity )
        `).eq("seller_id",e.id).order("created_at",{ascending:!1});if(h)throw h;const p=(f||[]).map(b=>({id:b.id,userId:b.user_id,items:b.order_items||[],total:b.total,status:b.status,createdAt:new Date(b.created_at),customerEmail:b.customer_email,customerName:b.customer_name}));o(p)}catch(f){console.error("Error fetching orders:",f)}finally{a(!1)}}},[e]);j.useEffect(()=>{!t&&e?d():!t&&!e&&a(!1)},[d,t,e]);const u=async(f,h)=>{try{const{error:p}=await q.from("orders").update({status:h}).eq("id",f);if(p)throw p;alert(`Order status updated to ${h}`),d()}catch(p){console.error("Error updating order status:",p),alert("Failed to update status.")}},m=l==="all"?i:i.filter(f=>f.status===l);return n?r.jsx(ke,{title:"Orders",children:r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"w-12 h-12 border-4 border-purple-200 border-t-purple-700 rounded-full animate-spin"})})}):r.jsx(ke,{title:"Orders",children:r.jsxs("div",{className:"max-w-7xl mx-auto",children:[r.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-black text-gray-900",children:"Order Management"}),r.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Track and process your incoming sales"})]}),r.jsx("div",{className:"flex bg-white p-1 rounded-xl border border-gray-100 shadow-sm",children:["all","pending","processing","shipped","delivered","cancelled"].map(f=>r.jsx("button",{onClick:()=>c(f),className:`px-4 py-2 rounded-lg text-xs font-black uppercase tracking-widest transition-all ${l===f?"bg-purple-600 text-white shadow-md":"text-gray-400 hover:text-gray-600"}`,children:f},f))})]}),r.jsx("div",{className:"grid gap-6",children:m.length>0?m.map(f=>r.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden hover:shadow-md transition-shadow",children:[r.jsxs("div",{className:"p-6 border-b border-gray-50 flex flex-wrap justify-between items-center gap-4 bg-gray-50/20",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"bg-purple-100 p-2 rounded-lg",children:r.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Order ID"}),r.jsxs("p",{className:"text-sm font-bold text-gray-900 font-mono",children:["#",f.id.split("-")[0].toUpperCase()]})]})]}),r.jsxs("div",{className:"flex items-center gap-8",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest text-right",children:"Date"}),r.jsx("p",{className:"text-sm font-bold text-gray-900",children:f.createdAt.toLocaleDateString()})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest text-right",children:"Total"}),r.jsxs("p",{className:"text-sm font-black text-purple-600",children:["â¹",f.total.toFixed(2)]})]})]})]}),r.jsxs("div",{className:"p-6 grid md:grid-cols-2 gap-8",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-4",children:"Items Summary"}),r.jsx("div",{className:"space-y-3",children:f.items.map(h=>r.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-3 rounded-xl border border-gray-100/50",children:[r.jsxs("span",{className:"text-sm font-bold text-gray-700",children:[h.name," ",r.jsxs("span",{className:"text-gray-400 ml-1",children:["x",h.quantity]})]}),r.jsxs("span",{className:"text-sm font-black text-gray-900",children:["â¹",(h.price*h.quantity).toFixed(2)]})]},h.id))})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-4",children:"Customer & status"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-50 flex items-center justify-center text-blue-600 font-bold text-xs",children:f.customerName?.charAt(0)||"C"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-bold text-gray-900",children:f.customerName}),r.jsx("p",{className:"text-xs text-gray-500 font-medium",children:f.customerEmail})]})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("select",{value:f.status,onChange:h=>u(f.id,h.target.value),className:"flex-1 rounded-xl border-gray-100 bg-gray-50/50 p-3 text-xs font-black uppercase tracking-widest focus:ring-purple-500 focus:border-purple-500",children:[r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"processing",children:"Processing"}),r.jsx("option",{value:"shipped",children:"Shipped"}),r.jsx("option",{value:"delivered",children:"Delivered"}),r.jsx("option",{value:"cancelled",children:"Cancelled"})]}),r.jsx("span",{className:`px-4 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest ${f.status==="delivered"?"bg-green-100 text-green-700":f.status==="cancelled"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:f.status})]})]})]})]})]},f.id)):r.jsxs("div",{className:"bg-white rounded-2xl border border-dashed border-gray-200 p-12 text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx("svg",{className:"w-8 h-8 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0a2 2 0 01-2 2H6a2 2 0 01-2-2m16 0l-8 8-8-8"})})}),r.jsx("p",{className:"text-gray-500 font-medium italic",children:"No orders found matching this criteria."})]})})]})})};var Ho={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Go=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),fe=(s,e)=>{const t=j.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,...d},u)=>j.createElement("svg",{ref:u,...Ho,width:a,height:a,stroke:n,strokeWidth:o?Number(i)*24/Number(a):i,className:["lucide",`lucide-${Go(s)}`,l].join(" "),...d},[...e.map(([m,f])=>j.createElement(m,f)),...Array.isArray(c)?c:[c]]));return t.displayName=`${s}`,t};const Ee=fe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const bs=fe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const Bn=fe("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);const Mn=fe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const Ko=fe("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);const Jo=fe("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);const Yo=fe("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);const Qo=fe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);const Xo=fe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const Zo=fe("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);const el=fe("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const ys=fe("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);const tl=fe("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);const rl=fe("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);const sl=fe("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]),nl=()=>{const{addToCart:s}=it(),e=Ue(),t=(n,a)=>{const i={id:n==="Basic"?"subscription-basic":"subscription-premium",name:`${n} Subscription Plan`,description:`${n} subscription plan for sellers`,price:a,category:"subscription",image_url:n==="Basic"?"/src/assets/basic.PNG":"/src/assets/premium.PNG",seller_id:"system",stock:999,is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};s(i),e("/cart")};return r.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[r.jsx("h2",{className:"text-3xl font-bold text-white mb-6 text-center",children:"Subscription Plans"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[r.jsx("div",{className:"group",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg animate-card-hover p-6 text-center",children:[r.jsx("h3",{className:"text-2xl font-semibold mb-4 text-gray-800",children:"Basic"}),r.jsx("p",{className:"text-4xl font-bold text-honeybee-primary mb-4",children:"â¹499"}),r.jsxs("ul",{className:"text-left space-y-2 mb-6 text-gray-600",children:[r.jsxs("li",{className:"flex items-center",children:[r.jsx(Ee,{className:"w-5 h-5 text-green-500 mr-2"})," Basic sales tracking"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx(Ee,{className:"w-5 h-5 text-green-500 mr-2"})," 10% per sale"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx(Ee,{className:"w-5 h-5 text-green-500 mr-2"})," Payment payouts 5-7 days"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx(Ee,{className:"w-5 h-5 text-green-500 mr-2"})," Standard email Support"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx(Ee,{className:"w-5 h-5 text-green-500 mr-2"})," Can rent up to 10 hive per month"]})]}),r.jsx("div",{className:"group",children:r.jsx(he,{onClick:()=>t("Basic",499),className:"px-8 py-3",variant:"primary",children:"Choose Plan"})})]})}),r.jsx("div",{className:"group",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg animate-card-hover p-6 text-center",children:[r.jsx("h3",{className:"text-2xl font-semibold mb-4 text-gray-800",children:"Premium"}),r.jsx("p",{className:"text-4xl font-bold text-honeybee-primary mb-4",children:"â¹1299"}),r.jsxs("ul",{className:"text-left space-y-2 mb-6 text-gray-600",children:[r.jsxs("li",{className:"flex items-center",children:[r.jsx(Ee,{className:"w-5 h-5 text-green-500 mr-2"})," AI insights: best-selling flavors, demand trends by region"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx(Ee,{className:"w-5 h-5 text-green-500 mr-2"})," 5% per sale"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx(Ee,{className:"w-5 h-5 text-green-500 mr-2"})," Instant payout"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx(Ee,{className:"w-5 h-5 text-green-500 mr-2"})," Priority chat support"]}),r.jsxs("li",{className:"flex items-center",children:[r.jsx(Ee,{className:"w-5 h-5 text-green-500 mr-2"})," Can rent unlimited hive per month"]})]}),r.jsx("div",{className:"group",children:r.jsx(he,{onClick:()=>t("Premium",1299),className:"px-8 py-3",variant:"primary",children:"Choose Plan"})})]})})]})]})},al=()=>{const{seller:s,loading:e,refreshSeller:t}=Ie(),[n,a]=j.useState(!0),[i,o]=j.useState(!1),[l,c]=j.useState({name:"",phone:"",address:"",city:"",state:"",zip:""});j.useEffect(()=>{!e&&s?(c({name:s.name||"",phone:s.phone||"",address:s.address||"",city:s.city||"",state:s.state||"",zip:s.zip||""}),a(!1)):!e&&!s&&a(!1)},[s,e]);const d=m=>{const{name:f,value:h}=m.target;c(p=>({...p,[f]:h}))},u=async m=>{if(m.preventDefault(),!!s){o(!0);try{const{error:f}=await q.from("sellers").update({name:l.name,phone:l.phone,address:l.address,city:l.city,state:l.state,zip:l.zip}).eq("id",s.id);if(f)throw f;alert("Settings updated successfully!"),await t()}catch(f){console.error("Error updating settings:",f),alert("Failed to update settings.")}finally{o(!1)}}};return n?r.jsx(ke,{title:"Settings",children:r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"w-12 h-12 border-4 border-purple-200 border-t-purple-700 rounded-full animate-spin"})})}):r.jsx(ke,{title:"Settings",children:r.jsxs("div",{className:"max-w-3xl mx-auto",children:[r.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden",children:[r.jsxs("div",{className:"p-8 border-b border-gray-50 flex items-center justify-between bg-gray-50/20",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-black text-gray-900 tracking-tight",children:"Store Profile"}),r.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Update your public store information"})]}),r.jsx("div",{className:"h-12 w-12 bg-purple-100 rounded-2xl flex items-center justify-center text-xl",children:"âï¸"})]}),r.jsxs("form",{onSubmit:u,className:"p-8 space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Store Name"}),r.jsx("input",{type:"text",name:"name",value:l.name,onChange:d,required:!0,className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Phone Number"}),r.jsx("input",{type:"text",name:"phone",value:l.phone,onChange:d,required:!0,className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Full Address"}),r.jsx("textarea",{name:"address",value:l.address,onChange:d,required:!0,rows:3,className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"City"}),r.jsx("input",{type:"text",name:"city",value:l.city,onChange:d,required:!0,className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"State"}),r.jsx("input",{type:"text",name:"state",value:l.state,onChange:d,required:!0,className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Zip Code"}),r.jsx("input",{type:"text",name:"zip",value:l.zip,onChange:d,required:!0,className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all"})]})]}),r.jsx("div",{className:"pt-4",children:r.jsx("button",{type:"submit",disabled:i,className:"w-full bg-purple-600 text-white py-4 rounded-xl font-black uppercase tracking-widest hover:bg-purple-700 transition-all shadow-xl shadow-purple-100 disabled:opacity-50",children:i?"Updating Store...":"Save Changes"})})]})]}),r.jsxs("div",{className:"mt-8 bg-red-50 rounded-2xl border border-red-100 p-8",children:[r.jsx("h3",{className:"text-lg font-black text-red-900 tracking-tight uppercase mb-2",children:"Danger Zone"}),r.jsx("p",{className:"text-sm text-red-600 font-medium mb-6",children:"Irreversible actions for your seller account"}),r.jsx("button",{className:"bg-red-600 text-white px-6 py-3 rounded-xl font-black uppercase tracking-widest text-xs hover:bg-red-700 transition-all shadow-lg shadow-red-100",children:"Deactivate Seller Account"})]})]})})},il=()=>{const{seller:s,loading:e}=Ie(),[t,n]=j.useState(!0),[a,i]=j.useState([]),[o,l]=j.useState(!1),[c,d]=j.useState(null),[u,m]=j.useState({name:"",description:"",price:"",category:"",stock:"",image_url:""}),[f,h]=j.useState(!1),p=j.useCallback(async()=>{if(s){n(!0);try{const{data:w,error:v}=await q.from("products").select("*").eq("seller_id",s.id).order("created_at",{ascending:!1});if(v)throw v;i(w||[])}catch(w){console.error("Error fetching products:",w)}finally{n(!1)}}},[s]);j.useEffect(()=>{!e&&s?p():!e&&!s&&n(!1)},[p,e,s]);const b=w=>{d(w),m({name:w.name,description:w.description,price:w.price.toString(),category:w.category,stock:w.stock.toString(),image_url:w.image_url}),l(!0)},x=async w=>{if(w.preventDefault(),!!s){h(!0);try{const v={seller_id:s.id,name:u.name,description:u.description,price:parseFloat(u.price),category:u.category,stock:parseInt(u.stock,10),image_url:u.image_url,is_active:!0};if(c){const{error:k}=await q.from("products").update(v).eq("id",c.id);if(k)throw k;alert("Product updated successfully!")}else{const{error:k}=await q.from("products").insert(v);if(k)throw k;alert("Product added successfully!")}l(!1),d(null),m({name:"",description:"",price:"",category:"",stock:"",image_url:""}),p()}catch(v){console.error("Product submission error:",v),alert(`Product submission failed: ${v instanceof Error?v.message:"Unknown error"}`)}finally{h(!1)}}},_=async w=>{if(confirm("Are you sure you want to delete this product?"))try{const{error:v}=await q.from("products").delete().eq("id",w);if(v)throw v;alert("Product deleted successfully!"),p()}catch(v){console.error("Error deleting product:",v),alert("Failed to delete product.")}};return t?r.jsx(ke,{title:"My Products",children:r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"w-12 h-12 border-4 border-purple-200 border-t-purple-700 rounded-full animate-spin"})})}):r.jsxs(ke,{title:"My Products",children:[r.jsxs("div",{className:"max-w-7xl mx-auto",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-black text-gray-900",children:"Product Management"}),r.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Manage your inventory and listing details"})]}),r.jsxs("button",{onClick:()=>{d(null),m({name:"",description:"",price:"",category:"",stock:"",image_url:""}),l(!0)},className:"bg-purple-600 text-white px-6 py-3 rounded-xl font-black uppercase tracking-widest hover:bg-purple-700 transition shadow-lg shadow-purple-100 flex items-center gap-2",children:[r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Product"]})]}),r.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{className:"bg-gray-50/50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Product"}),r.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Category"}),r.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Price"}),r.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Stock"}),r.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:a.length>0?a.map(w=>r.jsxs("tr",{className:"hover:bg-gray-50/30 transition-colors",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"h-10 w-10 flex-shrink-0 bg-gray-100 rounded-lg overflow-hidden border border-gray-100",children:w.image_url?r.jsx("img",{src:w.image_url,alt:w.name,className:"h-full w-full object-cover"}):r.jsx("div",{className:"h-full w-full flex items-center justify-center text-gray-400",children:"ð¦"})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("div",{className:"text-sm font-bold text-gray-900",children:w.name}),r.jsx("div",{className:"text-xs text-gray-400 font-medium truncate max-w-[200px]",children:w.description})]})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-medium uppercase text-[10px] tracking-widest",children:w.category}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-black text-gray-900",children:["â¹",w.price.toFixed(2)]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`text-sm font-bold ${w.stock<10?"text-red-500":"text-gray-900"}`,children:w.stock})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold",children:r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>b(w),className:"text-purple-600 hover:text-purple-900",children:"Edit"}),r.jsx("button",{onClick:()=>_(w.id),className:"text-red-600 hover:text-red-900",children:"Delete"})]})})]},w.id)):r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-400 font-medium italic",children:"No products found. Add your first product to get started!"})})})]})})})]}),o&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full p-8 max-h-[90vh] overflow-y-auto relative",children:[r.jsx("button",{onClick:()=>l(!1),className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),r.jsx("h2",{className:"text-2xl font-black text-gray-900 tracking-tight mb-6",children:c?"Edit Product":"Add New Product"}),r.jsxs("form",{onSubmit:x,className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Product Name"}),r.jsx("input",{type:"text",value:u.name,onChange:w=>m({...u,name:w.target.value}),required:!0,placeholder:"e.g. Pure Wild Forest Honey",className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Category"}),r.jsxs("select",{value:u.category,onChange:w=>m({...u,category:w.target.value}),required:!0,className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all",children:[r.jsx("option",{value:"",children:"Select Category"}),r.jsx("option",{value:"honey",children:"Honey"}),r.jsx("option",{value:"beehive",children:"Beehive"}),r.jsx("option",{value:"accessories",children:"Accessories"}),r.jsx("option",{value:"other",children:"Other"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Description"}),r.jsx("textarea",{value:u.description,onChange:w=>m({...u,description:w.target.value}),required:!0,placeholder:"Describe your product's unique features...",className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all",rows:4})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Price (â¹)"}),r.jsx("input",{type:"number",value:u.price,onChange:w=>m({...u,price:w.target.value}),required:!0,placeholder:"0.00",className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Stock Inventory"}),r.jsx("input",{type:"number",value:u.stock,onChange:w=>m({...u,stock:w.target.value}),required:!0,placeholder:"0",className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2",children:"Image URL"}),r.jsx("input",{type:"url",value:u.image_url,onChange:w=>m({...u,image_url:w.target.value}),placeholder:"https://...",className:"w-full rounded-xl border-gray-100 bg-gray-50/50 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-3 font-medium transition-all"})]}),r.jsx("button",{type:"submit",disabled:f,className:"w-full bg-purple-600 text-white py-4 rounded-xl font-black uppercase tracking-widest hover:bg-purple-700 transition-all shadow-xl shadow-purple-100 disabled:opacity-50",children:f?"Processing...":c?"Update Listing":"Confirm Listing"})]})]})})]})},ol=()=>{const{seller:s,loading:e}=Ie(),[t,n]=j.useState(!0),[a,i]=j.useState({totalRevenue:0,totalOrders:0,conversionRate:3.2,activeCustomers:0}),[o,l]=j.useState([]),c=j.useCallback(async()=>{if(s){n(!0);try{const{data:d,error:u}=await q.from("orders").select("total, user_id").eq("seller_id",s.id);if(u)throw u;const m=(d||[]).reduce((b,x)=>b+x.total,0),f=new Set((d||[]).map(b=>b.user_id)).size;i({totalRevenue:m,totalOrders:d?.length||0,conversionRate:4.5,activeCustomers:f});const{data:h,error:p}=await q.from("products").select("name, price, stock").eq("seller_id",s.id).limit(5);if(p)throw p;l(h||[])}catch(d){console.error("Error fetching analytics:",d)}finally{n(!1)}}},[s]);return j.useEffect(()=>{!e&&s?c():!e&&!s&&n(!1)},[c,e,s]),t?r.jsx(ke,{title:"Analytics",children:r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"w-12 h-12 border-4 border-purple-200 border-t-purple-700 rounded-full animate-spin"})})}):r.jsx(ke,{title:"Analytics",children:r.jsxs("div",{className:"max-w-7xl mx-auto",children:[r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[r.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1",children:"Conversion Rate"}),r.jsxs("p",{className:"text-3xl font-black text-gray-900",children:[a.conversionRate,"%"]}),r.jsx("div",{className:"mt-2 text-xs font-bold text-green-500",children:"â 0.4% this week"})]}),r.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1",children:"Active Customers"}),r.jsx("p",{className:"text-3xl font-black text-gray-900",children:a.activeCustomers}),r.jsx("div",{className:"mt-2 text-xs font-bold text-purple-500",children:"Loyal fan base"})]}),r.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1",children:"Avg. Order Value"}),r.jsxs("p",{className:"text-3xl font-black text-gray-900",children:["â¹",(a.totalRevenue/(a.totalOrders||1)).toFixed(2)]}),r.jsx("div",{className:"mt-2 text-xs font-bold text-gray-400 italic",children:"Per transaction"})]}),r.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm",children:[r.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1",children:"Order Volume"}),r.jsx("p",{className:"text-3xl font-black text-gray-900",children:a.totalOrders}),r.jsx("div",{className:"mt-2 text-xs font-bold text-blue-500",children:"Growing steady"})]})]}),r.jsxs("div",{className:"grid lg:grid-cols-2 gap-8",children:[r.jsxs("div",{className:"bg-white p-8 rounded-2xl border border-gray-100 shadow-sm",children:[r.jsx("h3",{className:"text-lg font-black text-gray-900 mb-6 uppercase tracking-tight",children:"Sales Performance"}),r.jsx("div",{className:"h-64 flex items-end justify-between gap-2",children:[45,60,40,75,90,65,80].map((d,u)=>r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsx("div",{style:{height:`${d}%`},className:"w-full bg-purple-600 rounded-lg shadow-lg shadow-purple-100 hover:bg-purple-700 transition-all cursor-pointer group relative",children:r.jsxs("div",{className:"absolute -top-8 left-1/2 -translate-x-1/2 bg-gray-900 text-white text-[10px] px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity",children:["â¹",(d*100).toFixed(0)]})}),r.jsxs("p",{className:"text-[9px] font-black text-gray-400 text-center uppercase",children:["Day ",u+1]})]},u))})]}),r.jsxs("div",{className:"bg-white p-8 rounded-2xl border border-gray-100 shadow-sm",children:[r.jsx("h3",{className:"text-lg font-black text-gray-900 mb-6 uppercase tracking-tight",children:"Top Products"}),r.jsx("div",{className:"space-y-4",children:o.length>0?o.map((d,u)=>r.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl border border-gray-100/50",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center font-black text-purple-600 text-[10px]",children:u+1}),r.jsx("p",{className:"text-sm font-bold text-gray-900",children:d.name})]}),r.jsxs("p",{className:"text-sm font-black text-gray-900",children:["â¹",d.price.toFixed(2)]})]},u)):r.jsx("p",{className:"text-gray-400 italic text-center py-12",children:"No data available yet"})})]})]})]})})},ll=()=>{const{user:s}=Ne(),{seller:e,loading:t}=Ie(),[n,a]=j.useState(!0),[i,o]=j.useState(0),[l,c]=j.useState(0),[d,u]=j.useState([]),m=j.useCallback(async()=>{if(e){a(!0);try{const{data:f,error:h}=await q.from("orders").select("total, status, created_at").eq("seller_id",e.id).eq("status","delivered");if(h)throw h;const p=(f||[]).reduce((w,v)=>w+v.total,0);o(p);const{data:b,error:x}=await q.from("orders").select("total").eq("seller_id",e.id).in("status",["pending","processing","shipped"]);if(x)throw x;const _=(b||[]).reduce((w,v)=>w+v.total,0);c(_),u((f||[]).slice(0,10).map(w=>({id:Math.random().toString(36).substr(2,9),amount:w.total,date:new Date(w.created_at),type:"Sale",status:"Completed"})))}catch(f){console.error("Error fetching earnings:",f)}finally{a(!1)}}},[e]);return j.useEffect(()=>{!t&&e?m():!t&&!e&&a(!1)},[m,t,e]),n?r.jsx(ke,{title:"Earnings",children:r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"w-12 h-12 border-4 border-purple-200 border-t-purple-700 rounded-full animate-spin"})})}):r.jsx(ke,{title:"Earnings",children:r.jsxs("div",{className:"max-w-7xl mx-auto",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[r.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-sm border border-gray-100 flex flex-col justify-between overflow-hidden relative group",children:[r.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:scale-110 transition-transform",children:r.jsx("svg",{className:"w-12 h-12 text-purple-600",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 14h-2v-2h2v2zm0-4h-2V7h2v5z"})})}),r.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1",children:"Total Revenue"}),r.jsxs("p",{className:"text-4xl font-black text-gray-900 leading-none",children:["â¹",i.toFixed(2)]}),r.jsx("div",{className:"mt-4 pt-4 border-t border-gray-50",children:r.jsx("span",{className:"text-xs font-bold text-green-500",children:"â 12% from last month"})})]}),r.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-sm border border-gray-100 flex flex-col justify-between overflow-hidden relative group",children:[r.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:scale-110 transition-transform",children:r.jsx("svg",{className:"w-12 h-12 text-yellow-600",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"})})}),r.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1",children:"Pending Payout"}),r.jsxs("p",{className:"text-4xl font-black text-gray-900 leading-none",children:["â¹",l.toFixed(2)]}),r.jsx("div",{className:"mt-4 pt-4 border-t border-gray-50",children:r.jsx("span",{className:"text-xs font-bold text-gray-400 italic",children:"Processing current cycle"})})]}),r.jsxs("div",{className:"bg-purple-600 p-8 rounded-2xl shadow-xl shadow-purple-100 flex flex-col justify-between overflow-hidden relative group",children:[r.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-20 group-hover:scale-110 transition-transform",children:r.jsx("svg",{className:"w-12 h-12 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"})})}),r.jsx("p",{className:"text-[10px] font-black text-purple-200 uppercase tracking-widest mb-1",children:"Available for Withdrawal"}),r.jsxs("p",{className:"text-4xl font-black text-white leading-none",children:["â¹",i.toFixed(2)]}),r.jsx("button",{className:"mt-4 w-full bg-white text-purple-600 font-black uppercase tracking-widest text-[10px] py-3 rounded-xl hover:bg-purple-50 transition-colors",children:"Withdraw Now"})]})]}),r.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden",children:[r.jsxs("div",{className:"p-6 border-b border-gray-50 flex justify-between items-center bg-gray-50/20",children:[r.jsx("h3",{className:"text-lg font-black text-gray-900 tracking-tight",children:"Recent Transactions"}),r.jsx("button",{className:"text-xs font-bold text-purple-600 uppercase tracking-widest",children:"Download Report"})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{className:"bg-gray-50/50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Transaction ID"}),r.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Date"}),r.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Type"}),r.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Amount"}),r.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Status"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-50",children:d.length>0?d.map(f=>r.jsxs("tr",{className:"hover:bg-gray-50/30 transition-colors",children:[r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-xs font-bold text-gray-900 font-mono",children:["#TX-",f.id.toUpperCase()]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-medium",children:f.date.toLocaleDateString()}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700 font-bold uppercase text-[10px] tracking-widest",children:f.type}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-black text-gray-900",children:["â¹",f.amount.toFixed(2)]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:"px-2 py-0.5 inline-flex text-[10px] leading-5 font-black uppercase tracking-widest rounded-full bg-green-100 text-green-700",children:f.status})})]},f.id)):r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-400 font-medium italic",children:"No transaction history found."})})})]})})]})]})})},cl=()=>{const{addToCart:s}=it(),[e,t]=j.useState("2-layer 10 frame hive"),[n,a]=j.useState(""),[i,o]=j.useState("idle"),[l,c]=j.useState(1),[d,u]=j.useState(0),m={id:"beehive-starter-kit",name:"Beehive Wooden Box With Frames",rating:4.6,price:5e3,condition:"New",productId:"332024303",description:["Premium Beehive Materials: The exterior of the beehive is made of cedar wood with top-quality pine beehive frames with food-grade plastic foundation soaked in beeswax","Complete Beehive Kit: Our beehive kit includes a top cover, inner cover, bottom board, queen excluder, and entrance reducer for a complete bee hive starter kit","Metal Top Cover: Retractable galvanized metal top cover protects your 10 frame beehive and colonies from the effects of the outdoors","Standard Beehive Box Size: Deep Brood Boxes","Easy to Assemble: Pre-cut dovetails and pre-drilled holes for easy assembly, dovetail design makes the connection between the two boards stronger"],specs:{Brand:"Bee Bridge",Material:"Wood",Color:"Natural",Style:"Rustic",AssemblyRequired:"Yes"},images:[We,We,We,We,We,We]},f=()=>{n&&(o("checking"),setTimeout(()=>{n.length===6?o("available"):o("unavailable")},1e3))},h=()=>{s({id:m.id,name:m.name,description:m.description[0],price:m.price,category:"beehive",image_url:m.images[0],seller_id:"pollibee-official",stock:5,is_active:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}),alert("Added to cart!")};return r.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[r.jsxs("div",{className:"text-sm text-gray-500 mb-6 flex items-center gap-1",children:[r.jsx("span",{children:"Shop"})," ",r.jsx(bs,{size:14})," ",r.jsx("span",{children:"Beekeeping"})," ",r.jsx(bs,{size:14})," ",r.jsx("span",{className:"text-gray-900 font-medium",children:"Beehives"})]}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 lg:p-8",children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8 lg:gap-12",children:[r.jsxs("div",{className:"lg:col-span-4 flex flex-col gap-4",children:[r.jsxs("div",{className:"aspect-square bg-gray-100 rounded-lg overflow-hidden border border-gray-200 relative group",children:[r.jsx("img",{src:m.images[d],alt:"Product Main",className:"w-full h-full object-contain mix-blend-multiply p-4 transition-transform duration-300 group-hover:scale-105"}),r.jsxs("div",{className:"absolute top-4 right-4 flex flex-col gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[r.jsx("button",{className:"p-2 bg-white rounded-full shadow-md hover:text-red-500 transition-colors",children:r.jsx(Jo,{size:20})}),r.jsx("button",{className:"p-2 bg-white rounded-full shadow-md hover:text-blue-500 transition-colors",children:r.jsx(Zo,{size:20})})]})]}),r.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:m.images.map((p,b)=>r.jsx("button",{onClick:()=>u(b),className:`w-16 h-16 flex-shrink-0 border-2 rounded-md overflow-hidden ${d===b?"border-blue-600":"border-gray-200 hover:border-gray-400"}`,children:r.jsx("img",{src:p,alt:`Thumb ${b}`,className:"w-full h-full object-cover"})},b))})]}),r.jsxs("div",{className:"lg:col-span-5 flex flex-col gap-6 border-r border-gray-100 pr-0 lg:pr-8",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900 leading-tight mb-2",children:m.name}),r.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-2",children:[r.jsxs("div",{className:"flex items-center text-yellow-400",children:[r.jsx(ys,{fill:"currentColor",size:16}),r.jsx("span",{className:"font-bold text-gray-900 ml-1",children:m.rating}),r.jsx("span",{className:"text-gray-500 font-normal ml-1",children:"/ 5"})]}),r.jsxs("span",{children:["Condition: ",r.jsx("span",{className:"font-medium text-gray-900",children:m.condition})]}),r.jsxs("span",{children:["Product ID: ",m.productId]})]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Size"}),r.jsx("div",{className:"flex flex-wrap gap-3",children:["2-layer 10 frame hive"].map(p=>r.jsx("button",{onClick:()=>t(p),className:`px-4 py-2 text-sm border rounded-lg transition-all ${e===p?"border-blue-600 bg-blue-50 text-blue-700 font-medium ring-1 ring-blue-600":"border-gray-300 text-gray-700 hover:border-gray-400"}`,children:p},p))})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Details"}),r.jsx("div",{className:"space-y-3 text-sm",children:Object.entries(m.specs).map(([p,b])=>r.jsxs("div",{className:"flex border-b border-gray-100 pb-2 last:border-0 last:pb-0",children:[r.jsx("span",{className:"w-1/3 text-gray-500",children:p.replace(/([A-Z])/g," $1").trim()}),r.jsx("span",{className:"w-2/3 text-gray-900 font-medium text-right",children:b})]},p))})]}),r.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[r.jsx("h4",{className:"font-semibold text-blue-900 mb-1",children:"About this item"}),r.jsx("ul",{className:"list-disc pl-5 text-sm text-blue-800 space-y-1",children:m.description.map((p,b)=>r.jsx("li",{children:p},b))})]})]}),r.jsx("div",{className:"lg:col-span-3",children:r.jsxs("div",{className:"border border-gray-200 rounded-xl p-6 shadow-sm bg-white sticky top-24",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("div",{className:"flex items-baseline gap-2 mb-1",children:r.jsxs("span",{className:"text-3xl font-bold text-gray-900",children:["â¹",m.price.toLocaleString()]})}),r.jsxs("div",{className:"mb-6 bg-gray-50 p-3 rounded-lg border border-gray-100",children:[r.jsx("h4",{className:"font-semibold text-gray-900 text-sm mb-2",children:"Sold By"}),r.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[r.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center text-yellow-700 font-bold border border-yellow-200",children:"BB"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Bee Bridge Official"}),r.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[r.jsx(ys,{size:12,className:"text-yellow-400 fill-current mr-1"}),"4.8 (120 ratings)"]})]})]})]}),r.jsxs("div",{className:"text-sm text-green-600 mb-1 flex items-center gap-1",children:[r.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"In Stock"]}),r.jsx("div",{className:"text-xs text-gray-500",children:"Duties & taxes incl."})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-2 uppercase tracking-wide",children:"Delivery Availability"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"text",placeholder:"Enter Pincode",maxLength:6,value:n,onChange:p=>a(p.target.value.replace(/\D/g,"")),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),r.jsx("button",{onClick:f,className:"px-4 py-2 bg-gray-900 text-white rounded-lg text-sm font-medium hover:bg-gray-800 transition-colors",children:"Check"})]}),i==="checking"&&r.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Checking..."}),i==="available"&&r.jsxs("p",{className:"text-xs text-green-600 mt-2 flex items-center gap-1",children:["â Delivery available to ",n]}),i==="unavailable"&&r.jsxs("p",{className:"text-xs text-red-500 mt-2",children:["â Delivery not available to ",n]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[r.jsx("button",{onClick:()=>c(Math.max(1,l-1)),className:"w-8 h-8 rounded border flex items-center justify-center hover:bg-gray-50",children:"-"}),r.jsx("span",{className:"font-medium",children:l}),r.jsx("button",{onClick:()=>c(Math.min(5,l+1)),className:"w-8 h-8 rounded border flex items-center justify-center hover:bg-gray-50",children:"+"})]}),r.jsxs("button",{onClick:h,className:"w-full py-3 bg-black text-white font-bold rounded-lg hover:bg-gray-800 transition-colors flex items-center justify-center gap-2",children:["Add to Cart | â¹",m.price.toLocaleString()]}),r.jsx("button",{className:"w-full py-3 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 transition-colors shadow-lg shadow-blue-200",children:"Get Seller Contact"})]}),r.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-100 space-y-3",children:[r.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[r.jsx(tl,{size:18}),r.jsx("span",{children:"Free Shipping"})]}),r.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[r.jsx(el,{size:18}),r.jsx("span",{children:"Secure Transaction"})]}),r.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[r.jsx(Qo,{size:18}),r.jsx("span",{children:"30 Days Return Policy"})]})]})]})})]})})]})})};function dl(){const[s,e]=j.useState(!1),t=kr(),{cartItems:n}=it(),{logout:a}=Ne(),i=()=>{e(!s)};if(t.pathname==="/login"||t.pathname==="/signup")return null;const o=["/applications","/products","/analytics","/earnings","/orders","/settings"].includes(t.pathname);return r.jsxs("nav",{className:"bg-honeybee-background/98 backdrop-blur-md shadow-xl fixed w-full z-50",children:[r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"flex justify-between h-14 md:h-16",children:[r.jsx("div",{className:"flex items-center",children:r.jsx(ie,{to:"/",className:"flex-shrink-0 flex items-center",children:r.jsx("span",{className:"font-serif text-lg md:text-xl lg:text-2xl font-bold text-honeybee-primary",children:"Bee Bridge"})})}),r.jsxs("div",{className:"hidden md:flex items-center space-x-4 lg:space-x-8",children:[r.jsx(ie,{to:"/home",className:`font-medium text-sm lg:text-base ${t.pathname==="/home"?"text-honeybee-primary":"text-honeybee-secondary hover:text-honeybee-accent"} transition duration-300`,children:"Home"}),r.jsx(ie,{to:"/shop",className:`font-medium text-sm lg:text-base ${t.pathname==="/shop"?"text-honeybee-primary":"text-honeybee-secondary hover:text-honeybee-accent"} transition duration-300`,children:"Shop"}),r.jsx(ie,{to:"/about",className:`font-medium text-sm lg:text-base ${t.pathname==="/about"?"text-honeybee-primary":"text-honeybee-secondary hover:text-honeybee-accent"} transition duration-300`,children:"About"}),!o&&r.jsx(ie,{to:"/seller",className:`font-medium text-sm lg:text-base ${t.pathname==="/seller"?"text-honeybee-primary":"text-honeybee-secondary hover:text-honeybee-accent"} transition duration-300`,children:"Seller"}),r.jsx(ie,{to:"/contact",className:`font-medium text-sm lg:text-base ${t.pathname==="/contact"?"text-honeybee-primary":"text-honeybee-secondary hover:text-honeybee-accent"} transition duration-300`,children:"Contact"}),r.jsx(ie,{to:"/subscription",className:`font-medium text-sm lg:text-base ${t.pathname==="/subscription"?"text-honeybee-primary":"text-honeybee-secondary hover:text-honeybee-accent"} transition duration-300`,children:"Subscription"})]}),r.jsxs("div",{className:"flex items-center space-x-2 md:space-x-4",children:[r.jsxs(ie,{to:"/cart",className:"text-honeybee-secondary hover:text-honeybee-primary transition duration-300 relative p-2 md:p-0",children:[r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),n.reduce((l,c)=>l+c.quantity,0)>0&&r.jsx("span",{className:"absolute -top-1 -right-1 md:-top-2 md:-right-2 bg-red-600 text-white rounded-full text-xs w-4 h-4 md:w-5 md:h-5 flex items-center justify-center",children:n.reduce((l,c)=>l+c.quantity,0)})]}),r.jsx(ie,{to:"/profile",className:"text-honeybee-secondary hover:text-honeybee-primary transition duration-300 p-2 md:p-0",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),r.jsxs("div",{className:"relative group hidden md:block",children:[r.jsxs("button",{className:"text-honeybee-secondary hover:text-honeybee-primary transition duration-300 flex items-center space-x-1 focus:outline-none p-2 md:p-0",children:[r.jsx(Xo,{className:"h-6 w-6"}),r.jsx("span",{className:"sr-only",children:"Settings"})]}),r.jsx("div",{className:"absolute right-0 mt-2 w-40 bg-white rounded-md shadow-lg opacity-0 group-hover:opacity-100 transition-opacity z-50",children:r.jsx("button",{className:"block w-full text-left px-4 py-2 text-honeybee-dark hover:bg-honeybee-light",onClick:async()=>{await a(),window.location.href="/login"},children:"Logout"})})]}),r.jsx("button",{onClick:i,className:"md:hidden text-honeybee-secondary hover:text-honeybee-primary p-2",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]})}),s&&r.jsx("div",{className:"md:hidden bg-honeybee-background/95 backdrop-blur-sm border-t border-honeybee-light",children:r.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1",children:[r.jsx(ie,{to:"/home",className:`block px-3 py-2 rounded-md font-medium ${t.pathname==="/home"?"text-honeybee-primary":"text-honeybee-secondary hover:text-honeybee-accent"}`,onClick:()=>e(!1),children:"Home"}),r.jsx(ie,{to:"/shop",className:`block px-3 py-2 rounded-md font-medium ${t.pathname==="/shop"?"text-honeybee-primary":"text-honeybee-secondary hover:text-honeybee-accent"}`,onClick:()=>e(!1),children:"Shop"}),r.jsx(ie,{to:"/about",className:`block px-3 py-2 rounded-md font-medium ${t.pathname==="/about"?"text-honeybee-primary":"text-honeybee-secondary hover:text-honeybee-accent"}`,onClick:()=>e(!1),children:"About"}),r.jsx(ie,{to:"/seller",className:`block px-3 py-2 rounded-md font-medium ${t.pathname==="/seller"?"text-honeybee-primary":"text-honeybee-secondary hover:text-honeybee-accent"}`,onClick:()=>e(!1),children:"Seller"}),r.jsx(ie,{to:"/contact",className:`block px-3 py-2 rounded-md font-medium ${t.pathname==="/contact"?"text-honeybee-primary":"text-honeybee-secondary hover:text-honeybee-accent"}`,onClick:()=>e(!1),children:"Contact"}),r.jsx(ie,{to:"/subscription",className:`block px-3 py-2 rounded-md font-medium ${t.pathname==="/subscription"?"text-honeybee-primary":"text-honeybee-secondary hover:text-honeybee-accent"}`,onClick:()=>e(!1),children:"Subscription"}),r.jsx(ie,{to:"/settings",className:`block px-3 py-2 rounded-md font-medium ${t.pathname==="/settings"?"text-honeybee-primary":"text-honeybee-secondary hover:text-honeybee-accent"}`,onClick:()=>e(!1),children:"Settings"}),r.jsx("button",{onClick:async()=>{await a(),window.location.href="/login",e(!1)},className:"block w-full text-left px-3 py-2 rounded-md font-medium text-honeybee-secondary hover:text-honeybee-accent",children:"Logout"})]})})]})}const ul=()=>r.jsxs("footer",{className:"bg-gray-900 text-gray-300 py-10",children:[r.jsxs("div",{className:"max-w-7xl mx-auto px-6 grid grid-cols-1 md:grid-cols-3 gap-8 border-b border-gray-700 pb-8",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-400 uppercase mb-4",children:"About"}),r.jsxs("ul",{className:"space-y-2 text-sm",children:[r.jsx("li",{children:r.jsx("a",{href:"/contact",className:"hover:text-white font-semibold",children:"Contact Us"})}),r.jsx("li",{children:r.jsx("a",{href:"/about",className:"hover:text-white font-semibold",children:"About Us"})})]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-400 uppercase mb-4",children:"Help"}),r.jsxs("ul",{className:"space-y-2 text-sm",children:[r.jsx("li",{children:r.jsx("a",{href:"/contact",className:"hover:text-white font-semibold",children:"Payments"})}),r.jsx("li",{children:r.jsx("a",{href:"/contact",className:"hover:text-white font-semibold",children:"Shipping"})}),r.jsx("li",{children:r.jsx("a",{href:"/contact",className:"hover:text-white font-semibold",children:"Cancellation & Returns"})}),r.jsx("li",{children:r.jsx("a",{href:"/contact",className:"hover:text-white font-semibold",children:"FAQ"})})]})]}),r.jsxs("div",{className:"border-l border-gray-700 pl-6",children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-400 uppercase mb-4",children:"Mail Us:"}),r.jsx("address",{className:"not-italic text-sm space-y-1",children:r.jsx("p",{children:"beebridgeshop@gmail.com"})}),r.jsxs("div",{className:"mt-4",children:[r.jsx("p",{className:"text-sm font-semibold",children:"Social:"}),r.jsxs("div",{className:"flex space-x-4 mt-2",children:[r.jsx("a",{href:"https://facebook.com",target:"_blank",rel:"noopener noreferrer","aria-label":"Facebook",className:"hover:text-white",children:r.jsx(Ko,{size:20})}),r.jsx("a",{href:"https://twitter.com",target:"_blank",rel:"noopener noreferrer","aria-label":"Twitter",className:"hover:text-white",children:r.jsx(rl,{size:20})}),r.jsx("a",{href:"https://youtube.com",target:"_blank",rel:"noopener noreferrer","aria-label":"YouTube",className:"hover:text-white",children:r.jsx(sl,{size:20})}),r.jsx("a",{href:"https://instagram.com",target:"_blank",rel:"noopener noreferrer","aria-label":"Instagram",className:"hover:text-white",children:r.jsx(Yo,{size:20})})]})]})]})]}),r.jsxs("div",{className:"max-w-7xl mx-auto px-6 flex flex-col md:flex-row items-center justify-between pt-6",children:[r.jsxs("div",{className:"flex space-x-8 text-yellow-400 text-sm font-semibold",children:[r.jsx("a",{href:"/seller",className:"flex items-center space-x-2 hover:underline",children:r.jsx("span",{children:"Become a Seller"})}),r.jsx("a",{href:"/contact",className:"flex items-center space-x-2 hover:underline",children:r.jsx("span",{children:"Help Center"})})]}),r.jsx("div",{className:"text-gray-400 text-sm mt-4 md:mt-0",children:"Â© 2025 Bee Bridge.com"})]})]}),Ce=({children:s,backgroundImage:e})=>{const t=kr();return r.jsxs("div",{className:"min-h-screen flex flex-col",style:e?{backgroundImage:`url(${e})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundAttachment:"fixed"}:{},children:[r.jsx(dl,{}),r.jsx("main",{className:"pt-14 pb-20",children:s}),t.pathname==="/seller"&&r.jsx("div",{className:"h-screen"}),t.pathname!=="/seller"&&r.jsx("div",{className:"mt-24",children:r.jsx(ul,{})})]})},hl=()=>{const[s,e]=j.useState(""),[t,n]=j.useState(""),[a,i]=j.useState(!1),[o,l]=j.useState(null),[c,d]=j.useState(null),[u,m]=j.useState(!1),[f,h]=j.useState(!1),p=Ue(),{signInWithEmail:b,signInWithGoogle:x,resetPassword:_}=Ne(),[w,v]=j.useState(!1),[k,T]=j.useState("");j.useEffect(()=>{const O=new Image;O.src="https://developers.google.com/identity/images/g-logo.png",O.onload=()=>m(!0)},[]);const L=async O=>{O.preventDefault(),l(null),d(null);try{await b(s,t),d("Login successful! Redirecting..."),setTimeout(()=>p("/home"),2e3)}catch(R){console.error("Login error:",R);let M="Login failed. Please try again.";R instanceof Error&&(R.message==="Invalid login credentials"?M="Invalid email or password. Please check your credentials. If you just signed up, please verify your email address.":M=R.message),l(M)}},z=async()=>{h(!0);try{await x(),p("/home")}catch(O){console.error("Google login process failed:",O),l("Google login failed. Please try again.")}finally{h(!1)}},D=async O=>{if(O.preventDefault(),!k){l("Please enter your email address.");return}try{await _(k),l("Password reset email sent! Check your inbox."),v(!1),T("")}catch{l("Failed to send reset email. Please try again.")}};return r.jsxs("div",{className:"min-h-screen bg-[#FFF8E7] flex items-center justify-center px-4 relative",children:[r.jsxs("div",{className:"max-w-5xl w-full bg-gray-50 rounded-3xl shadow-2xl flex overflow-hidden",children:[r.jsxs("div",{className:"w-full md:w-1/2 p-10 flex flex-col justify-center",children:[r.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Hello Again!"}),c&&r.jsx("div",{className:"text-sm text-center mb-4 p-3 bg-green-50 border border-green-200 rounded-lg text-green-600",children:c}),o&&r.jsx("div",{className:"text-sm text-center mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-600",children:o}),r.jsxs("form",{onSubmit:L,className:"space-y-6",children:[r.jsx("div",{children:r.jsx("input",{type:"email",id:"email",value:s,onChange:O=>e(O.target.value),required:!0,placeholder:"Email",className:"w-full px-4 py-3 rounded-lg border border-gray-200 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-pink-400 bg-white"})}),r.jsx("div",{children:r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:a?"text":"password",id:"password",value:t,onChange:O=>n(O.target.value),required:!0,placeholder:"Password",className:"w-full px-4 py-3 rounded-lg border border-gray-200 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-pink-400 bg-white"}),r.jsx("button",{type:"button",onClick:()=>i(!a),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600 focus:outline-none","aria-label":a?"Hide password":"Show password",children:a?r.jsx(Mn,{className:"h-5 w-5"}):r.jsx(Bn,{className:"h-5 w-5"})})]})}),r.jsx("div",{children:r.jsx("div",{onClick:()=>v(!0),className:"text-right text-xs text-gray-500 mb-4 cursor-pointer hover:underline",children:"Recovery Password"})}),r.jsx("div",{children:r.jsx(he,{type:"submit",variant:"primary",className:"w-full font-semibold",children:"Sign In"})})]}),r.jsx("div",{className:"mt-4 text-center",children:r.jsxs("span",{className:"text-gray-600 text-sm",children:["Don't have an account?"," ",r.jsx(he,{onClick:()=>p("/signup"),variant:"ghost",className:"text-honeybee-primary hover:underline font-semibold p-0",children:"Sign Up"})]})}),r.jsxs("div",{className:"flex items-center my-6",children:[r.jsx("hr",{className:"flex-grow border-gray-300"}),r.jsx("span",{className:"mx-4 text-gray-400 text-sm",children:"Or continue with"}),r.jsx("hr",{className:"flex-grow border-gray-300"})]}),r.jsx("div",{className:"flex justify-center",children:r.jsx("button",{onClick:z,className:"p-2 hover:opacity-80 transition-opacity disabled:opacity-50",disabled:f,"aria-label":"Sign in with Google",children:f?r.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}):u?r.jsx("img",{src:"https://developers.google.com/identity/images/g-logo.png",alt:"Google",className:"w-6 h-6"}):r.jsx("div",{className:"w-6 h-6 bg-gray-200 rounded animate-pulse"})})})]}),r.jsx("div",{className:"hidden md:flex md:w-1/2 relative rounded-r-3xl overflow-hidden border-8 border-white shadow-lg",children:bt.createElement("dotlottie-wc",{src:"https://lottie.host/415db1e3-d9d5-4073-b9fe-099abfe8c66c/XtpXv9SgcE.lottie",style:{width:"100%",height:"100%"},autoplay:!0,loop:!0})})]}),w&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[r.jsx("h2",{className:"text-xl font-bold mb-4",children:"Reset Password"}),r.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Enter your email address and we'll send you a link to reset your password."}),r.jsxs("form",{onSubmit:D,className:"space-y-4",children:[r.jsx("input",{type:"email",value:k,onChange:O=>T(O.target.value),placeholder:"Email address",required:!0,className:"w-full px-4 py-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-pink-400"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{type:"submit",className:"flex-1 bg-pink-500 text-white py-2 rounded-lg hover:bg-pink-600",children:"Send Reset Link"}),r.jsx("button",{type:"button",onClick:()=>v(!1),className:"flex-1 bg-gray-300 py-2 rounded-lg",children:"Cancel"})]})]})]})})]})},fl=()=>{const[s,e]=j.useState(""),[t,n]=j.useState(""),[a,i]=j.useState(""),[o,l]=j.useState(!1),[c,d]=j.useState(!1),[u,m]=j.useState(null),[f,h]=j.useState(null),p=Ue(),{signUpWithEmail:b,signInWithGoogle:x}=Ne(),_=async v=>{v.preventDefault(),d(!0),m(null),h(null);try{await b(s,t,a),d(!1),localStorage.setItem("justSignedUp","true"),h("Account created successfully! Redirecting to Login..."),setTimeout(()=>{localStorage.removeItem("justSignedUp"),p("/login")},2e3)}catch(k){console.error("Sign up error:",k);let T="Sign up failed. Please try again.";k instanceof Error&&(T=k.message),m(T),d(!1)}},w=async()=>{m(null);try{await x()}catch(v){console.error("Google sign up error:",v),m("Google sign up failed. Please try again.")}};return r.jsx("div",{className:"min-h-screen gradient-bg-warm flex items-center justify-center px-4",children:r.jsxs("div",{className:"max-w-5xl w-full glass-effect rounded-3xl modern-shadow flex overflow-hidden",children:[r.jsxs("div",{className:"w-full md:w-1/2 p-10 flex flex-col justify-center",children:[r.jsx("h1",{className:"text-4xl font-bold vibrant-text mb-6 text-center",children:"Create Account"}),f&&r.jsx("div",{className:"text-sm text-center mb-4 p-3 bg-green-50 border border-green-200 rounded-lg text-green-600",children:f}),u&&r.jsx("div",{className:"text-sm text-center mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-600",children:u}),r.jsxs("form",{onSubmit:_,className:"space-y-6",children:[r.jsx("div",{children:r.jsx("input",{type:"text",id:"name",value:s,onChange:v=>e(v.target.value),required:!0,placeholder:"Your full name",className:"w-full px-4 py-3 rounded-lg border border-gray-200 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-pink-400 bg-white"})}),r.jsx("div",{children:r.jsx("input",{type:"email",id:"email",value:t,onChange:v=>n(v.target.value),required:!0,placeholder:"Email",className:"w-full px-4 py-3 rounded-lg border border-gray-200 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-pink-400 bg-white"})}),r.jsx("div",{children:r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:o?"text":"password",id:"password",value:a,onChange:v=>i(v.target.value),required:!0,placeholder:"Password",className:"w-full px-4 py-3 rounded-lg border border-gray-200 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-pink-400 bg-white"}),r.jsx("button",{type:"button",onClick:()=>l(!o),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600 focus:outline-none","aria-label":o?"Hide password":"Show password",children:o?r.jsx(Mn,{className:"h-5 w-5"}):r.jsx(Bn,{className:"h-5 w-5"})})]})}),r.jsx("div",{children:r.jsx(he,{type:"submit",variant:"primary",className:"w-full font-semibold",disabled:c,children:c?"Creating Account...":"Sign Up"})})]}),r.jsxs("div",{className:"flex items-center my-6",children:[r.jsx("hr",{className:"flex-grow border-gray-300"}),r.jsx("span",{className:"mx-4 text-gray-400 text-sm",children:"Or continue with"}),r.jsx("hr",{className:"flex-grow border-gray-300"})]}),r.jsx("div",{className:"flex justify-center",children:r.jsx("button",{onClick:w,className:"p-3 shadow-md bg-white hover:shadow-lg rounded-lg transition-shadow","aria-label":"Sign up with Google",children:r.jsx("img",{src:"https://developers.google.com/identity/images/g-logo.png",alt:"Google",className:"w-5 h-5"})})}),r.jsx("div",{className:"mt-4 text-center",children:r.jsxs("span",{className:"text-gray-600 text-sm",children:["Already have an account?"," ",r.jsx(he,{onClick:()=>p("/login"),variant:"ghost",className:"text-honeybee-primary hover:underline font-semibold p-0",children:"Sign In"})]})})]}),r.jsx("div",{className:"hidden md:block md:w-1/2 relative rounded-r-3xl overflow-hidden border-8 border-white shadow-lg",children:bt.createElement("dotlottie-wc",{src:"https://lottie.host/415db1e3-d9d5-4073-b9fe-099abfe8c66c/XtpXv9SgcE.lottie",style:{width:"100%",height:"100%"},autoplay:!0,loop:!0})})]})})},Fn=({type:s="card",count:e=1,className:t=""})=>{const n=Array.from({length:e},(a,i)=>r.jsxs("div",{className:`animate-pulse ${t} ${s==="card"?"bg-gray-200 rounded-xl p-6 space-y-4":s==="list"?"bg-gray-200 rounded-lg p-4 space-y-3":"bg-gray-200 rounded h-4"}`,children:[s==="card"&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"h-6 bg-gray-300 rounded w-3/4"}),r.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/2"}),r.jsx("div",{className:"h-4 bg-gray-300 rounded w-full"}),r.jsx("div",{className:"h-4 bg-gray-300 rounded w-2/3"}),r.jsx("div",{className:"h-10 bg-gray-300 rounded"})]}),s==="list"&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"h-4 bg-gray-300 rounded w-full"}),r.jsx("div",{className:"h-4 bg-gray-300 rounded w-3/4"}),r.jsx("div",{className:"h-4 bg-gray-300 rounded w-5/6"})]}),s==="text"&&r.jsx("div",{className:"h-4 bg-gray-300 rounded"})]},i));return r.jsx(r.Fragment,{children:n})},Ze=({children:s})=>{const{seller:e,loading:t}=Ie(),n=Ue();return t?r.jsx(Fn,{}):e?e.is_approved?r.jsx(r.Fragment,{children:s}):r.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center items-center p-4",children:r.jsxs("div",{className:"bg-white max-w-md w-full rounded-2xl shadow-xl p-8 text-center border border-gray-100",children:[r.jsx("div",{className:"w-20 h-20 bg-yellow-50 rounded-full flex items-center justify-center mx-auto mb-6",children:r.jsx("svg",{className:"w-10 h-10 text-yellow-500 animate-pulse",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Verification Pending"}),r.jsx("div",{className:"w-16 h-1 bg-gradient-to-r from-yellow-400 to-orange-500 mx-auto rounded-full mb-6"}),r.jsx("p",{className:"text-gray-600 mb-6 leading-relaxed",children:"Your seller account is currently under review by our admin team. Access to dashboard features is restricted until verification is complete."}),r.jsx("div",{className:"bg-blue-50 rounded-lg p-4 mb-8 text-left",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx("svg",{className:"w-5 h-5 text-blue-500 mt-0.5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("p",{className:"text-sm text-blue-700",children:"You will receive an email notification once your account has been approved. This usually takes 24-48 hours."})]})}),r.jsxs("div",{className:"flex flex-col gap-3",children:[r.jsxs("button",{onClick:()=>window.location.reload(),className:"w-full bg-white border border-gray-200 text-gray-700 font-semibold py-3 px-6 rounded-xl hover:bg-gray-50 transition-colors duration-200 flex items-center justify-center gap-2",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Check Status Again"]}),r.jsx("button",{onClick:()=>n("/home"),className:"w-full bg-gradient-to-r from-gray-800 to-gray-900 text-white font-semibold py-3 px-6 rounded-xl hover:shadow-lg transition-all duration-200",children:"Return to Home"})]}),r.jsxs("p",{className:"mt-8 text-xs text-gray-400",children:["Seller ID: ",r.jsx("span",{className:"font-mono text-gray-500",children:e.seller_id})]})]})}):r.jsx(Z,{to:"/seller",replace:!0})};console.log("Fresh Code Loaded: v2 - Fixed Price Type");const ml="https://media.istockphoto.com/id/1669258600/vector/illustration-of-delicious-melted-chocolate-on-white-background.jpg?s=612x612&w=0&k=20&c=oykGVJHBjHuevHVi2GE8jFmCe0EpX2unEfhMPCFFeik=";function pl(){const{user:s,loading:e}=Ne(),t=localStorage.getItem("justLoggedOut")==="true",n=localStorage.getItem("justSignedUp")==="true";return t&&!s&&localStorage.removeItem("justLoggedOut"),e?r.jsx(Fn,{}):r.jsxs(ta,{children:[r.jsx(ae,{path:"/",element:s?r.jsx(Z,{to:"/home"}):r.jsx(Z,{to:"/login"})}),r.jsx(ae,{path:"/login",element:!s||t?r.jsx(hl,{}):r.jsx(Z,{to:"/home"})}),r.jsx(ae,{path:"/signup",element:s&&!n?r.jsx(Z,{to:"/home"}):r.jsx(fl,{})}),r.jsx(ae,{path:"/home",element:s?r.jsx(Ce,{children:r.jsx(ha,{})}):r.jsx(Z,{to:"/login"})}),r.jsx(ae,{path:"/about",element:s?r.jsx(Ce,{children:r.jsx(fa,{})}):r.jsx(Z,{to:"/login"})}),r.jsx(ae,{path:"/contact",element:s?r.jsx(Ce,{children:r.jsx(ga,{})}):r.jsx(Z,{to:"/login"})}),r.jsx(ae,{path:"/shop",element:s?r.jsx(Ce,{children:r.jsx(Ro,{})}):r.jsx(Z,{to:"/login"})}),r.jsx(ae,{path:"/cart",element:s?r.jsx(Ce,{children:r.jsx(Io,{})}):r.jsx(Z,{to:"/login"})}),r.jsx(ae,{path:"/checkout",element:s?r.jsx(Ce,{children:r.jsx(Uo,{})}):r.jsx(Z,{to:"/login"})}),r.jsx(ae,{path:"/profile",element:s?r.jsx(Ce,{children:r.jsx(Do,{})}):r.jsx(Z,{to:"/login"})}),r.jsx(ae,{path:"/seller",element:s?r.jsx(Ce,{backgroundImage:ml,children:r.jsx(Mo,{})}):r.jsx(Z,{to:"/login"})}),r.jsx(ae,{path:"/applications",element:s?r.jsx(Ze,{children:r.jsx(Wo,{})}):r.jsx(Z,{to:"/login"})}),r.jsx(ae,{path:"/orders",element:s?r.jsx(Ze,{children:r.jsx(Vo,{})}):r.jsx(Z,{to:"/login"})}),r.jsx(ae,{path:"/subscription",element:s?r.jsx(Ce,{children:r.jsx(nl,{})}):r.jsx(Z,{to:"/login"})}),r.jsx(ae,{path:"/settings",element:s?r.jsx(Ze,{children:r.jsx(al,{})}):r.jsx(Z,{to:"/login"})}),r.jsx(ae,{path:"/products",element:s?r.jsx(Ze,{children:r.jsx(il,{})}):r.jsx(Z,{to:"/login"})}),r.jsx(ae,{path:"/product/beehive",element:s?r.jsx(Ce,{children:r.jsx(cl,{})}):r.jsx(Z,{to:"/login"})}),r.jsx(ae,{path:"/analytics",element:s?r.jsx(Ze,{children:r.jsx(ol,{})}):r.jsx(Z,{to:"/login"})}),r.jsx(ae,{path:"/earnings",element:s?r.jsx(Ze,{children:r.jsx(ll,{})}):r.jsx(Z,{to:"/login"})})]})}function gl(){return r.jsx(xa,{children:r.jsx(ea,{children:r.jsx(pl,{})})})}class xl extends j.Component{state={hasError:!1,error:null};static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Uncaught error:",e,t)}render(){return this.state.hasError?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-red-50 p-4",children:r.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-xl p-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Something went wrong"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"The application encountered an error and cannot display."}),r.jsx("div",{className:"bg-gray-100 p-4 rounded overflow-auto max-h-48 mb-4",children:r.jsx("code",{className:"text-sm text-red-800 font-mono",children:this.state.error?.toString()})}),r.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-red-600 text-white py-2 px-4 rounded hover:bg-red-700 transition-colors",children:"Reload Page"})]})}):this.props.children}}const bl="378321462417-7jtv3gdf4ur8fnmv3dl11q9d5omujotd.apps.googleusercontent.com";ia.createRoot(document.getElementById("root")).render(r.jsx(j.StrictMode,{children:r.jsx(ca,{clientId:bl,children:r.jsx(xl,{children:r.jsx($o,{children:r.jsx(gl,{})})})})}))});export default yl();
